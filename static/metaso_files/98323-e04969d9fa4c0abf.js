"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98323],{29823:function(e,n,t){var r,o=t(94746);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(null,arguments)}n.Z=function(e){return o.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},e),r||(r=o.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7.5 3h7.1c2.24 0 3.36 0 4.216.436a4 4 0 0 1 1.748 1.748C21 6.04 21 7.16 21 9.4v7.1M6.2 21h8.1c1.12 0 1.68 0 2.108-.218a2 2 0 0 0 .874-.874c.218-.428.218-.988.218-2.108V9.7c0-1.12 0-1.68-.218-2.108a2 2 0 0 0-.874-.874C15.98 6.5 15.42 6.5 14.3 6.5H6.2c-1.12 0-1.68 0-2.108.218a2 2 0 0 0-.874.874C3 8.02 3 8.58 3 9.7v8.1c0 1.12 0 1.68.218 2.108a2 2 0 0 0 .874.874C4.52 21 5.08 21 6.2 21"})))}},96040:function(e,n,t){var r,o=t(94746);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(null,arguments)}n.Z=function(e){return o.createElement("svg",i({xmlns:"http://www.w3.org/2000/svg",width:21,height:21,fill:"none",viewBox:"0 0 21 21"},e),r||(r=o.createElement("path",{fill:"currentColor",stroke:"currentColor",strokeWidth:.253,d:"M18.403 20.127q.168 0 .32-.048a1.083 1.083 0 0 0 1.404-1.053V2.299q0-.083-.012-.162.012-.08.012-.163c0-.609-.48-1.1-1.085-1.1H1.958A1.09 1.09 0 0 0 .875 2.027l-.002.055v16.78q0 .042.003.082l-.003.08c0 .61.48 1.102 1.085 1.102zM8.111 17.925H3.043V9.788H8.11zm9.846 0h-7.676V9.788h7.676zm0-14.85v4.51h-7.676v-4.51zm-14.914 0H8.11v4.51H3.043z"})))}},7167:function(e,n,t){t.d(n,{X8:function(){return ew},Ei:function(){return eZ},tz:function(){return ek},Dr:function(){return eW},od:function(){return eE},G7:function(){return eO},WG:function(){return e_},tO:function(){return eR},fR:function(){return eC},iI:function(){return eI},V6:function(){return eb},we:function(){return eS}});var r,o,i,a,c,s,l,u=t(12249),d=t(50059),h=t(57437),p=t(47812),f=t(78693),x=t(35389),g=t(38398),m=t(42187),v=t(8350),y=t(19643),j=t(32281),C=t(2265),w=t(7870),k=t(26058),b=t(48359),I=t.n(b),S=t(36760),Z=t.n(S),E=t(22322),T=t(39207),_=t(96040),R=t(54632),W=t(36331),O=t(41628),D=t(55833),z=t(89051),F=t(94746);function H(){return(H=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(null,arguments)}var A=function(e){return F.createElement("svg",H({xmlns:"http://www.w3.org/2000/svg",width:25,height:25,fill:"none",viewBox:"0 0 25 25"},e),r||(r=F.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12.5 22.5c5.523 0 10-4.477 10-10s-4.477-10-10-10-10 4.477-10 10 4.477 10 10 10"})),o||(o=F.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.5 10.1c0-.56 0-.84.109-1.054a1 1 0 0 1 .437-.437C9.26 8.5 9.54 8.5 10.1 8.5h4.8c.56 0 .84 0 1.054.109a1 1 0 0 1 .437.437c.109.214.109.494.109 1.054v4.8c0 .56 0 .84-.109 1.054a1 1 0 0 1-.437.437c-.214.109-.494.109-1.054.109h-4.8c-.56 0-.84 0-1.054-.109a1 1 0 0 1-.437-.437C8.5 15.74 8.5 15.46 8.5 14.9z"})),i||(i=F.createElement("path",{fill:"currentColor",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.5 10.1c0-.56 0-.84.109-1.054a1 1 0 0 1 .437-.437C9.26 8.5 9.54 8.5 10.1 8.5h4.8c.56 0 .84 0 1.054.109a1 1 0 0 1 .437.437c.109.214.109.494.109 1.054v4.8c0 .56 0 .84-.109 1.054a1 1 0 0 1-.437.437c-.214.109-.494.109-1.054.109h-4.8c-.56 0-.84 0-1.054-.109a1 1 0 0 1-.437-.437C8.5 15.74 8.5 15.46 8.5 14.9z"})))},M=t(99376),P=t(23760),L=t(41963),U=t(11183),G=t(16056),N=t(31219),V=t(96339),q=t(8090),B=t(79943),X=t(91898),K=t(36706),Q=t(59469),$=t(61201),J=t(70208),Y=t(54301),ee=t(40100),en=t(53820),et=t(43913),er=t(43180),eo=t(95927),ei=t(39803),ea=t(42233),ec=t(3864),es=t(77526),el=t(30166),eu=t(43306),ed=t(29823),eh=t(84054);function ep(){return(ep=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(null,arguments)}var ef=function(e){return F.createElement("svg",ep({xmlns:"http://www.w3.org/2000/svg",width:45,height:45,fill:"none",viewBox:"0 0 45 45"},e),a||(a=F.createElement("rect",{width:44,height:44,x:.5,y:.409,fill:"#EAECF0",rx:22})),c||(c=F.createElement("path",{stroke:"#475467",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.76,d:"m23.587 28.683-1.296 1.296a4.583 4.583 0 1 1-6.482-6.481l1.297-1.297m11.667 1.297 1.296-1.297a4.583 4.583 0 1 0-6.482-6.482l-1.296 1.297m-2.56 9.042 6.417-6.417"})))};function ex(){return(ex=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)({}).hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(null,arguments)}var eg=function(e){return F.createElement("svg",ex({xmlns:"http://www.w3.org/2000/svg",width:45,height:45,fill:"none",viewBox:"0 0 45 45"},e),s||(s=F.createElement("rect",{width:44,height:44,x:.5,y:.409,fill:"#1570EF",rx:22})),l||(l=F.createElement("path",{fill:"#fff",d:"M30.302 12.784a2.7 2.7 0 0 1 2.685 2.438l.013.26v13.855a2.7 2.7 0 0 1-2.439 2.685l-.26.012H14.726a2.7 2.7 0 0 1-2.686-2.438l-.013-.26v-.691a.8.8 0 0 1-.023-.271l.023-.14V15.481a2.7 2.7 0 0 1 2.44-2.685l.26-.012zm0 1.642H14.725c-.528 0-.961.38-1.046.883l-.016.172v8.749c.393-.786.78-1.454 1.162-1.994.657-.938 1.302-1.501 1.965-1.718.61-.2 1.209-.111 1.743.264 1.415.995 3.03 2.906 4.18 4.402l.577.766.247.338c.217-.311.48-.674.774-1.038 1.227-1.53 2.3-2.345 3.28-2.486a1.94 1.94 0 0 1 1.648.516c.615.572 1.211 1.264 1.738 1.942l.38.503V15.48c0-.522-.384-.96-.885-1.041zm-2.435 2.11a1.848 1.848 0 1 1 0 3.696 1.848 1.848 0 0 1 0-3.695"})))},em=t(33986),ev=t(63665),ey=t(4416);(0,el.default)(function(){return Promise.all([t.e(21100),t.e(77647),t.e(4637),t.e(77962),t.e(30470),t.e(21634),t.e(42845),t.e(57930),t.e(82935),t.e(5978),t.e(41004),t.e(14449),t.e(98255),t.e(96839),t.e(85180),t.e(96491),t.e(72789),t.e(97120),t.e(45823)]).then(t.bind(t,96491)).then(function(e){return{default:e.CaseMindMapping}})},{loadableGenerated:{webpack:function(){return[96491]}},ssr:!1});var ej=(0,el.default)(function(){return Promise.all([t.e(47999),t.e(4637),t.e(21100),t.e(77962),t.e(37160),t.e(30470),t.e(21634),t.e(42845),t.e(58509),t.e(57930),t.e(56873),t.e(41004),t.e(14449),t.e(98255),t.e(96839),t.e(75181),t.e(35322),t.e(63796),t.e(21602),t.e(85180),t.e(3615),t.e(97120),t.e(60926)]).then(t.bind(t,10301)).then(function(e){return{default:e.ReferenceNum}})},{loadableGenerated:{webpack:function(){return[10301]}},ssr:!1});function eC(e){var n=e.question,t=e.sx,r=e.engineType;return(0,h.jsx)(f.Z,{color:"var(--black)",lineHeight:"28px",sx:t,children:r===p.rG.PODCAST?(0,h.jsxs)(f.Z,{fontSize:"16x",children:["未找到有关 ",(0,h.jsx)(f.Z,{component:"span",fontWeight:"700",color:"#D92D20",children:n})," 的结果，可能您的兴趣有点小众。"]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(f.Z,{fontWeight:"700",fontSize:"20px",children:["未找到有关 ",(0,h.jsx)(f.Z,{component:"span",color:"#D92D20",children:n})," 的结果"]}),(0,h.jsx)(f.Z,{fontWeight:"400",fontSize:"16px",marginTop:"5px",children:"请检查你的拼写或尝试使用其他关键字。"})]})})}function ew(e){var n=(0,d._)((0,C.useState)(!1),2),t=n[0],r=n[1];return(0,C.useEffect)(function(){var e,n;r(((null===(e=(0,k.ZD)())||void 0===e?void 0:e.isMiniWebView)===!0||(null===(n=(0,k.ZD)())||void 0===n?void 0:n.isAliApp)===!0)&&navigator.userAgent.indexOf("iPhone")>-1)},[]),(0,h.jsx)(z.Z,{classes:{tooltip:"custom-tooltip-popper",arrow:"custom-tooltip-arrow"},arrow:!0,placement:"top",title:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(f.Z,{component:"span",sx:{border:"solid 1px var(--white)",marginRight:"5px"},children:"ESC"}),"终止生成回答"]}),children:(0,h.jsx)(f.Z,{className:Z()(I()["stop-btn"],(0,u._)({},I()["ios-minipro"],t)),onClick:e.onClick,children:(0,h.jsx)(A,{})})})}var ek=function(e){var n,t,r=e.isH5,o=e.question,i=e.links,a=(e.sessionId,e.result),c=e.resultId,s=(e.isRealTime,e.searchResultId,e.checkCanOpen),l=(0,C.useRef)(null),u=(0,d._)((0,C.useState)(!1),2),y=u[0],j=u[1],b=(0,M.useSearchParams)(),I=(0,d._)(C.useState(!1),2),S=I[0],Z=I[1],_=(0,P.LM)(),R=null===(n=(0,k.ZD)())||void 0===n?void 0:n.isMiniWebView,z=null===(t=(0,k.ZD)())||void 0===t?void 0:t.isAliApp,F=(0,B.WS)(),H=(0,L.A8)().removeUrlCmd,A=D.vs.useBridge("exportMarkdownAPI"),X=(0,C.useCallback)(function(e){s?s(e)&&Z(e):Z(e)},[_.login,e.id,Z,s]);(0,C.useEffect)(function(){_.hasHydrated&&en()},[_.hasHydrated,b]);var Q=function(n){j(!0);var t=R?35:100,i=o.length>t?o.substring(0,t):o,a="".concat(i,".").concat(n);n===T.EO7.PDF?(0,w.oh)("export-pdf"):n===T.EO7.DOCX&&(0,w.oh)("export-docx"),(0,w.dW)(w.Gy.ExportFile,{way:n,sessionId:e.sessionId,resultId:e.resultId,mode:e.mode,isRealTime:e.isRealTime,question:e.question}),r?(0,U.dw)({md:er(),title:i},n,"ai-search").then(function(e){var n=e+"&uid="+(0,T.ejW)("uid");if(R){(0,U.hk)(a,n);return}if(z){my.navigateTo({url:"/pages/download/download?n="+encodeURIComponent(a)+"&d="+encodeURIComponent(n)});return}var t=document.createElement("a");t.setAttribute("download",a),t.style.display="none",t.href=n,document.body.appendChild(t),t.click(),document.body.removeChild(t)}).catch(function(t){(0,E.y)("下载失败，当前用户过多，请稍后再试",{variant:"error",autoHideDuration:2e3}),(0,w.dW)(w.Gy.ExportFileFailed,{way:n,sessionId:e.sessionId,resultId:e.resultId,mode:e.mode,isRealTime:e.isRealTime,question:e.question})}).finally(function(){j(!1)}):(0,U.Sv)({md:er(),title:i},n,"ai-search").then(function(e){t=T.EO7.PDF===n?"application/pdf":"application/vnd.openxmlformats-officedocument.wordprocessingml.document";var t,r=new Blob([e.data],{type:t+"charset=utf-8"}),o=document.createElement("a");o.download=a,o.style.display="none",o.href=URL.createObjectURL(r),document.body.appendChild(o),o.click(),URL.revokeObjectURL(o.href),document.body.removeChild(o)}).catch(function(t){(0,E.y)("下载失败，当前用户过多，请稍后再试",{variant:"error",autoHideDuration:2e3}),(0,w.dW)(w.Gy.ExportFileFailed,{way:n,sessionId:e.sessionId,resultId:e.resultId,mode:e.mode,isRealTime:e.isRealTime,question:e.question})}).finally(function(){j(!1)})},$=function(){j(!0);var e=ei(),n={title:o,md:e,type:"doc",mindMapMd:eo()};(0,w.dW)(w.Gy.ExportToXiezuocat,n),(0,T.Dvu)(o,e,"doc").then(function(e){0===e.data.errCode?window.open(e.data.data):((0,E.y)("导出到写作猫失败",{variant:"error",autoHideDuration:2e3}),(0,w.dW)(w.Gy.ExportToXiezuocatFailed,1))}).catch(function(e){(0,E.y)("导出到写作猫失败",{variant:"error",autoHideDuration:2e3}),(0,w.dW)(w.Gy.ExportToXiezuocatFailed,1)}).finally(function(){j(!1)})},J=function(){j(!0);var e=ei();(0,w.dW)(w.Gy.ExportToXiezuocat,{query:o,md:e}),(0,w.oh)("export-xiezuocat"),(0,T.Vys)(o,e,eo()).then(function(e){0===e.data.errCode?window.open(e.data.data+"?exp=true"):((0,E.y)("导出到写作猫失败",{variant:"error",autoHideDuration:2e3}),(0,w.dW)(w.Gy.ExportToXiezuocatFailed,1))}).catch(function(e){(0,E.y)("导出到写作猫失败",{variant:"error",autoHideDuration:2e3}),(0,w.dW)(w.Gy.ExportToXiezuocatFailed,1)}).finally(function(){j(!1)})},Y=(0,C.useCallback)(function(n){if(!_.login){if(n===T.EO7.CAT){$();return}var t=(0,G.GZ)(location.href,[{type:N.a.ExportReport,payload:n}]);t.searchParams.set("gid",e.id);var r=t.href;(0,V.x3)({showTips:!0,redirectUrl:r,logDesc:"export-report"});return}n===T.EO7.CAT?J():Q(n)},[_.login,J,Q]),ee=(0,C.useCallback)(function(){if(Z(!1),!_.login){(0,V.x3)({showTips:!0,redirectUrl:location.href,logDesc:"edit-qa"});return}(0,K.vC)(F,"1",!0,{type:K.dC.EDIT_SEARCH_RESULT,searchResultId:e.searchResultId})},[_.login]),en=(0,L.Qv)(function(n,t){l.current&&n.find(function(e){return e.type===N.a.ExportReport})&&b.get("gid")==e.id&&(j(!0),q.Z.scroll(l.current,{duration:300,positioning:{y:"center"}}),setTimeout(function(){!A.current||A.current.isEmpty(c)||A.current.needWaitMindMap(c)?setTimeout(function(){Y(n.find(function(e){return e.type===N.a.ExportReport}).payload)},800):Y(n.find(function(e){return e.type===N.a.ExportReport}).payload)},800),setTimeout(function(){H(N.a.ExportReport)},100))},{deps:[Y]}),et=(0,C.useCallback)(function(e){if(!e||e.danger)return"";var n=""+(e.export||e.title)+" ";return!e.export&&e.episode_audio_publish_date&&(n+="[".concat((0,w.l6)(e.episode_audio_publish_date,"-"),"]")),n.replace(/\n/g,"")},[]),er=function(){return""+("# ".concat(o,"\n\n")+ei())},eo=function(){return A.current.getMindMapMd(c)},ei=function(){var n="",t=i.length;if(e.engineType===p.rG.PODCAST?n+=a.replace(/\[\[(\d+)\]\]/g,function(e,n){return n>t?"":"《".concat(i[n-1].title,"》")})+"\n\n":(e.reasoningThinkingText&&(n+="<!-- TOC -->\n\n## 步骤拆解\n\n> "+e.reasoningThinkingText.trim().replace(/\[\[(\d+)\]\]/g,function(e,n){return n<t&&i[n-1].display?"[".concat(i[n-1].display.refer_id,"]"):"[".concat(n,"]")}).replace(/\n/g,"\n> ")+"\n\n"),e.reasoningList&&e.reasoningList.length>0&&e.reasoningList.forEach(function(e){n+="##### ".concat(e.question,"\n\n")+(e.answer.replace(/\[\[(\d+)\]\]/g,function(e,n){return n<t&&i[n-1].display?"[".concat(i[n-1].display.refer_id,"]"):"[".concat(n,"]")})+"\n\n")}),e.engineType!==p.rG.WORKFLOW&&("strong-research"!==e.mode?n+="<!-- TOC -->\n\n## 回答\n\n":n+="<!-- TOC -->\n\n## 最终回答\n\n"),e.answerThinkingText&&(n+="> "+e.answerThinkingText.trim().replace(/\[\[(\d+)\]\]/g,function(e,n){return n<t&&i[n-1].display?"[".concat(i[n-1].display.refer_id,"]"):"[".concat(n,"]")}).replace(/\n/g,"\n> ")+"\n\n"),n+=a.replace(/\[\[(\d+)\]\]/g,function(e,n){return n<t&&i[n-1].display?"[".concat(i[n-1].display.refer_id,"]"):"[".concat(n,"]")})+"\n\n"),e.isRealTime&&(n=""),!e.abort){var r=!0,o=!1,s=void 0;try{for(var l,u=Object.values(D.r$)[Symbol.iterator]();!(r=(l=u.next()).done);r=!0){var d=l.value;if(A.current){var h=A.current.getExportMarkdownTextMap(d,c);h&&(n+=h+"\n\n")}}}catch(e){o=!0,s=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw s}}}if(i.length){n+="<!-- TOC -->\n\n## ".concat(e.engineType?D.i9[e.engineType]:"参考资料","\n");var f=0,x=new Set,g=new Set;i.forEach(function(e,t){if(g.has(e.display.refer_id)){f++;return}g.add(e.display.refer_id);var r=et(e);if(x.add(r),r){var o=e.link;!o&&e.file_meta&&e.file_meta._id&&(o="https://metaso-static.oss-accelerate.aliyuncs.com/metaso/document/"+e.file_meta._id+".pdf"),o?n+="[".concat(e.display?e.display.refer_id:t-f+1,". ").concat(r,"](").concat(o,")\n\n"):n+="".concat(e.display?e.display.refer_id:t-f+1,". ").concat(r,"\n\n")}})}return n};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(W.Z,{ref:l,sx:{color:"#667085",width:36,height:36,minWidth:0,fontSize:"16px",fontWeight:400},checked:S,onCheckedChange:X,children:y?(0,h.jsx)(x.Z,{size:"1.5em",sx:{color:"gray"},thickness:2}):(0,h.jsx)(O.Z,{})}),(0,h.jsxs)(g.ZP,{id:"export-type",open:S,anchorEl:l.current,onClose:function(){Z(!1)},anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[e.canEditQa&&(0,h.jsx)(m.Z,{onClick:function(){ee()},style:{fontSize:"14px",color:"var(--export-menu-color)"},children:"编辑"}),(0,h.jsx)(m.Z,{onClick:function(){Z(!1),Y(T.EO7.DOCX)},style:{fontSize:"14px",color:"var(--export-menu-color)"},children:"导出Word"}),(0,h.jsx)(m.Z,{onClick:function(){Z(!1),Y(T.EO7.PDF)},style:{fontSize:"14px",color:"var(--export-menu-color)"},children:"导出PDF"}),!R&&!z&&!r&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(f.Z,{sx:{padding:"0 16px"},children:(0,h.jsx)(v.Z,{sx:{margin:"0"}})}),(0,h.jsx)(m.Z,{onClick:function(){Z(!1),Y(T.EO7.CAT)},style:{fontSize:"14px",color:"var(--export-menu-color)"},children:"导出到写作猫"})]})]})]})},eb=function(e){e.isH5;var n=e.question,t=e.sessionId,r=e.searchResultId;e.checkCanOpen;var o=(0,C.useRef)(null),i=(0,d._)((0,C.useState)(!1),2),a=i[0],c=i[1],s=(0,d._)(C.useState(!1),2),l=s[0],u=s[1],p=(0,d._)(C.useState(!0),2),g=p[0],v=p[1],y=(0,d._)(C.useState(!1),2),j=y[0],b=y[1];(0,P.LM)();var I=(0,M.useSearchParams)(),S=(0,d._)((0,er.bQ)({exportBtn:o},l,function(){u(!1)}),1)[0],Z=(0,C.useRef)(null),_=function(){Z.current&&clearTimeout(Z.current)},R=(0,d._)((0,C.useState)(!1),2),W=R[0],O=R[1],D=function(){if(W){(0,E.y)("图片正在生成中",{variant:"info",autoHideDuration:2e3});return}c(!0),O(!0),z()},z=function(){var e="".concat("https://metaso.cn");(location.href.indexOf("172.168")>-1||location.href.indexOf("localhost")>-1)&&(e="http://".concat(location.hostname,":3001")),e+="/search-result-share-img?sessionId=".concat(t,"&showThinkingProcess=").concat(g?1:0),r&&(e+="&resultId=".concat(r)),I.get("shareKey")&&(e+="&shareKey=".concat(I.get("shareKey"))),I.get("tsk")&&(e+="&tsk=".concat(I.get("tsk")));var o=localStorage.getItem("visitingTopicId");if(o){var i=(0,w.DI)("topic-pwd").get(o);i&&(e+="&pwd=".concat(i))}var a={url:e,domain:"metaso.cn",uid:(0,T.ejW)("uid"),sid:(0,T.ejW)("sid"),aliyungf_tc:(0,T.ejW)("aliyungf_tc"),client:(0,k.Fk)()};(0,T.PSx)(a).then(function(e){var t=n.length<10?"".concat(n,".png"):"".concat(n.substring(0,10),".png");(0,w.GN)(e.data.image,t)}).catch(function(e){(0,E.y)("保存图片失败",{variant:"error",autoHideDuration:2e3})}).finally(function(){O(!1),c(!1)})};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(f.Z,{ref:o,sx:{color:"#667085",height:36,minWidth:0,fontSize:"16px",fontWeight:400,display:"flex",alignItems:"center",justifyContent:"center"},onClick:function(){u(!l)},children:a?(0,h.jsx)(x.Z,{size:"1.5em",sx:{color:"gray"},thickness:2}):e.button?e.button:(0,h.jsxs)(f.Z,{sx:{color:"var(--content-op-color)",fontSize:"16px",fontWeight:400,display:"flex",justifyContent:"start",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(eu.Z,{}),(0,h.jsx)("span",{children:"分享"})]})}),(0,h.jsxs)(er.ZP,{open:l,isAutoUpdate:!0,ref:S,anchor:o.current,offsetOptions:{mainAxis:5,crossAxis:r?0:-50},sxs:{contentWrapper:{p:"0",borderRadius:"8px"}},children:[(0,h.jsxs)(m.Z,{onClick:function(){u(!1),e.onShareClick()},sx:{" svg":{width:"20px",height:"20px"}},style:{fontSize:"14px",color:"var(--export-menu-color)",gap:"4px"},children:[(0,h.jsx)("span",{style:{width:"36px",display:"flex",justifyContent:"center"},children:(0,h.jsx)(ed.Z,{})}),(0,h.jsx)(f.Z,{style:{width:"70px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,h.jsx)("span",{style:{height:"14px"},children:"复制链接"})})]}),(0,h.jsxs)(m.Z,{onClick:function(){u(!1),D()},onMouseEnter:function(){_(),b(!0)},onMouseLeave:function(){Z.current=setTimeout(function(){b(!1)},500)},sx:{" svg":{width:"20px",height:"20px"}},style:{fontSize:"14px",color:"var(--export-menu-color)",gap:"4px"},children:[(0,h.jsx)("span",{style:{width:"36px",display:"flex",justifyContent:"center"},children:(0,h.jsx)(eh.Z,{})}),(0,h.jsx)(f.Z,{style:{width:"70px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,h.jsx)("span",{style:{height:"14px"},children:"生成图片"})})]}),j&&e.model&&(e.model.endsWith("r1")||e.model.endsWith("strong-research")||e.model.endsWith("fast_thinking"))&&(0,h.jsxs)(m.Z,{onClick:function(){},onMouseEnter:function(){_(),b(!0)},onMouseLeave:function(){Z.current=setTimeout(function(){b(!1)},500)},sx:{" svg":{width:"20px",height:"20px"}},style:{fontSize:"12px",color:"var(--export-menu-color)",gap:"4px"},children:[(0,h.jsx)("span",{style:{width:"36px",display:"flex",justifyContent:"center"},children:(0,h.jsx)(ey.Z,{checked:g,onChange:function(e,n){v(n)}})}),(0,h.jsx)("span",{style:{width:"70px",textAlign:"center"},children:"含思考过程"})]})]})]})},eI=function(e){e.isH5,e.question;var n=e.sessionId,t=(e.searchResultId,e.checkCanOpen),r=(0,C.useRef)(null),o=(0,d._)((0,C.useState)(!1),2),i=o[0];o[1];var a=(0,d._)(C.useState(!1),2),c=a[0],s=a[1],l=(0,P.LM)(),u=(0,C.useCallback)(function(e){t?t(e)&&s(e):s(e)},[l.login,e.searchResultId,s,t]),p=function(){e.onShareClick(),s(!1)},g=function(){var e=(0,w.HG)();(0,w.dW)("openAppFromH5Share",{sessionId:n}),(0,E.y)((0,h.jsx)(f.Z,{sx:{width:280,fontSize:"14px",textAlign:"center",backgroundColor:"#1F4FC7",borderRadius:"23px",padding:"10px 10px"},onClick:function(){(0,ev.V)({value:{url:location.href}},{autoNavigateToOpenAppPage:!0,preventAutoStringifyValue:!0,preventDefaultHitThreshold:!0,onHitThreshold:function(){"ios"===e?window.location.href=ea.VX:window.location.href=ea.ND}})},children:"App内打开，免费使用"}),{key:"search-open-app",preventDuplicate:!0,autoHideDuration:3e3,style:{background:"transparent",padding:0,boxShadow:"none",justifyContent:"center",marginTop:"calc(50vh - 56px)"}}),s(!1)};return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(W.Z,{ref:r,sx:{color:"#667085",height:36,minWidth:0,fontSize:"16px",fontWeight:400},checked:c,onCheckedChange:u,children:i?(0,h.jsx)(x.Z,{size:"1.5em",sx:{color:"gray"},thickness:2}):e.button?e.button:(0,h.jsxs)(f.Z,{sx:{color:"var(--content-op-color)",fontSize:"16px",fontWeight:400,display:"flex",justifyContent:"start",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(eu.Z,{}),(0,h.jsx)("span",{children:"分享"})]})}),(0,h.jsx)(em.$,{id:"sri-drawer",open:c,headerTitle:"分享",onClose:function(){s(!1)},sx:{zIndex:99999," .MuiDrawer-paper":{zIndex:99999}},noBackButton:!0,children:(0,h.jsx)(f.Z,{id:"h5-search-result-share-box",display:"flex",flexDirection:"column",gap:"16px",style:{marginBottom:"20px"},children:(0,h.jsxs)(f.Z,{component:"label",display:"flex",flexDirection:"row",gap:"8px",className:I()["srsi-step1"],children:[(0,h.jsxs)(f.Z,{onClick:function(){return p()},className:I()["srsi-step1-item"],children:[(0,h.jsx)(ef,{}),(0,h.jsx)(f.Z,{children:"复制链接"})]}),(0,h.jsxs)(f.Z,{onClick:function(){return g()},className:I()["srsi-step1-item"],children:[(0,h.jsx)(eg,{}),(0,h.jsx)(f.Z,{children:"生成长图"})]})]})})})]})},eS=(0,C.forwardRef)(function(e,n){return(0,h.jsx)(X.U,{ref:e.coverRef,id:e.id,coverPosition:e.coverPosition,notifyPositionChanged:e.notifyPositionChanged,imageId:e.imageId,setImageId:e.setImageId,imageUrl:e.imageUrl,setImageUrl:e.setImageUrl,show:e.show,showTool:e.showTool,deleteSucceed:e.deleteSucceed,isPending:e.isPending,onCoverInfoChanged:e.onCoverInfoChanged,getUrlFromImageIdFunc:function(n){return(0,T.Cmf)("".concat("https://metaso.cn","/api/session/").concat(e.id,"/cover-image?imgId=").concat(n))},uploadCoverImageFunc:T.Ov7,clearCoverImageFunc:T.TMt,updateCoverInfoFunc:T.qu5,getExampleImagesFunc:T.miJ})}),eZ=C.memo(function(e){var n=(0,d._)((0,C.useState)(null),2),t=n[0],r=n[1],o=(0,d._)((0,C.useState)(!1),2),i=o[0],a=o[1],c=(0,C.useRef)(null),s=(0,es.X7)({onShowShare:function(){(0,E.y)((0,h.jsxs)(h.Fragment,{children:["今日次数已用完，分享得50次 ",(0,h.jsx)("span",{style:{color:"#2C70E4"},onClick:function(){a(!0)},children:"去分享"})]}),{variant:"warning",autoHideDuration:3e3,keep:!0})},onClick:e.onClick}),l=s.advanceUsage,u=s.showShare,p=s.updateMathSearchCount,x=s.shareReward,g=s.setShowShare,m=s.handleClick;return(0,er.bQ)({anchor:t,popover:function(){var e;return null===(e=c.current)||void 0===e?void 0:e.nodeRef.current}},i,function(){a(!1)}),(0,h.jsxs)(y.Z,{direction:"row",justifyContent:"right",children:[(0,h.jsx)(z.Z,{title:"今日剩余".concat(l.count,"次"),classes:{tooltip:"custom-tooltip-popper",arrow:"custom-tooltip-arrow"},arrow:!0,placement:"top",children:(0,h.jsx)(R.Z,{variant:"outlined",sx:{color:"var(--black)",fontSize:"16px",fontWeight:400,borderColor:"var(--card-border-color)"},startIcon:(0,h.jsx)(et.Z,{}),onMouseEnter:function(){p()},onClick:m,children:l.count===l.total?(0,h.jsxs)(h.Fragment,{children:["结果不满意？试试",(0,h.jsx)("span",{style:{color:"#1570EF"},children:"深度推理"}),"  "]}):"深度推理"})}),u&&l.count!==l.total&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)(R.Z,{sx:{color:"#1570EF",fontSize:"16px",fontWeight:400,textDecoration:"underline"},onClick:function(){a(!0),(0,w.dW)("SearchDetail-clickAdvanceShare",{sessionId:e.sessionId,imgId:e.imgId})},ref:r,variant:"text",children:["分享得",x,"次"]}),t&&(0,h.jsx)(er.ZP,{ref:c,anchor:t,open:i,onOpenChanged:a,children:(0,h.jsx)(f.Z,{sx:{padding:"20px"},children:(0,h.jsx)(eo.gv,{showUrl:e.shareUrl+"?infer_share=1",onConfirm:function(){p(),g(!1),a(!1)}})})})]})]})}),eE=C.memo(function(e){var n=(0,C.useRef)("");(0,C.useEffect)(function(){n.current=e.shareUrl+"?infer_share=1"},[e.shareUrl]);var t=(0,ei.L)({onReject:function(){(0,w.vQ)(n.current).then(function(){(0,E.y)("分享链接已复制到剪贴板",{variant:"success",autoHideDuration:3e3})})}}).share,r=(0,d._)((0,C.useState)(!1),2);r[0],r[1];var o=(0,C.useCallback)(function(){var r={title:e.title,link:n.current,imgUrl:ea.re.ShareIcon,desc:e.desc};t(function(){return r},"wechatFriend")},[e.title,e.shareUrl,e.desc]),i=(0,es.X7)({onShowShare:function(){(0,E.y)((0,h.jsxs)(h.Fragment,{children:["今日次数已用完，分享得50次 ",(0,h.jsx)("span",{style:{color:"#2C70E4"},onClick:function(){p()},children:"去分享"})]}),{variant:"warning",autoHideDuration:3e3,keep:!0})},onClick:e.onClick}),a=i.advanceUsage,c=i.showShare,s=i.updateMathSearchCount,l=i.shareReward,u=i.setShowShare;i.handleClick;var p=(0,C.useCallback)(function(){(0,eo.Y$)({onShare:o,onCancel:function(){},onConfirm:function(){s(),u(!1)}})},[o,s]);return(0,h.jsxs)(y.Z,{direction:"row",justifyContent:"space-between",children:[(0,h.jsx)(R.Z,{variant:"contained",sx:{color:"var(--black)",height:"40px",flex:1,fontSize:"14px",fontWeight:400,backgroundColor:"var(--white-5)","&:hover":{backgroundColor:"var(--white-5)"}},startIcon:(0,h.jsx)(et.Z,{}),onMouseEnter:function(){s()},onClick:e.onClick,children:a.count===a.total?(0,h.jsxs)(h.Fragment,{children:["结果不满意？试试",(0,h.jsx)("span",{style:{color:"#1570EF"},children:"深度推理"}),"  "]}):(0,h.jsxs)(h.Fragment,{children:["深度推理",(0,h.jsx)("span",{style:{color:"var(--content-op-color)",marginLeft:"10px"},children:"今日剩余".concat(a.count,"次")})]})}),c&&a.count!==a.total&&(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)(R.Z,{sx:{color:"#1570EF",fontSize:"16px",fontWeight:400,textDecoration:"underline"},onClick:function(){(0,w.dW)("SearchDetail-advanceShareClick",{sessionId:e.sessionId,imgId:e.imgId}),p()},variant:"text",children:["分享得",l,"次"]})})]})}),eT=function(e){var n=e.referencesNums,t=e.references,r=e.fullScreen;e.searchResultId;var o=(0,d._)((0,C.useState)([]),2),i=o[0],a=o[1];return(0,C.useEffect)(function(){if(t){var e=n.map(function(e,n){return{index:e-1,link:t[e-1]}});a((0,ec._p)(e))}},[t,n]),(0,h.jsx)(h.Fragment,{children:i.map(function(n,t){return(0,h.jsx)(ej,{searchResultId:e.searchResultId,openInNewWindow:!0,from:r?ec.ik.TABLE_FULL:ec.ik.TABLE,index:n.num,pages:n.pages,engineType:e.engineType,num:n.link.display.refer_id,link:n.link},t)})})},e_=C.memo(function(e){var n=e.headers,t=e.data,r=e.fullScreen;return(0,h.jsx)(f.Z,{sx:e.sx,children:(0,h.jsxs)(J.Z,{className:I()["result-table"],children:[(0,h.jsx)(j.Z,{sx:{position:"sticky",top:0},children:n.map(function(e,n){return(0,h.jsx)($.Z,{sx:{minWidth:"90px"},children:e},n)})}),(0,h.jsx)(Q.Z,{children:t.map(function(t,o){return(0,h.jsx)(Y.Z,{children:n.map(function(n,o){var i,a,c;return(0,h.jsxs)($.Z,{children:[null===(i=t[n])||void 0===i?void 0:i.value,(null===(a=t[n])||void 0===a?void 0:a.referenceNums)&&(0,h.jsx)(eT,{searchResultId:e.searchResultId,fullScreen:r,references:e.references,referencesNums:null===(c=t[n])||void 0===c?void 0:c.referenceNums,engineType:e.engineType})]},o)})},o)})})]})})}),eR=(0,C.forwardRef)(function(e,n){var t=(0,d._)((0,C.useState)(!1),2),r=t[0],o=t[1],i=(0,d._)((0,C.useState)([]),2),a=i[0],c=i[1],s=(0,d._)((0,C.useState)([]),2),l=s[0],u=s[1],p=(0,C.useRef)(!1);return(0,C.useImperativeHandle)(n,function(){return{show:function(e,n){c(e),u(n),o(!0),p.current=!1},hide:function(){o(!1),p.current=!0},isClosed:function(){return p.current}}},[]),(0,h.jsxs)(ee.k,{open:r,onClose:function(){o(!1),p.current=!0},children:[(0,h.jsx)(en._$,{title:(0,h.jsxs)(y.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,h.jsx)(_.Z,{}),(0,h.jsx)(f.Z,{children:e.loading?"整理中…":"汇总表格"})]}),onClose:function(){o(!1),p.current=!0}}),(0,h.jsx)(e_,{searchResultId:e.searchResultId,engineType:e.engineType,references:e.references,sx:{borderRadius:"10px",overflow:"auto",border:"solid 1px var(--card-border-color)",maxWidth:"80vw",maxHeight:"80vh"},headers:a,data:l})]})}),eW=C.memo(function(e){var n=(0,d._)((0,C.useState)(e.visible),2),t=n[0],r=n[1],o=(0,C.useCallback)(function(){e.onClick(),r(!1)},[e.onClick]);return t?(0,h.jsx)(R.Z,{onClick:o,sx:{padding:"0",width:"100%",display:"block",textAlign:"left",borderRadius:"10px",overflow:"hidden",marginTop:"20px"},children:(0,h.jsxs)(y.Z,{className:I()["generate-table-btn"],spacing:1,direction:"row",alignItems:"center",children:[(0,h.jsx)(f.Z,{className:I()["generate-table-key"],sx:{color:"var(--black)"},children:"整理表格："}),(0,h.jsx)(f.Z,{className:I()["generate-table-value"],sx:{flex:1},color:"var(--content-op-color)",children:e.titles.join("、")}),(0,h.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,h.jsx)("path",{d:"M13.2999 6.29994H7.70005V0.700055C7.70005 0.313606 7.38645 0 7 0C6.61355 0 6.29994 0.313606 6.29994 0.700055V6.29994H0.700055C0.313606 6.29994 0 6.61355 0 7C0 7.38645 0.313606 7.70005 0.700055 7.70005H6.29994V13.2999C6.29994 13.6872 6.61355 14 7 14C7.38645 14 7.70005 13.6872 7.70005 13.2999V7.70005H13.2999C13.6872 7.70005 14 7.38645 14 7C14 6.61355 13.6872 6.29994 13.2999 6.29994Z",fill:"var(--black1)"})})]})}):(0,h.jsx)(h.Fragment,{})}),eO=function(e){e.isH5,e.pptId;var n=(0,C.useRef)(null),t=(0,d._)((0,C.useState)(!1),2),r=t[0],o=t[1],i=(0,d._)(C.useState(!1),2),a=i[0],c=i[1];(0,P.LM)(function(e){return e.login});var s=(0,M.useSearchParams)(),l=(0,d._)((0,er.bQ)({exportBtn:n},a,function(){c(!1)}),1)[0],u=(0,d._)((0,C.useState)(!1),2),p=u[0],g=u[1],v=function(){if(p){(0,E.y)("图片正在生成中",{variant:"info",autoHideDuration:2e3});return}o(!0),g(!0),y()},y=function(){var n="".concat("https://metaso.cn");(location.href.indexOf("172.168")>-1||location.href.indexOf("localhost")>-1)&&(n="http://".concat(location.hostname,":3001")),n+="/ppt-share-img?pptId=".concat(e.pptId),s.get("shareKey")&&(n+="&shareKey=".concat(s.get("shareKey"))),s.get("tsk")&&(n+="&tsk=".concat(s.get("tsk")));var t=e.getShareUrl(),r={url:n+="&shareUrl=".concat(encodeURIComponent(t),"&pptId=").concat(e.pptId),domain:"metaso.cn",uid:(0,T.ejW)("uid"),sid:(0,T.ejW)("sid"),aliyungf_tc:(0,T.ejW)("aliyungf_tc"),defaultViewport:{width:1572},event_name:"ppt-image-share",client:(0,k.Fk)()};(0,T.PSx)(r).then(function(e){var n="ppt-".concat(new Date().getTime(),".png");(0,w.GN)(e.data.image,n)}).catch(function(e){(0,E.y)("保存图片失败",{variant:"error",autoHideDuration:2e3})}).finally(function(){g(!1),o(!1)})},j=(0,C.useCallback)(function(n){if(n.stopPropagation(),n.preventDefault(),!r){if(e.onlyCopyLink||s&&s.get("ssi")&&T.FqK.PPT==s.get("shareType")){var t;null===(t=e.onShareClick)||void 0===t||t.call(e)}else e.clickSaveImage?v():c(!a)}},[a,e.chapterId,e.clickSaveImage,r]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(f.Z,{ref:n,sx:{color:"#667085",height:36,minWidth:0,fontSize:"16px",fontWeight:400,display:"flex",alignItems:"center",justifyContent:"center"},onClick:j,children:r?(0,h.jsx)(x.Z,{size:"1.5em",sx:{color:"gray"},thickness:2}):e.button?e.button:(0,h.jsxs)(f.Z,{sx:{color:"var(--content-op-color)",fontSize:"16px",fontWeight:400,display:"flex",justifyContent:"start",alignItems:"center",gap:"4px"},children:[(0,h.jsx)(eu.Z,{}),(0,h.jsx)("span",{children:"分享"})]})}),(0,h.jsxs)(er.ZP,{open:a,isAutoUpdate:!0,ref:l,zIndex:2002,anchor:n.current,offsetOptions:{mainAxis:5,crossAxis:0},sxs:{contentWrapper:{p:"0",borderRadius:"8px"}},children:[(0,h.jsxs)(m.Z,{onClick:function(){var n;c(!1),null===(n=e.onShareClick)||void 0===n||n.call(e)},sx:{" svg":{width:"20px",height:"20px"}},style:{fontSize:"14px",color:"var(--export-menu-color)",gap:"4px",padding:"3px 21px",height:"22px"},children:[(0,h.jsx)(ed.Z,{}),(0,h.jsx)(f.Z,{style:{width:"70px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,h.jsx)("span",{style:{height:"14px"},children:"复制链接"})})]}),(0,h.jsxs)(m.Z,{onClick:function(){c(!1),v()},sx:{" svg":{width:"20px",height:"20px"}},style:{fontSize:"14px",color:"var(--export-menu-color)",gap:"4px",padding:"3px 21px",height:"22px"},children:[(0,h.jsx)(eh.Z,{}),(0,h.jsx)(f.Z,{style:{width:"70px",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,h.jsx)("span",{style:{height:"14px"},children:"下载图片"})})]})]})]})}},80089:function(e,n,t){t.d(n,{Z:function(){return l}});var r=t(5194),o=t(1780),i=t(46796),a=t(57437),c=t(93316);t(2265);var s=t(7870);function l(e){var n=e.children,l=(0,i._)(e,["children"]);return(0,a.jsx)(c.SV,(0,o._)((0,r._)({fallbackRender:u,onError:function(e,n){t.e(62297).then(t.t.bind(t,62297,23)).then(function(t){var r,o=new t.default(navigator.userAgent),i={os:o.os(),mobile:o.mobile(),tablet:o.tablet(),phone:o.phone()};"userAgentData"in navigator&&(r=navigator.userAgentData);var a={userAgent:navigator.userAgent,url:location.href,error:null==e?void 0:e.message,errorInfo:n,mobileInfo:i,userAgentData:r};(0,s.dW)("metalaw_component_error",a)})}},l),{children:n}))}function u(e){return e.error,e.resetErrorBoundary,(0,a.jsx)("p",{children:"噢，似乎遇到了一点问题，请刷新界面尝试解决该问题。"})}}}]);