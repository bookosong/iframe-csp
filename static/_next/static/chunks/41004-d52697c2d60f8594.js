(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41004],{41004:function(e,n,t){"use strict";t.d(n,{l2:function(){return er},G0:function(){return J},J_:function(){return en},_x:function(){return et},ZP:function(){return G},CV:function(){return ee},hC:function(){return ei}});var i,r,a,o,s,c,l=t(50059),u=t(57437),m=t(87105),h=t.n(m),d=t(81705),g=t(16701),f=t(62016),p=t(5767),v=t(2265),w=t(78693),x=t(19643),j=t(59832),k=t(36760),_=t.n(k),b=t(22322),C=t(54632),E=t(7870),L=t(99305),N=t(26058),y=t(94746);function S(){return(S=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var Z=function(e){return y.createElement("svg",S({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},e),i||(i=y.createElement("path",{fill:"currentColor",d:"M7.385 3A4.385 4.385 0 0 0 3 7.385v9.23A4.384 4.384 0 0 0 7.385 21h9.23A4.384 4.384 0 0 0 21 16.615V11.54a.693.693 0 0 0-1.385 0v2.713l-2.122-1.697a2.54 2.54 0 0 0-3.483.296l-1.175 1.321c-.112-.1-2.395-2.177-3.855-3.504a2.54 2.54 0 0 0-3.23-.152c-.595.445-.865.649-1.365 1.024V7.385a3 3 0 0 1 3-3h5.538a.693.693 0 0 0 0-1.385zm9.692 0a3.001 3.001 0 0 0 0 6c.577 0 1.11-.172 1.568-.454l1.174 1.173a.69.69 0 1 0 .977-.977L19.623 7.57c.282-.458.454-.992.454-1.569 0-1.656-1.344-3-3-3m0 1.385a1.616 1.616 0 1 1-.001 3.232 1.616 1.616 0 0 1 0-3.232M9.692 5.538a1.385 1.385 0 1 0 0 2.77 1.385 1.385 0 0 0 0-2.77m-2.365 5.856c.26.012.516.113.721.3l3.867 3.515c-1.74 1.959-3.748 4.216-3.917 4.406h-.613a3 3 0 0 1-3-3V13.27l2.196-1.646a1.15 1.15 0 0 1 .746-.229m8.482 1.992a1.15 1.15 0 0 1 .819.25l2.987 2.39v.59a3 3 0 0 1-3 3H9.85l5.196-5.846c.204-.229.48-.36.765-.384"})))},M=t(19764),V=t(43306),P=t(84054);function U(){return(U=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var I=function(e){return y.createElement("svg",U({xmlns:"http://www.w3.org/2000/svg",width:13,height:12,fill:"none",viewBox:"0 0 13 12"},e),r||(r=y.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m1.432 11 10-10m0 0h-10m10 0v10"})))};t(7354);var A=t(73377),D=t(14382),W=t.n(D),O=t(33145),R=t(75825),B=t(79943);function H(){return(H=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var F=function(e){return y.createElement("svg",H({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",viewBox:"0 0 20 20"},e),a||(a=y.createElement("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m19 19-4.35-4.35M9 6v6M6 9h6m5 0A8 8 0 1 1 1 9a8 8 0 0 1 16 0"})))};function z(){return(z=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var X=function(e){return y.createElement("svg",z({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",viewBox:"0 0 20 20"},e),o||(o=y.createElement("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m19 19-4.35-4.35M6 9h6m5 0A8 8 0 1 1 1 9a8 8 0 0 1 16 0"})))};function q(){return(q=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var Y=function(e){return y.createElement("svg",q({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",viewBox:"0 0 20 20"},e),s||(s=y.createElement("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 13v1.2c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311C16.72 19 15.88 19 14.2 19H5.8c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311C1 16.72 1 15.88 1 14.2V13m14-5-5 5m0 0L5 8m5 5V1"})))};function Q(){return(Q=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var K=function(e){return y.createElement("svg",Q({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),c||(c=y.createElement("path",{fill:"#fff",d:"M4.385 0A4.385 4.385 0 0 0 0 4.385v9.23A4.384 4.384 0 0 0 4.385 18h9.23A4.384 4.384 0 0 0 18 13.615V8.538a.693.693 0 0 0-1.385 0v2.714l-2.122-1.697a2.54 2.54 0 0 0-3.483.296l-1.175 1.321c-.112-.1-2.395-2.177-3.855-3.504a2.54 2.54 0 0 0-3.23-.152c-.595.445-.865.649-1.365 1.024V4.385a3 3 0 0 1 3-3h5.538a.693.693 0 0 0 0-1.385zm9.692 0a3.001 3.001 0 0 0 0 6c.577 0 1.11-.172 1.568-.454l1.174 1.173a.69.69 0 1 0 .977-.977L16.623 4.57c.282-.458.454-.992.454-1.569 0-1.656-1.344-3-3-3m0 1.385a1.616 1.616 0 1 1-.001 3.232 1.616 1.616 0 0 1 0-3.232M6.692 2.538a1.385 1.385 0 1 0 0 2.77 1.385 1.385 0 0 0 0-2.77M4.327 8.394c.26.012.516.113.721.3l3.867 3.515c-1.74 1.959-3.748 4.216-3.917 4.406h-.613a3 3 0 0 1-3-3V10.27L3.58 8.623a1.15 1.15 0 0 1 .746-.229m8.482 1.992a1.15 1.15 0 0 1 .819.25l2.987 2.39v.59a3 3 0 0 1-3 3H6.85l5.196-5.846c.204-.229.48-.36.765-.384"})))},T=t(74634);function G(e){var n,t=(0,l._)((0,v.useState)(1),2),i=t[0],r=t[1],a=(0,v.useRef)(null),o=(0,v.useRef)(null),s=(0,l._)((0,v.useState)(!1),2),c=s[0],m=s[1],j=(0,l._)((0,v.useState)(!1),2),k=j[0],_=j[1],b=(0,l._)((0,v.useState)("25%"),2),C=(b[0],b[1]),E=(0,l._)((0,v.useState)("25%"),2),L=(E[0],E[1]),N=(0,l._)((0,v.useState)("50%"),2),y=(N[0],N[1]),S=(0,l._)((0,v.useState)(0),2),Z=S[0],M=S[1],V=(0,l._)((0,v.useState)(0),2),P=V[0],U=V[1];(0,v.useEffect)(function(){if(e.isFeedbackImage){var n=window.innerWidth,t=window.innerHeight,i=new Image;i.src=e.src,i.onload=function(){var e=this.width,i=this.height,a=.5*n/e;i>e?(r(a=.5*t/i),e*=a,i=.5*t,y(e+"px"),C("calc(50% - "+.5*e+"px)")):(r(a),e=.5*n,i*=a,y("50%"),L("calc(50% - "+.5*i+"px)"))}}},[e.src]),(0,v.useLayoutEffect)(function(){var e,n,t=a.current||o.current,i=null==t?void 0:null===(n=t.parentElement)||void 0===n?void 0:null===(e=n.parentElement)||void 0===e?void 0:e.parentElement;i&&t&&r(Math.min(1,Math.min((i.clientHeight-120)/t.height,i.clientWidth/t.width)))},[k,c]);var I=(0,v.useRef)(0),A=(0,v.useRef)(0),D=(0,v.useRef)(!1),W=(0,v.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),I.current=e.pageX-Z,A.current=e.pageY-P,D.current=!0},[Z,P]),O=(0,v.useCallback)(function(e){if(D.current){var n=e.pageX-I.current,t=e.pageY-A.current;(0,v.startTransition)(function(){M(n),U(t)})}},[]),R=(0,v.useCallback)(function(e){var n=a.current||o.current,t=1;r(t=e.deltaY<0?1.1*i:i/1.1);var s=n.getBoundingClientRect(),c=t/i,l=Z-(1-c)*(s.width/2-e.clientX+s.x),u=P-(1-c)*(s.height/2-e.clientY+s.y);M(l),U(u)},[i,Z,P]),B=(0,v.useCallback)(function(e){D.current=!1},[]);return(0,u.jsxs)("div",{className:h().mask,onClick:e.onClose,children:[(0,u.jsx)(p.h,{icon:(0,u.jsx)(d.Z,{}),className:h()["action-btn"]+" "+h()["close-btn"],onClick:e.onClose}),(0,u.jsx)(w.Z,{sx:{position:"absolute",top:0,zIndex:1,textAlign:"center",padding:"20px",color:"white",width:"100%"},children:(0,u.jsx)(w.Z,{onClick:function(n){n.preventDefault(),n.stopPropagation(),e.imgMeta&&(e.imgMeta.hostPageUrl||e.imgMeta.hostPageDisplayUrl)&&window.open(e.imgMeta.hostPageUrl||e.imgMeta.hostPageDisplayUrl)},component:"span",sx:{textShadow:"0px 0px 1px #000",cursor:"pointer","&:hover":{textDecoration:"underline"}},className:"pure-button",children:null===(n=e.imgMeta)||void 0===n?void 0:n.name})}),(0,u.jsxs)(w.Z,{className:h()["main-panel"],children:[e.isFeedbackImage&&(0,u.jsx)(u.Fragment,{children:(0,u.jsx)("img",{ref:a,className:h()["feedback-big-image"],src:e.src,style:{transform:"scale(".concat(i,")")}})}),!e.isFeedbackImage&&(0,u.jsx)(w.Z,{sx:{flex:1,display:"flex",justifyContent:"center"},children:(0,u.jsxs)(x.Z,{onWheel:R,style:{transform:"translate(".concat(Z,"px,").concat(P,"px)")},onMouseDown:W,onMouseMove:O,onMouseUp:B,children:[(c||!k)&&(0,u.jsx)("img",{onClick:function(e){e.stopPropagation()},ref:a,className:h().image,style:{transform:"scale(".concat(i,")")},src:e.src}),!c&&e.imgMeta&&(0,u.jsx)("img",{onError:function(){m(!0)},onLoad:function(e){m(!1),_(!0)},onClick:function(e){e.stopPropagation()},ref:o,className:h().image,src:e.imgMeta.contentUrl,style:{width:k?"unset":"0",transform:"scale(".concat(i,")")}})]})}),(0,u.jsxs)("div",{className:h()["action-buttons"],onClick:function(e){e.preventDefault(),e.stopPropagation()},children:[(0,u.jsx)(p.h,{icon:(0,u.jsx)(g.Z,{}),className:h()["action-btn"],onClick:function(){r(1.1*i)}}),(0,u.jsx)(p.h,{icon:(0,u.jsx)(f.Z,{}),className:h()["action-btn"],onClick:function(){r(i/1.1)}}),!e.isFeedbackImage&&(0,u.jsx)(p.h,{icon:(0,u.jsx)("svg",{viewBox:"0 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",style:{flexShrink:0},children:(0,u.jsx)("path",{d:"M21.6023 15.3506V16.5506C21.6023 18.2307 21.6023 19.0708 21.2753 19.7126C20.9877 20.277 20.5288 20.736 19.9643 21.0236C19.3225 21.3506 18.4825 21.3506 16.8023 21.3506H8.40229C6.72214 21.3506 5.88206 21.3506 5.24032 21.0236C4.67584 20.736 4.2169 20.277 3.92928 19.7126C3.60229 19.0708 3.60229 18.2307 3.60229 16.5506V15.3506M17.6023 10.3506L12.6023 15.3506M12.6023 15.3506L7.60229 10.3506M12.6023 15.3506V3.35059",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),className:h()["action-btn"],onClick:function(){ee("图片",e.src)}}),e.onSubmit&&(0,u.jsx)(p.h,{title:"按图片搜索",icon:(0,u.jsx)(K,{}),className:h()["action-btn"],onClick:function(){e.onSubmit(e.imgMeta,e.imgMeta.name),e.onClose()}})]})]})]})}function J(e){var n=(0,l._)((0,v.useState)(e.index),2),t=n[0],i=n[1],r=(0,l._)((0,v.useState)(window.innerWidth),2),a=r[0];r[1];var o=(0,l._)((0,v.useState)(window.innerWidth),2),s=o[0];o[1];var c=(0,v.useRef)(),m=(0,l._)((0,v.useState)(!0),2),d=m[0],g=m[1];eo.useTools().getAPI;var f=(0,v.useCallback)(function(e,n,t,i){if(1===n){g(!0);return}g(!1)},[]);return(0,u.jsxs)(w.Z,{className:h().mask,onClick:e.onClose,children:[(0,u.jsxs)(w.Z,{className:h()["main-panel"],children:[(0,u.jsx)(w.Z,{className:h().header,children:(0,u.jsx)(w.Z,{className:"flex-container align-center",children:(0,u.jsx)("svg",{width:"25",height:"24",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,u.jsx)("path",{d:"M15.432 18L9.43201 12L15.432 6",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})}),(0,u.jsx)(M.tq,{initialSlide:t,zoom:!0,modules:[A.LG],allowSlideNext:d,allowSlidePrev:d,onZoomChange:f,onActiveIndexChange:function(e){return i(e.activeIndex)},spaceBetween:50,className:h()["iv-swiper-container"],wrapperClass:h()["iv-swiper-wrapper"],onSlideChange:function(e){return console.log("slide change",e.activeIndex)},onSwiper:function(e){return c.current=e},children:e.allSrc.map(function(e,n){return(0,u.jsx)(M.o5,{className:h()["iv-swiper-slide"],zoom:!0,children:(0,u.jsx)(w.Z,{children:(0,u.jsx)(O.default,{src:e,alt:"",width:a,height:s,style:{background:"white"}})})},e)})})]}),e.allSrc.length>0&&(0,u.jsx)(w.Z,{className:h()["image-point-container"],children:e.allSrc.map(function(e,n){return(0,u.jsx)(w.Z,{className:h()["image-point"]+" ".concat(n===t?h()["image-point-active"]:"")},n)})})]})}var $=v.memo(function(e){var n=(0,v.useRef)(null);return(0,v.useEffect)(function(){e.index===e.activeIndex&&e.loadFinished&&n.current.scrollIntoView({behavior:"smooth",block:"center"})},[e.activeIndex,e.loadFinished]),(0,u.jsx)(w.Z,{ref:n,className:_()(h()["thumb-image"],e.index===e.activeIndex?h().active:""),onClick:e.onClick,children:(0,u.jsx)("img",{src:e.img})})});function ee(e,n,t){if(!navigator.onLine){(0,b.y)("下载失败，无网络连接",{variant:"error"});return}var i=new Image;i.setAttribute("crossOrigin","anonymous");var r=0;i.onload=function(){var n=document.createElement("canvas");n.width=i.width,n.height=i.height,n.getContext("2d").drawImage(i,0,0,i.width,i.height);var t=n.toDataURL("image/png"),r=document.createElement("a"),a=new MouseEvent("click");r.download=e||"下载图片名称",r.href=t,r.dispatchEvent(a),document.body.removeChild(n),document.body.removeChild(r)},i.onerror=function(e){var n=new URL(i.src);if(0==r)n.searchParams.delete("time"),i.src=n.href;else if(1==r&&t){var a=new URL(t);a.searchParams.set("time",Date.now().toString()),i.src=a.href}else(0,b.y)("请使用鼠标右键点击图片手动保存",{variant:"info",autoHideDuration:3e3});r++};var a=new URL(n);a.searchParams.set("time",Date.now().toString()),i.src=a.href}function en(e){var n=e.index,t=e.images,i=(0,l._)((0,v.useState)(n),2),r=i[0],a=i[1],o=(0,l._)((0,v.useState)(1),2),s=o[0],c=o[1],m=(0,l._)((0,v.useState)(!1),2),d=m[0],g=m[1],f=(0,l._)((0,v.useState)(!1),2),j=f[0],k=f[1],_=(0,v.useRef)(0),b=(0,v.useRef)(0),C=(0,v.useRef)(null),E=(0,l._)((0,v.useState)(!1),2),L=E[0],N=E[1];function y(e){e.preventDefault(),"ArrowDown"===e.key||"ArrowRight"===e.key?_.current<b.current-1&&a(_.current+1):("ArrowUp"===e.key||"ArrowLeft"===e.key)&&_.current>0&&a(_.current-1)}(0,v.useEffect)(function(){b.current=t.length},[t,n]),(0,T.Vo)("keydown",function(n){"Escape"===n.key&&e.onClose&&e.onClose()}),(0,v.useEffect)(function(){N(!1),_.current=r,c(1),g(!1),k(!1)},[r]),(0,v.useEffect)(function(){d&&c(1)},[d]),(0,v.useEffect)(function(){return document.addEventListener("keydown",y),function(){document.removeEventListener("keydown",y)}},[]);var S=function(e,n){ee(e.name,n?e.contentUrl:e.thumbnailUrl,e.thumbnailUrl)};(0,v.useLayoutEffect)(function(){j&&!d&&(C.current&&C.current.parentElement&&C.current.parentElement.parentElement&&(C.current.height>C.current.parentElement.parentElement.clientHeight||C.current.width>C.current.parentElement.parentElement.clientWidth)&&(C.current.width>C.current.parentElement.parentElement.clientHeight&&C.current.width>C.current.parentElement.parentElement.clientWidth?C.current.height>C.current.width?c(C.current.parentElement.parentElement.clientHeight/C.current.height):c(C.current.parentElement.parentElement.clientWidth/C.current.width):C.current.height>C.current.parentElement.parentElement.clientHeight?c(C.current.parentElement.parentElement.clientHeight/C.current.height):c(C.current.parentElement.parentElement.clientWidth/C.current.width)),setTimeout(function(){N(!0)},100))},[j,d]);var Z=(0,v.useMemo)(function(){var e,n;return(0,u.jsxs)(u.Fragment,{children:[(d||!j)&&(0,u.jsx)("img",{className:h().image,style:{transform:"scale(".concat(s,")")},src:t[r].thumbnailUrl||(null===(e=t[r]._source)||void 0===e?void 0:e.image_url)}),!d&&(0,u.jsx)("img",{onError:function(){g(!0)},onLoad:function(e){g(!1),k(!0)},onClick:function(e){e.stopPropagation()},ref:C,className:h().image,src:t[r].contentUrl||(null===(n=t[r]._source)||void 0===n?void 0:n.image_url),style:{width:j?"unset":"0",transform:"scale(".concat(s,")"),transition:L?"width .3s, transform .3s":"unset !important"}})]})},[d,j,r,t,s,L]),M=(0,v.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),a(r<=0?0:r-1)},[r,t]),V=(0,v.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),a(r>=t.length-1?t.length-1:r+1)},[r,t]);return(0,u.jsxs)("div",{className:h().mask,onClick:e.onClose,children:[(0,u.jsxs)(w.Z,{className:h()["mask-header"],children:[(0,u.jsx)(w.Z,{className:h().name,onClick:function(e){var n;e.preventDefault(),e.stopPropagation(),window.open(t[r].hostPageUrl||t[r].hostPageDisplayUrl||(null===(n=t[r]._source)||void 0===n?void 0:n.image_url))},children:t[r].name}),(0,u.jsx)(w.Z,{className:h()["image-index"],children:(0,u.jsxs)(w.Z,{children:[r+1,"/",t.length]})})]}),(0,u.jsxs)(x.Z,{direction:"row",flex:1,overflow:"auto",children:[(0,u.jsxs)(w.Z,{className:h()["main-panel"],children:[(0,u.jsx)(w.Z,{className:h()["page-btn"],onClick:M,title:"上一页",children:(0,u.jsx)("svg",{width:"18",height:"15",viewBox:"0 0 18 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,u.jsx)("path",{d:"M17 7.5H1M1 7.5L7 13.5M1 7.5L7 1.5",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,u.jsx)(w.Z,{sx:{flex:1,display:"flex",justifyContent:"center"},children:Z}),(0,u.jsx)(w.Z,{className:h()["page-btn"],onClick:V,title:"下一页",children:(0,u.jsx)("svg",{width:"18",height:"15",viewBox:"0 0 18 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,u.jsx)("path",{d:"M1 7.5H17M17 7.5L11 1.5M17 7.5L11 13.5",stroke:"white",strokeWidth:"2",strokeLinecap:"round","stroke-linejoin":"round"})})}),(0,u.jsx)(w.Z,{}),(0,u.jsxs)("div",{className:h()["action-buttons"],onClick:function(e){e.stopPropagation()},children:[(0,u.jsx)(p.h,{title:"放大",icon:(0,u.jsx)(F,{}),className:h()["action-btn"],onClick:function(){c(1.1*s)}}),(0,u.jsx)(p.h,{title:"缩小",icon:(0,u.jsx)(X,{}),className:h()["action-btn"],onClick:function(){c(s/1.1)}}),(0,u.jsx)(p.h,{title:"下载原图",icon:(0,u.jsx)(Y,{}),className:h()["action-btn"],onClick:function(){return S(t[r],!d&&j)}}),e.onSubmit&&(0,u.jsx)(p.h,{title:"按图片搜索",icon:(0,u.jsx)(K,{}),className:h()["action-btn"],onClick:function(){var n;e.onSubmit(t[r],t[r].name),null===(n=e.onClose)||void 0===n||n.call(e)}})]})]}),(0,u.jsx)(x.Z,{spacing:2,className:h()["right-panel"],onClick:function(e){e.stopPropagation()},children:t.map(function(e,n){var t;return(0,u.jsx)($,{loadFinished:d||j,index:n,activeIndex:r,img:e.thumbnailUrl||(null===(t=e._source)||void 0===t?void 0:t.image_url),onClick:function(){a(n)}},n)})})]})]})}var et=function(e){(0,E.vQ)(e,!0),(0,b.y)("图像链接已复制到剪贴板",{variant:"success",autoHideDuration:3e3})},ei=function(e,n){var t,i;if((null===(t=(0,N.ZD)())||void 0===t?void 0:t.isMiniWebView)||(null===(i=(0,N.ZD)())||void 0===i?void 0:i.isAliApp)){(0,b.y)("请长按图片手动保存",{variant:"info",autoHideDuration:3e3});return}ee(e.name,e.thumbnailUrl)};function er(e){var n,t=(0,B.WS)(),i=e.index,r=e.images,a=(0,l._)((0,v.useState)(i),2),o=a[0],s=a[1],c=(0,v.useRef)(),m=(0,l._)((0,v.useState)(!0),2),d=m[0],g=m[1],f=eo.useTools().getAPI,p=(0,v.useRef)({}),x=(0,T.a8)(),k=(0,v.useCallback)(function(e,n,t,i){if(1===n){g(!0);return}g(!1)},[]);(0,v.useEffect)(function(){r.length||t.replace(R.l.Home)},[r.length]);var _=(0,v.useCallback)(function(){var e=f("image").find(function(e){var n;return(null===(n=e.current)||void 0===n?void 0:n.index)===o});if(e.current){var n=e.current.getStatus(),t=n.error,i=n.loaded;et(!t&&i?r[o].contentUrl:r[o].thumbnailUrl)}},[f,o,r]),b=e.sourceResultLink;return r.length?(0,u.jsxs)(w.Z,{className:h().mask,sx:(0,E.KI)({zIndex:100},2),onClick:function(){navigator.userAgent.indexOf("Quark")>-1&&navigator.userAgent.indexOf("Mobile")>-1?e.onClose&&e.onClose():t.back()},children:[(0,u.jsxs)(w.Z,{className:h()["main-panel"],children:[(0,u.jsxs)(w.Z,{className:h().header,children:[(0,u.jsx)(j.Z,{children:(0,u.jsx)("svg",{width:"25",height:"24",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,u.jsx)("path",{d:"M15.432 18L9.43201 12L15.432 6",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,u.jsx)(w.Z,{className:h().name,children:r[o].name}),x&&b&&(0,u.jsx)(C.Z,{sx:{color:"#fff"},onClick:function(e){e.stopPropagation(),t.push(b)},children:"查看结果"}),!e.noShare&&(0,u.jsx)(j.Z,{onClick:function(e){e.stopPropagation(),_()},sx:{color:"white",m:-1},children:(0,u.jsx)(V.Z,{})})]}),(0,u.jsx)(M.tq,{initialSlide:i,zoom:!0,modules:[A.LG],allowSlideNext:d,allowSlidePrev:d,onZoomChange:k,onActiveIndexChange:function(e){return s(e.activeIndex)},spaceBetween:50,className:h()["iv-swiper-container"],wrapperClass:h()["iv-swiper-wrapper"],onSlideChange:function(e){return console.log("slide change",e.activeIndex)},onSwiper:function(e){return c.current=e},children:r.map(function(e,n){var t;return(0,u.jsx)(M.o5,{className:h()["iv-swiper-slide"],zoom:!0,children:(0,u.jsx)(w.Z,{className:"".concat((null===(t=(0,N.ZD)())||void 0===t?void 0:t.isAliApp)?h()["aliapp-image"]:""),children:(0,u.jsx)(ea,{onError:function(){p.current[n]=!0},index:n,image:e},e.contentUrl)})},e.contentUrl)})})]}),(0,u.jsxs)("div",{className:h()["action-buttons"],onClick:function(e){e.stopPropagation()},children:[(r[o].hostPageUrl||r[o].hostPageDisplayUrl||(null===(n=r[o]._source)||void 0===n?void 0:n.image_url))&&(0,u.jsx)(C.Z,{startIcon:(0,u.jsx)(I,{}),className:h()["action-btn-h5"],onClick:function(e){var n,t=r[o].hostPageUrl||r[o].hostPageDisplayUrl||(null===(n=r[o]._source)||void 0===n?void 0:n.image_url);(0,L.Uq)(t)||window.open(t)},children:"打开原网页"}),(0,u.jsx)(C.Z,{startIcon:(0,u.jsx)(P.Z,{}),className:h()["action-btn-h5"],onClick:function(){ei(r[o],p.current[o])},children:"下载"}),r[o].caption&&(0,u.jsx)(C.Z,{startIcon:(0,u.jsx)(Z,{}),className:h()["action-btn-h5"],onClick:function(){e.onSubmit(r[o],r[i].name)},children:"按图片搜索"})]})]}):(0,u.jsx)(u.Fragment,{})}function ea(e){var n=e.index,t=e.image,i=e.onError,r=e.onLoad,a=(0,l._)((0,v.useState)(!1),2),o=a[0],s=a[1],c=(0,l._)((0,v.useState)(!1),2),m=c[0],d=c[1],g=(0,l._)((0,v.useState)(t.thumbnailUrl),2),f=g[0],p=g[1],w=(0,v.useRef)(null);return eo.useRegister("image",function(){return{index:n,getStatus:function(){return{error:o,loaded:m}},getImg:function(){return w.current}}},[o,m]),(0,u.jsx)(u.Fragment,{children:o||!m?(0,u.jsx)("img",{ref:w,className:h().image,src:f,onError:function(){p(f.replace("thumbnail/","thumbnail//"))}}):(0,u.jsx)("img",{onError:function(){s(!0),null==i||i()},onLoad:function(){s(!1),d(!0),null==r||r()},style:{objectFit:"contain",width:"100%"},ref:w,src:t.contentUrl})})}var eo=W()()({image:{isMulti:!0}})},87105:function(e){e.exports={mask:"imageViewer_mask__g2rz5",header:"imageViewer_header__MMu1I","main-panel":"imageViewer_main-panel__pbSFY","page-btn":"imageViewer_page-btn__mYoKC","mask-header":"imageViewer_mask-header__jeUjX","image-index":"imageViewer_image-index__eUXUE",name:"imageViewer_name__M25X_","right-panel":"imageViewer_right-panel__LOIql","close-btn":"imageViewer_close-btn__yAaHF","action-buttons":"imageViewer_action-buttons__K1Khk","action-btn":"imageViewer_action-btn__5Q7it","action-btn-h5":"imageViewer_action-btn-h5__iQpVm",image:"imageViewer_image__QWbgI","iv-swiper-container":"imageViewer_iv-swiper-container__huZVq","iv-swiper-slide":"imageViewer_iv-swiper-slide___lpmL","thumb-image":"imageViewer_thumb-image__oBkmf",active:"imageViewer_active__BLnAs","arrow-back-icon":"imageViewer_arrow-back-icon__WnqL1","image-point-container":"imageViewer_image-point-container__rzXfv","image-point":"imageViewer_image-point__Cb4Bu","image-point-active":"imageViewer_image-point-active__kFaWj","aliapp-image":"imageViewer_aliapp-image__BIrg5"}}}]);