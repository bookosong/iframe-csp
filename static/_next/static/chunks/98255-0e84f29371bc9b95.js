(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98255],{13615:function(e,t,n){"use strict";var r,a,i=n(94746);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}t.Z=function(e){return i.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:31,height:31,fill:"none",viewBox:"0 0 31 31"},e),r||(r=i.createElement("g",{clipPath:"url(#clip0_3515_32956)"},i.createElement("path",{fill:"#F37520",d:"m16.042 9.418-7.5-7.5c-3 1.65-5.4 4.275-6.75 7.5z"}),i.createElement("path",{fill:"#6167AF",d:"m21.367 15.417 7.5-7.5c-1.65-3-4.275-5.4-7.5-6.675z"}),i.createElement("path",{fill:"#42AAE0",d:"m15.367 20.742 7.5 7.5c3-1.65 5.4-4.275 6.675-7.5z"}),i.createElement("path",{fill:"#5C7CBD",d:"M30.067 19.316c.375-1.35.6-2.775.6-4.2 0-2.1-.45-4.05-1.2-5.85l-9.975 10.05z"}),i.createElement("path",{fill:"#EF5654",d:"M19.942 11.292V.717c-1.35-.375-2.775-.6-4.275-.6-2.025 0-3.975.45-5.775 1.125z"}),i.createElement("path",{fill:"#FFC817",d:"M1.267 10.844c-.375 1.35-.6 2.775-.6 4.275 0 2.1.45 4.05 1.2 5.85l10.05-10.125z"}),i.createElement("path",{fill:"#71BE44",d:"M11.467 18.867v10.65c1.35.375 2.775.6 4.2.6 2.1 0 4.05-.45 5.85-1.2z"}),i.createElement("path",{fill:"#9BCA3B",d:"m10.042 14.742-7.5 7.5c1.65 3 4.35 5.4 7.5 6.75z"}))),a||(a=i.createElement("defs",null,i.createElement("clipPath",{id:"clip0_3515_32956"},i.createElement("path",{fill:"#fff",d:"M.667.117h30v30h-30z"})))))}},86501:function(e,t,n){"use strict";var r,a,i=n(94746);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}t.Z=function(e){return i.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:30,height:31,fill:"none",viewBox:"0 0 30 31"},e),r||(r=i.createElement("g",{fill:"#50B674",clipPath:"url(#clip0_3515_32947)"},i.createElement("path",{d:"M9.354 11.408a.982.982 0 1 0 1.964 0 .982.982 0 0 0-1.964 0M13.745 11.38a.982.982 0 1 0 1.964 0 .982.982 0 0 0-1.964 0M16.2 15.772a.682.682 0 1 0 1.364 0 .682.682 0 0 0-1.364 0M19.664 15.826a.682.682 0 1 0 1.364 0 .682.682 0 0 0-1.364 0"}),i.createElement("path",{d:"M15 .117c-8.29 0-15 6.71-15 15 0 8.291 6.71 15 15 15s15-6.709 15-15c0-8.29-6.71-15-15-15m-2.564 18.464c-.79 0-1.418-.164-2.209-.327l-2.209 1.09.627-1.881c-1.581-1.091-2.509-2.51-2.509-4.255 0-3 2.837-5.345 6.3-5.345 3.082 0 5.81 1.881 6.355 4.418-.191-.027-.41-.027-.6-.027-3 0-5.345 2.236-5.345 4.99 0 .464.081.9.19 1.31-.218 0-.409.027-.6.027m9.218 2.209.464 1.582-1.718-.955c-.627.164-1.255.327-1.882.327-3 0-5.345-2.045-5.345-4.554s2.345-4.555 5.345-4.555c2.837 0 5.346 2.046 5.346 4.555 0 1.39-.928 2.645-2.21 3.6"}))),a||(a=i.createElement("defs",null,i.createElement("clipPath",{id:"clip0_3515_32947"},i.createElement("path",{fill:"#fff",d:"M0 .117h30v30H0z"})))))}},76744:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(2403),a=n(5853),i=n(39207),o=n(7870),s=n(22322),c=n(89831);function l(e){var t;(0,i.QE)(e).then((t=(0,r._)(function(e){return(0,a.Jh)(this,function(t){switch(t.label){case 0:if(0!=e.data.errCode)return[3,2];return[4,(0,o.vQ)(new URL(e.data.data.url,location.origin).href)];case 1:return t.sent(),(0,s.y)("分享链接已成功复制到剪贴板",{variant:"success"}),[3,3];case 2:e.data.errCode==c.cO.TOPIC_PASSWORD_ERROR?(0,s.y)("专题密码已改变，暂时不可访问此专题，请进入专题验证访问密码",{variant:"error"}):(0,s.y)(e.data.errMsg,{variant:"error"}),t.label=3;case 3:return[2]}})}),function(e){return t.apply(this,arguments)}))}},40458:function(e,t,n){"use strict";n.d(t,{R:function(){return eE}});var r,a,i,o,s,c,l,u,h,d,p,f,g=n(2403),x=n(50059),m=n(45008),v=n(5853),j=n(57437),_=n(2265),b=n(78693),w=n(59832),y=n(46387),E=n(19643),Z=n(93383),C=n(16210),k=n(98698),S=n.n(k),D=n(33426),O=n.n(D),M=n(54632),P=n(7870),H=n(94746);function B(){return(B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var N=function(e){return H.createElement("svg",B({xmlns:"http://www.w3.org/2000/svg",width:16,height:11,fill:"none",viewBox:"0 0 16 11"},e),r||(r=H.createElement("path",{stroke:"#fff",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.667,d:"M14.667 1 5.5 10.167 1.334 6"})))};function L(){return(L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var F=function(e){return H.createElement("svg",L({xmlns:"http://www.w3.org/2000/svg",width:13,height:12,fill:"none",viewBox:"0 0 13 12"},e),a||(a=H.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m7.303 9.182-.707.707a2.5 2.5 0 0 1-3.535-3.535l.707-.707m6.364.707.707-.707A2.5 2.5 0 0 0 7.303 2.11l-.707.707M5.2 7.75l3.5-3.5"})))},R=n(4416),z=n(23760),W=n(39803),A=n(74634),I=n(39207),V=n(71931),T=n(22322),U=n(7633),J=n.n(U),q=n(25001),K=n(36760),Q=n.n(K),G=n(89831),X=n(6065);function Y(){return(Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var $=function(e){return H.createElement("svg",Y({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none",viewBox:"0 0 14 14"},e),i||(i=H.createElement("path",{fill:"#1570EF",d:"M13.513 5.3 12.6 5.17a.58.58 0 0 1-.447-.352 5.6 5.6 0 0 0-.684-1.19.57.57 0 0 1-.083-.563l.346-.854a.565.565 0 0 0-.242-.703L9.515.367a.566.566 0 0 0-.73.143l-.566.723a.58.58 0 0 1-.534.212 5.4 5.4 0 0 0-1.366 0 .58.58 0 0 1-.535-.212L5.219.51a.566.566 0 0 0-.731-.143l-1.974 1.14a.57.57 0 0 0-.243.704l.346.854c.077.19.04.4-.083.563a5.5 5.5 0 0 0-.684 1.19.57.57 0 0 1-.447.352l-.913.127c-.28.04-.49.28-.49.564v2.28c0 .283.21.522.488.562l.913.128a.58.58 0 0 1 .447.353q.271.641.685 1.189c.123.163.16.375.083.563l-.347.854a.565.565 0 0 0 .243.704l1.974 1.14a.566.566 0 0 0 .731-.143l.565-.723a.58.58 0 0 1 .535-.212 5.4 5.4 0 0 0 1.366 0 .58.58 0 0 1 .535.212l.565.723a.566.566 0 0 0 .73.142l1.975-1.14a.57.57 0 0 0 .242-.703l-.346-.854a.57.57 0 0 1 .083-.563q.414-.548.685-1.19a.57.57 0 0 1 .447-.352l.913-.128c.28-.04.488-.279.488-.561V5.86a.56.56 0 0 0-.487-.562M7.002 9.216a2.217 2.217 0 1 1 0-4.434 2.217 2.217 0 0 1 0 4.434"})))};function ee(){return(ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var et=function(e){return H.createElement("svg",ee({xmlns:"http://www.w3.org/2000/svg",width:8,height:14,fill:"none",viewBox:"0 0 8 14"},e),o||(o=H.createElement("path",{stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.333,d:"M7 13 1 7l6-6"})))};function en(){return(en=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var er=function(e){return H.createElement("svg",en({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),s||(s=H.createElement("path",{stroke:"#D92D20",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m10 6-4 4m0-4 4 4m4.666-2A6.667 6.667 0 1 1 1.333 8a6.667 6.667 0 0 1 13.333 0"})))};function ea(){return(ea=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var ei=function(e){return H.createElement("svg",ea({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),c||(c=H.createElement("g",{clipPath:"url(#clip0_2682_5476)"},H.createElement("path",{stroke:"#12B76A",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m5.625 9 2.25 2.25 4.5-4.5M16.5 9a7.5 7.5 0 1 1-15 0 7.5 7.5 0 0 1 15 0"}))),l||(l=H.createElement("defs",null,H.createElement("clipPath",{id:"clip0_2682_5476"},H.createElement("path",{fill:"#fff",d:"M0 0h18v18H0z"})))))},eo=n(15102);function es(){var e=(0,m._)(["\n    font-weight: 400;\n    font-size: 16px;\n    color: var(--black);\n"]);return es=function(){return e},e}function ec(){var e=(0,m._)(["\n    color: var(--meta-text-gray);\n    font-size: 12px;\n"]);return ec=function(){return e},e}var el=(0,_.memo)((0,_.forwardRef)(function(e,t){var n=e.topicShareDetail;e.isH5;var r=(0,x._)((0,_.useState)(n.url),2),a=r[0],i=r[1],o=(0,x._)((0,_.useState)(n.canEdit),2),s=o[0],c=o[1],l=(0,x._)((0,_.useState)(n.canDownload),2),u=l[0],h=l[1],d=(0,x._)((0,_.useState)(n.closeFilePermission),2),p=d[0],f=d[1],g=(0,x._)((0,_.useState)(n.needVerifyPassword),2),m=g[0],v=g[1],y=(0,x._)((0,_.useState)(n.password),2),C=y[0],k=y[1],D=(0,x._)((0,_.useState)(n.password),2),H=D[0],B=D[1],L=(0,x._)((0,_.useState)(!1),2),A=L[0],U=L[1],J=(0,x._)((0,_.useState)(n.noLoginCanVisit),2),q=J[0],K=J[1],Q=(0,x._)((0,_.useState)(""),2),X=Q[0],Y=Q[1];(0,_.useRef)(),(0,_.useEffect)(function(){if(!m){Y("");return}if(!H){Y("密码不能为空");return}if(H.length<4||H.length>16){Y("请设置4-16位密码");return}if(!/^[a-zA-Z0-9]+$/.test(H)){Y("密码仅支持数字或者英文字母");return}Y("")},[m,H]),(0,_.useEffect)(function(){n&&(i(n.url),c(n.canEdit),C!=n.password&&(k(n.password),B(n.password)))},[n]),(0,z.LM)(function(e){return e.login});var $=(0,_.useMemo)(function(){return null!=a&&location?"https://metaso.cn"+a:""},[a]),ee=(0,W.L)();ee.share,ee.updateWeChatShareInfo;var en=(0,V.y1)(function(e){ep()},200),ea=(0,_.useRef)(!1),es=(0,_.useRef)(!1),ec=(0,x._)((0,_.useState)(!1),2),el=ec[0],ed=ec[1],ep=(0,_.useCallback)(function(){if(!es.current&&!X){if(m&&!H){(0,T.y)("请设置访问密码",{variant:"error",autoHideDuration:1e3});return}es.current=!0,(0,I.Fb7)(n.id,{closeFilePermission:p,canDownload:u,needVerifyPassword:m,noLoginCanVisit:q,password:H}).then(function(t){t.data.errCode!==G.cO.SAFE?(0,T.y)(t.data.errMsg,{variant:"error",autoHideDuration:1500}):e.onSave()}).finally(function(){es.current=!1,ea.current=!1})}},[n,p,u,m,q,H,X]),ef=(0,_.useCallback)(function(){if($){if(m&&!H){(0,T.y)("请设置访问密码",{variant:"error",autoHideDuration:1e3});return}var e=m?$+"\n访问密码："+H:$;(0,P.vQ)(e).then(function(e){ed(!0),(0,T.y)("复制分享链接成功",{variant:"success",autoHideDuration:1e3})})}},[$,m,H]),eg=(0,_.useRef)(null);(0,_.useEffect)(function(){A&&setTimeout(function(){eg.current.focus()},200)},[A]);var ex=function(){if(!es.current&&!X){if(es.current=!0,U(!1),H==C){es.current=!1;return}(0,I.Fb7)(n.id,{password:H}).then(function(e){0!=e.data.errCode?(B(C),(0,T.y)(e.data.errMsg,{variant:"error",autoHideDuration:1500})):k(H)}).catch(function(e){B(C),(0,T.y)("修改密码失败",{variant:"error",autoHideDuration:1500})}).finally(function(){es.current=!1})}},em=function(){var e=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9"],t=Math.floor(Math.random()*e.length);return e[t]},ev=function(){for(var e="",t=0;t<6;t++)e+=em();return e};return(0,j.jsxs)(b.Z,{id:"tsct-box",display:"flex",flexDirection:"column",gap:"16px",sx:{minHeight:"367px",position:"relative"},children:[!e.isH5&&(0,j.jsxs)(b.Z,{className:S().title,sx:{marginBottom:"0!important"},children:[(0,j.jsx)(w.Z,{onClick:function(){e.onClose()},style:{padding:"8px 12px"},children:(0,j.jsx)(et,{})}),(0,j.jsx)("div",{className:S()["title-text"],children:"访问和权限控制"})]}),(0,j.jsx)(E.Z,{spacing:1.25,sx:{filter:"none",pointerEvents:"auto"},className:e.isH5?O()["h5-control-setting-container"]:"",children:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(b.Z,{component:"label",display:"flex",flexDirection:"row",gap:"8px",sx:{filter:s?"grayscale(100%) opacity(40%)":"none",pointerEvents:s?"none":"auto"},children:[(0,j.jsx)(R.Z,{sx:{top:2},checked:p,onChange:function(e,t){f(t)}}),(0,j.jsxs)(b.Z,{children:[(0,j.jsx)(eu,{children:"隐藏知识库列表"}),(0,j.jsx)(eh,{children:"获得链接的人将无法查看知识库详细文件目录"})]})]}),(0,j.jsxs)(b.Z,{component:"label",display:"flex",flexDirection:"row",gap:"8px",sx:{filter:s?"grayscale(100%) opacity(40%)":"none",pointerEvents:s?"none":"auto"},children:[(0,j.jsx)(R.Z,{sx:{top:2},checked:u,onChange:function(e,t){h(t)}}),(0,j.jsxs)(b.Z,{children:[(0,j.jsx)(eu,{children:"可下载"}),(0,j.jsx)(eh,{children:"获得链接的人可以下载知识库中的文件"})]})]}),(0,j.jsxs)(b.Z,{component:"label",display:"flex",flexDirection:"row",gap:"8px",children:[(0,j.jsx)(R.Z,{disabled:!1,sx:{top:2},checked:q,onChange:function(e,t){K(t)}}),(0,j.jsxs)(b.Z,{children:[(0,j.jsx)(eu,{children:"免登录访问"}),(0,j.jsx)(eh,{children:"访问者使用专题无需登录秘塔账户"})]})]}),(0,j.jsxs)(b.Z,{component:"label",display:"flex",flexDirection:"row",gap:"8px",children:[(0,j.jsx)(R.Z,{disabled:!1,sx:{top:2},checked:m,onChange:function(e,t){v(t),t&&B(ev())}}),(0,j.jsxs)(b.Z,{children:[(0,j.jsx)(eu,{children:"启用访问密码"}),(0,j.jsx)(eh,{children:"保护专题内容，访问需验证密码"})]})]}),m&&(0,j.jsx)(b.Z,{children:(0,j.jsxs)(b.Z,{display:"flex",style:{height:"40px",padding:"4px 8px 4px 0",border:"1px solid #EAECF0"},flexDirection:"row",justifyContent:"space-between",children:[(0,j.jsx)(Z.ZP,{ref:eg,value:H,readOnly:!A,className:O()["change-password-input"],sx:{ml:1,flex:1,color:"var(--black)",fontSize:"14px"},placeholder:"请输入4-16位字符, 仅支持数字或者英文字母",inputProps:{"aria-label":"访问密码"},onChange:function(e){B(e.target.value)},onKeyUp:function(e){"ENTER"===e.key.toUpperCase()&&ex()}}),A&&(0,j.jsxs)(b.Z,{style:{display:"flex",alignItems:"center",gap:"10px"},children:[!X&&(0,j.jsx)(ei,{}),(0,j.jsx)(b.Z,{className:O()["change-password-confirm-button"],onClick:function(e){ex()},children:"确认"})]}),!A&&(0,j.jsx)(b.Z,{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginLeft:"10px",children:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(b.Z,{className:O()["change-password-button"],onClick:function(e){U(!0)},children:"修改密码"}),(0,j.jsx)(M.Z,{variant:"contained",sx:(0,P.KI)({width:30,height:30,borderRadius:1,p:0,minWidth:0,boxSizing:"content-box"},2),disabled:!a,onClick:ef,children:el?(0,j.jsx)(N,{}):(0,j.jsx)(eo.MI,{sxs:{contentWrapper:{wordBreak:"break-all"}},placement:"top",effect:"dark",anchorChildren:(0,j.jsx)(F,{style:{width:20,height:20}}),children:"复制分享链接和密码"})})]})})]})}),X&&(0,j.jsxs)(b.Z,{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,j.jsx)(er,{}),(0,j.jsx)("span",{style:{fontSize:"12px",color:"#DA2C2F"},children:X})]}),m&&(0,j.jsx)(b.Z,{style:{fontSize:"12px",color:"#98A2B3"},children:"提示 : 密码仅作用于当前专题，关闭分享后密码将自动失效"}),(0,j.jsx)(b.Z,{className:O()["permission-setting-complete-button"]+" "+"".concat(m?"":O()["permission-setting-complete-button-no-password"]),children:(0,j.jsx)(b.Z,{onClick:en,children:"完成"})})]})})]})})),eu=(0,C.ZP)(y.Z)(es()),eh=(0,C.ZP)(y.Z)(ec());function ed(){return(ed=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var ep=function(e){return H.createElement("svg",ed({xmlns:"http://www.w3.org/2000/svg",width:19,height:17,fill:"none",viewBox:"0 0 19 17"},e),u||(u=H.createElement("path",{fill:"#fff",d:"M16.136.34a2.313 2.313 0 0 1 2.302 2.09l.011.221v11.877a2.313 2.313 0 0 1-2.09 2.301l-.223.01H2.785A2.31 2.31 0 0 1 .483 14.75l-.011-.222v-.593a.7.7 0 0 1-.02-.233l.02-.12V2.653A2.313 2.313 0 0 1 2.562.35l.223-.01zm0 1.407H2.785a.91.91 0 0 0-.897.757l-.013.147v7.5c.337-.674.669-1.247.996-1.71.563-.804 1.116-1.286 1.684-1.472a1.63 1.63 0 0 1 1.494.226c1.213.853 2.597 2.49 3.582 3.773l.495.657q.113.152.212.29c.186-.267.412-.578.664-.89 1.05-1.312 1.97-2.01 2.81-2.131a1.66 1.66 0 0 1 1.414.442 14 14 0 0 1 1.489 1.665l.326.43v-8.78a.91.91 0 0 0-.759-.892zM14.05 3.556a1.584 1.584 0 1 1 0 3.167 1.584 1.584 0 0 1 0-3.167"})))},ef=n(86501),eg=n(13615);function ex(){return(ex=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var em=function(e){return H.createElement("svg",ex({xmlns:"http://www.w3.org/2000/svg",width:30,height:31,fill:"none",viewBox:"0 0 30 31"},e),h||(h=H.createElement("rect",{width:30,height:30,y:.117,fill:"#1570EF",rx:15})),d||(d=H.createElement("path",{fill:"#fff",d:"m15.002 8.473.107.009a.665.665 0 0 1-.107 1.32h-4.985l-.076.009a.33.33 0 0 0-.256.323v7.128l2.439-2.235a1.33 1.33 0 0 1 1.763-.029l2.127 1.822 1.433-1.43a1.33 1.33 0 0 1 1.737-.125l1.134.85v-.996l.01-.108a.665.665 0 0 1 1.32.108v4.984l-.008.16a1.66 1.66 0 0 1-1.654 1.502v-.001l-9.969.001a1.66 1.66 0 0 1-1.662-1.662v-9.969l.008-.16a1.66 1.66 0 0 1 1.654-1.501zm-1.98 7.534-3.337 3.058v1.038l.009.077a.33.33 0 0 0 .323.256h9.97l.076-.01a.33.33 0 0 0 .247-.246l.009-.077v-2.326l-1.932-1.449-1.36 1.36 1.065.913a.665.665 0 0 1-.864 1.01z"})),p||(p=H.createElement("path",{fill:"#fff",d:"M19.321 8.473a.665.665 0 0 1 .665.664v2.382l.527-.525a.665.665 0 0 1 .847-.078l.092.078a.664.664 0 0 1 0 .94l-1.661 1.66a1 1 0 0 1-.087.074l.087-.073a.67.67 0 0 1-.47.195h-.03l-.046-.005.076.005a.67.67 0 0 1-.47-.195l-1.661-1.662a.665.665 0 1 1 .94-.94l.527.527V9.137a.665.665 0 0 1 .664-.664"})))};function ev(){return(ev=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}var ej=function(e){return H.createElement("svg",ev({xmlns:"http://www.w3.org/2000/svg",width:14,height:14,fill:"none",viewBox:"0 0 14 14"},e),f||(f=H.createElement("path",{stroke:"#98A2B3",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 1 1 13M1 1l12 12"})))},e_=(0,_.memo)((0,_.forwardRef)(function(e,t){var n,r,a,i=e.topicShareImageDetail;e.isH5;var o=(n=(0,g._)(function(){var e,t;return(0,v.Jh)(this,function(n){return t=(e=i.topicName).length<10?"".concat(e,".png"):"".concat(e.substring(0,10),".png"),(0,P.GN)(i.imageBase64,t),[2]})}),function(){return n.apply(this,arguments)}),s=(r=(0,g._)(function(){var e;return(0,v.Jh)(this,function(t){switch(t.label){case 0:return(e=document.createElement("img")).src=i.imageBase64,[4,new Promise(function(t,n){e.onload=t,e.onerror=n})];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,c(e)];case 3:return t.sent(),(0,T.y)("已成功复制专题卡片",{variant:"success",autoHideDuration:1500}),[3,5];case 4:return t.sent(),(0,T.y)("复制专题卡片失败",{variant:"error",autoHideDuration:1500}),[3,5];case 5:return[2]}})}),function(){return r.apply(this,arguments)}),c=(a=(0,g._)(function(e){var t,n,r;return(0,v.Jh)(this,function(a){switch(a.label){case 0:return n=(t=document.createElement("canvas")).getContext("2d"),t.width=e.width,t.height=e.height,n.drawImage(e,0,0),[4,new Promise(function(e){return t.toBlob(e)})];case 1:return r=a.sent(),[4,navigator.clipboard.write([new ClipboardItem({"image/png":r})])];case 2:return a.sent(),[2]}})}),function(e){return a.apply(this,arguments)});return(0,g._)(function(e){var t;return(0,v.Jh)(this,function(e){return(t=new FileReader).onload=function(e){var t=e.target.result;navigator.clipboard.writeText(t).then(function(){return(0,T.y)("已成功复制专题卡片",{variant:"success",autoHideDuration:1500})}).catch(function(e){return(0,T.y)("复制专题卡片失败:"+e,{variant:"error",autoHideDuration:1500})})},t.readAsDataURL(new Blob([new Uint8Array(1024)],{type:"image/png"})),[2]})}),(0,g._)(function(e){var t,n,r;return(0,v.Jh)(this,function(a){return(t=document.getElementById("editable")).appendChild(e),(n=document.createRange()).selectNode(e),(r=window.getSelection()).removeAllRanges(),r.addRange(n),document.execCommand("copy"),t.innerHTML="",r.removeAllRanges(),[2]})}),(0,j.jsxs)(b.Z,{id:"tsct-box",display:"flex",flexDirection:"column",gap:"8px",sx:{position:"relative"},children:[(0,j.jsxs)(b.Z,{className:S().title,sx:{marginBottom:"0!important"},children:[(0,j.jsx)("div",{className:S()["title-text"],children:"分享至"}),(0,j.jsx)(w.Z,{onClick:function(){e.onClose()},style:{padding:"8px 12px"},children:(0,j.jsx)(ej,{})})]}),(0,j.jsx)(b.Z,{id:"editable",contentEditable:"true",style:{display:"none"}}),(0,j.jsxs)(E.Z,{spacing:1.25,sx:{filter:"none",pointerEvents:"auto"},className:e.isH5?O()["h5-topic-share-image-container"]:"",children:[(0,j.jsx)(b.Z,{className:O()["share-image-desc"],children:"有封面的专题生成的分享图更美观哦"}),(0,j.jsx)(b.Z,{className:O()["flex-center"],style:{marginTop:"0"},children:(0,j.jsx)("img",{className:"".concat(e.isH5?O()["h5-share-image"]:""),src:"".concat(i.imageBase64),style:{width:"".concat(i.imageWidth,"px"),height:"".concat(i.imageHeight,"px"),top:"calc(50% - ".concat((i.imageHeight+200)/2,"px)")}})}),(0,j.jsxs)(b.Z,{className:O()["topic-share-image-operate-buttons"]+" ".concat(e.isH5?O()["topic-share-image-operate-buttons-h5"]:""),style:{marginTop:"0"},children:[(0,j.jsxs)(b.Z,{onClick:function(){return s()},children:[(0,j.jsx)(ef.Z,{}),(0,j.jsx)(b.Z,{children:"微信"})]}),(0,j.jsxs)(b.Z,{onClick:function(){return s()},children:[(0,j.jsx)(eg.Z,{}),(0,j.jsx)(b.Z,{children:"朋友圈"})]}),(0,j.jsxs)(b.Z,{onClick:function(){return o()},children:[(0,j.jsx)(em,{}),(0,j.jsx)(b.Z,{children:"下载图片"})]})]})]})]})})),eb=n(26058);function ew(){var e=(0,m._)(["\n    font-weight: 400;\n    font-size: 16px;\n    color: var(--black);\n"]);return ew=function(){return e},e}function ey(){var e=(0,m._)(["\n    color: var(--meta-text-gray);\n    font-size: 12px;\n"]);return ey=function(){return e},e}var eE=(0,_.memo)((0,_.forwardRef)(function(e,t){var n=(0,x._)((0,_.useState)(!1),2),r=n[0],a=n[1],i=(0,x._)((0,_.useState)(!0),2),o=i[0],s=i[1],c=(0,x._)((0,_.useState)(!0),2),l=c[0],u=c[1],h=(0,x._)((0,_.useState)(!0),2),d=h[0],p=h[1],f=(0,x._)((0,_.useState)(null),2),m=f[0],C=f[1],k=(0,x._)((0,_.useState)(!1),2),D=k[0],H=k[1],B=(0,x._)((0,_.useState)(!1),2),L=(B[0],B[1]),U=(0,x._)((0,_.useState)(!1),2),K=U[0],Y=U[1],ee=(0,x._)((0,_.useState)(null),2),et=ee[0],en=ee[1];(0,z.LM)(function(e){return e.login});var er=(0,_.useMemo)(function(){return null!=m&&location?"https://metaso.cn"+m:""},[m]),ea=(0,W.L)(),ei=(ea.share,ea.updateWeChatShareInfo);(0,_.useEffect)(function(){if(m&&A.mk){var t={imgUrl:"",link:m,title:"专题 | ".concat(e.name),desc:e.desc};ei(function(){return t})}},[m,e.desc,e.name]);var es=(0,_.useRef)("");(0,_.useRef)(e.id);var ec=(0,q.W)({autoRequest:!1,request:(0,g._)(function(){var t;return(0,v.Jh)(this,function(n){switch(n.label){case 0:if(!e.id)return[2,null];return[4,(0,I.QE)(e.id,I.Z3G)];case 1:return C((t=n.sent().data.data).url),p(t.active),a(t.canEdit),s(t.canDownload),Y(t.hasCoverUrl),en(t),[2,t]}})}),defaultData:null});(0,_.useEffect)(function(){ec.doRequest()},[e.id]),(0,_.useEffect)(function(){ec.data&&(C(ec.data.url),p(ec.data.active),a(ec.data.canEdit),u(ec.data.hideLeftMenu),en(ec.data))},[ec.data]);var eu=(0,V.y1)(function(){ed()},200),eh=(0,_.useRef)(!1),ed=(0,_.useCallback)(function(){L(!0);var t=eh.current&&d;t&&H(!1);var n=J()("getShareInfo");es.current=n,(0,I.Fb7)(e.id,{canEdit:r,canDownload:o,active:d,reGenerate:t,hideLeftMenu:l}).then(function(e){if(es.current===n){var t=e.data.data;return e.data.errCode===G.cO.SENSITIVE_WORD&&(0,T.y)(e.data.errMsg,{variant:"warning",autoHideDuration:1500}),en(t),C(t.url),t}}).finally(function(){var t;L(!1),eh.current=!1,null===(t=e.onModalToggle)||void 0===t||t.call(e,!1),d||e.onClose()})},[d,r,o,l,e.id]),ef=(0,_.useCallback)(function(e){a(e);var t=JSON.parse(JSON.stringify(et));t.canEdit=e,e&&(s(e),t.canDownload=e,t.closeFilePermission=!1),en(t),eu()},[r,o,et]),eg=(0,_.useCallback)(function(e){u(e),eu()},[]),ex=(0,_.useCallback)(function(e){p(e),eu()},[]);(0,_.useCallback)(function(e){s(e),eu()},[]);var em=(0,_.useCallback)(function(){er&&(0,P.vQ)(er).then(function(e){H(!0),(0,T.y)("复制分享链接成功",{variant:"success",autoHideDuration:1e3})})},[er]),ev=(0,x._)((0,_.useState)(null),2),ej=ev[0],ew=ev[1],ey=(0,x._)((0,_.useState)(!1),2),eE=ey[0],ek=ey[1],eS=(0,x._)((0,_.useState)(!1),2),eD=eS[0],eO=eS[1];(0,_.useEffect)(function(){e.isH5&&e.onSettingOpenChanged&&(eD||eE?e.onSettingOpenChanged(!0):e.onSettingOpenChanged(!1))},[e.isH5,e.onSettingOpenChanged,eD,eE]);var eM=(0,x._)((0,_.useState)(!1),2),eP=eM[0],eH=eM[1],eB=function(){if(!eP){eH(!0);var t="".concat("https://metaso.cn");(location.href.indexOf("172.168")>-1||location.href.indexOf("localhost")>-1)&&(t="http://".concat(location.hostname,":3001"));var n={url:t+="/topic-share-img?topicId=".concat(e.id),domain:"metaso.cn",uid:(0,I.ejW)("uid"),sid:(0,I.ejW)("sid"),aliyungf_tc:(0,I.ejW)("aliyungf_tc"),defaultViewport:{width:1328},event_name:"topic-image-share",client:(0,eb.Fk)()};(0,I.PSx)(n).then(function(t){var n=332,r=e.hasCoverUrl||K?452:342;e.isH5?(n*=.8,r*=.8):(n*=.7,r*=.7),ew({id:e.id,topicName:e.name,imageBase64:t.data.image,imageWidth:n,imageHeight:r}),ek(!0)}).catch(function(e){(0,T.y)("生成图片失败",{variant:"error",autoHideDuration:2e3})}).finally(function(){eH(!1)})}};return(0,j.jsxs)(b.Z,{id:"ssc-box",display:"flex",flexDirection:"column",gap:"16px",sx:{},children:[!eD&&!eE&&(0,j.jsxs)(j.Fragment,{children:[!e.noHeader&&(0,j.jsxs)(b.Z,{className:S().title,sx:{marginBottom:"0!important"},children:[(0,j.jsx)("div",{className:S()["title-text"],children:"分享"}),(0,j.jsx)(w.Z,{onClick:function(){e.onClose()},children:(0,j.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,j.jsx)("path",{d:"M13 1L1 13M1 1L13 13",stroke:"#98A2B3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,j.jsx)(y.Z,{sx:{fontSize:14,color:"var(--black4)"},children:d?r?"通过此链接访问的用户可编辑专题、使用专题知识库进行AI搜索或者下载知识库文件。":"通过此链接访问的用户可查看专题、使用专题知识库进行AI搜索。":"分享链接已关闭，专题不向任何人开放。 "}),!e.isShareUser&&(0,j.jsxs)(b.Z,{component:"label",display:"flex",flexDirection:"row",gap:"8px",className:Q()({"disable-area":ec.isPending}),children:[(0,j.jsx)(R.Z,{sx:{top:2},checked:d,onChange:function(t,n){if(t.stopPropagation(),n)!d&&n&&(eh.current=!0),ex(n);else{var r;null===(r=e.onModalToggle)||void 0===r||r.call(e,!0),(0,X.W)("提示",(0,j.jsxs)("span",{children:[(0,j.jsx)("span",{children:"您确定要关闭分享吗？"}),(0,j.jsx)("span",{style:{color:"red"},children:"关闭分享将使当前分享链接失效。"})]}),{sx:{mx:1}}).then(function(){ex(n)}).catch(function(t){var n;null===(n=e.onModalToggle)||void 0===n||n.call(e,!1)})}},onMouseDown:function(e){e.stopPropagation()},onKeyDown:function(e){e.stopPropagation()}}),(0,j.jsxs)(eZ,{children:["链接",d?"（已开启）":"（已关闭）"]})]}),(0,j.jsxs)(E.Z,{spacing:1.25,className:Q()({"disable-area":ec.isPending}),sx:{filter:d?"none":"grayscale(100%) opacity(40%)",pointerEvents:d?"auto":"none"},children:[(0,j.jsx)(b.Z,{children:(0,j.jsxs)(b.Z,{display:"flex",style:{height:"40px",padding:"8px 8px 8px 0",border:"1px solid #EAECF0"},flexDirection:"row",justifyContent:"space-between",children:[(0,j.jsx)(Z.ZP,{value:er,readOnly:!0,sx:{ml:1,flex:1,color:"var(--black)"},placeholder:"https://metaso.cn/s/...",inputProps:{"aria-label":"分享链接"},onChange:function(e){return C(e.target.value)}}),(0,j.jsx)(b.Z,{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px",marginLeft:"10px",children:(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(M.Z,{variant:"contained",sx:(0,P.KI)({width:30,height:30,borderRadius:1,p:0,minWidth:0,boxSizing:"content-box"},2),disabled:!m,onClick:em,children:D?(0,j.jsx)(N,{}):(0,j.jsx)(eo.MI,{sxs:{contentWrapper:{wordBreak:"break-all"}},placement:"top",effect:"dark",anchorChildren:(0,j.jsx)(F,{style:{width:20,height:20}}),children:"复制分享链接"})})})})]})}),!e.isShareUser&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(b.Z,{component:"label",display:"flex",flexDirection:"row",gap:"8px",children:[(0,j.jsx)(R.Z,{disabled:!m,sx:{top:2},checked:l,onChange:function(e,t){eg(t)}}),(0,j.jsxs)(b.Z,{children:[(0,j.jsx)(eZ,{children:"隐藏左侧栏"}),(0,j.jsx)(eC,{children:"获得链接的人看到的页面无左侧栏"})]})]}),(0,j.jsxs)(b.Z,{component:"label",display:"flex",flexDirection:"row",gap:"8px",children:[(0,j.jsx)(R.Z,{disabled:!m,sx:{top:2},checked:r,onChange:function(e,t){e.stopPropagation(),ef(t)},onMouseDown:function(e){e.stopPropagation()}}),(0,j.jsxs)(b.Z,{children:[(0,j.jsx)(eZ,{children:"可编辑"}),(0,j.jsx)(eC,{children:"获得链接的人可以编辑"})]})]}),(0,j.jsxs)(b.Z,{className:O()["generate-share-image-container"]+" ".concat(eP?"load":""),onClick:function(){return eB()},children:[(0,j.jsx)(b.Z,{className:O()["generate-share-image-icon-box"],children:(0,j.jsx)(ep,{})}),(0,j.jsx)(b.Z,{children:"生成分享图"})]}),(0,j.jsxs)(b.Z,{id:"tsps-button",className:O()["permission-setting-button"],onClick:function(){eO(!0)},children:[(0,j.jsx)($,{}),(0,j.jsx)("span",{children:"访问和权限控制"})]})]})]})]}),eD&&!eE&&et&&(0,j.jsx)(el,{topicShareDetail:et,isH5:!1,onClose:function(){eO(!1)},onSave:function(){eO(!1),e.onClose()}}),eE&&ej&&(0,j.jsx)(e_,{topicShareImageDetail:ej,isH5:e.isH5,onClose:function(){ek(!1),e.onClose()}})]})})),eZ=(0,C.ZP)(y.Z)(ew()),eC=(0,C.ZP)(y.Z)(ey())},296:function(e,t,n){"use strict";var r=n(5194),a=n(46796),i=n(50059),o=n(57437),s=n(40100),c=n(2265),l=n(40458),u=n(7870),h=n(39207),d=(0,c.forwardRef)(function(e,t){var n=e.sx,d=e.onClose,p=(0,a._)(e,["sx","onClose"]),f=(0,i._)((0,c.useState)(!1),2),g=f[0],x=f[1];return(0,c.useEffect)(function(){g&&(0,h.sEl)(e.id)},[g]),(0,c.useImperativeHandle)(t,function(){return{setVisible:function(e){e?x(!0):x(!1)}}},[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(s.k,{sx:(0,u.Vc)(n,{width:"min(90vw, 360px)"}),open:g,onClose:d,disableScroll:!0,children:(0,o.jsx)(l.R,(0,r._)({onClose:function(){x(!1),e.onClose()}},p))})})});t.Z=d},33426:function(e){e.exports={"permission-setting-button":"subject-share-control_permission-setting-button__6BbJk","permission-setting-complete-button":"subject-share-control_permission-setting-complete-button__DDMbz","permission-setting-complete-button-no-password":"subject-share-control_permission-setting-complete-button-no-password__OpDnS","change-password-button":"subject-share-control_change-password-button__lnzi_","change-password-confirm-button":"subject-share-control_change-password-confirm-button__WsHff","h5-control-setting-container":"subject-share-control_h5-control-setting-container__xoaF8","change-password-input":"subject-share-control_change-password-input__VPsXc","generate-share-image-container":"subject-share-control_generate-share-image-container__3MTUw","generate-share-image-icon-box":"subject-share-control_generate-share-image-icon-box__VF45T","topic-share-image-content":"subject-share-control_topic-share-image-content__gNfsw","image-content-big":"subject-share-control_image-content-big__3zF9D","image-content-h5-big":"subject-share-control_image-content-h5-big__eXwWP","image-content-show":"subject-share-control_image-content-show__DJ_n3","image-content-hide":"subject-share-control_image-content-hide__pcF1U","topic-share-image-content-box":"subject-share-control_topic-share-image-content-box___aIPx","no-box-shadow":"subject-share-control_no-box-shadow__LwW9z","topic-share-image-content-box-has-cover-header":"subject-share-control_topic-share-image-content-box-has-cover-header__ANI3k","topic-share-image-content-box-no-cover-header":"subject-share-control_topic-share-image-content-box-no-cover-header__ezhfi","topic-name":"subject-share-control_topic-name__ipJ82","by-user":"subject-share-control_by-user__E9oZY","topic-share-image-topic-data":"subject-share-control_topic-share-image-topic-data__RS_Dd",count:"subject-share-control_count__HUBES",label:"subject-share-control_label__MhxLT","topic-share-image-line":"subject-share-control_topic-share-image-line__cJfDK","topic-share-image-classify-topic-container":"subject-share-control_topic-share-image-classify-topic-container___2V0K",point:"subject-share-control_point__WVHfB","classify-topic":"subject-share-control_classify-topic__MbPcv","topic-has-cover-url":"subject-share-control_topic-has-cover-url__sgjjg","classify-topic-item":"subject-share-control_classify-topic-item__9wAeF","topic-share-image-qrcode-container":"subject-share-control_topic-share-image-qrcode-container__TmfXV","qrcode-tips":"subject-share-control_qrcode-tips__FSP1o","topic-share-image-operate-buttons":"subject-share-control_topic-share-image-operate-buttons__ZMVlw","topic-share-image-operate-buttons-h5":"subject-share-control_topic-share-image-operate-buttons-h5__ysamR","flex-center":"subject-share-control_flex-center__ysQuD","share-image-desc":"subject-share-control_share-image-desc__PUGrE","topic-share-image-topic-desc":"subject-share-control_topic-share-image-topic-desc__xW86u","topic-share-image-topic-empty":"subject-share-control_topic-share-image-topic-empty__PWqNN","topic-share-image-content-box-cover-url-container":"subject-share-control_topic-share-image-content-box-cover-url-container__FSZes","topic-share-image-content-box-cover-url-image":"subject-share-control_topic-share-image-content-box-cover-url-image__TlV_g","image-content-scale":"subject-share-control_image-content-scale__hXuPB","topic-share-image-logo-container":"subject-share-control_topic-share-image-logo-container__qlIhU","h5-share-image":"subject-share-control_h5-share-image__AVTvC"}}}]);