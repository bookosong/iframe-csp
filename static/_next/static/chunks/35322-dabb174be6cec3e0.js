(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[35322],{45942:function(e,n,t){"use strict";var i,r=t(94746);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}n.Z=function(e){return r.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:14,height:8,fill:"none",viewBox:"0 0 14 8"},e),i||(i=r.createElement("path",{stroke:"#98A2B3",strokeLinecap:"round",strokeLinejoin:"round",d:"M13 1 7 7 1 1"})))}},26018:function(e,n,t){"use strict";var i,r=t(94746);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}n.Z=function(e){return r.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:7,height:12,fill:"none",viewBox:"0 0 7 12"},e),i||(i=r.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.667,d:"m1 11 5-5-5-5"})))}},96472:function(e,n,t){"use strict";var i,r=t(94746);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}n.Z=function(e){return r.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:14,height:8,fill:"none",viewBox:"0 0 14 8"},e),i||(i=r.createElement("path",{stroke:"#98A2B3",strokeLinecap:"round",strokeLinejoin:"round",d:"m1 7 6-6 6 6"})))}},45225:function(e,n,t){"use strict";var i,r,o,a,l,s,c,u=t(94746);function d(){return(d=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}n.Z=function(e){return u.createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),i||(i=u.createElement("mask",{id:"path-1-outside-1_1852_46182",width:18,height:18,x:0,y:0,fill:"#000",maskUnits:"userSpaceOnUse"},u.createElement("path",{fill:"#fff",d:"M0 0h18v18H0z"}),u.createElement("path",{d:"M1.565 9.758h1.519a.561.561 0 1 0 0-1.122H1.565a.561.561 0 0 0 0 1.122m2.176 2.107a.547.547 0 0 0-.589-.561H1.565a.575.575 0 0 0-.56.56.56.56 0 0 0 .56.562h1.546a.562.562 0 0 0 .63-.561M1.565 7.117h1.519a.561.561 0 0 0 0-1.122H1.565a.56.56 0 0 0-.56.479.575.575 0 0 0 .56.643"}),u.createElement("path",{d:"M14.523 1H4.233A2.463 2.463 0 0 0 1.77 3.477v1.218a.575.575 0 0 0 .602.574.575.575 0 0 0 .561-.574V3.477a1.37 1.37 0 0 1 1.369-1.369h10.221a1.37 1.37 0 0 1 1.369 1.369v11.44a1.37 1.37 0 0 1-1.369 1.368H4.233a1.37 1.37 0 0 1-1.368-1.369v-1.012a.575.575 0 0 0-1.136 0v1.012a2.504 2.504 0 0 0 2.504 2.504h10.29A2.477 2.477 0 0 0 17 14.944V3.477A2.477 2.477 0 0 0 14.523 1"}),u.createElement("path",{d:"M11.95 7.513a2.46 2.46 0 0 0-.683-1.847 2.82 2.82 0 0 0-2.053-.876 2.74 2.74 0 0 0-1.915.807 2.74 2.74 0 0 0-.821 1.916.48.48 0 0 0 .478.479.465.465 0 0 0 .48-.479 1.765 1.765 0 0 1 1.778-1.751 1.86 1.86 0 0 1 1.369.56 1.5 1.5 0 0 1 .424 1.136c0 .356 0 .698-1.068 1.724-.63.5-1.07 1.2-1.245 1.985a.48.48 0 0 0 .424.533.49.49 0 0 0 .48-.438c0-.396.396-.82.97-1.368 1.205-1.218 1.383-1.779 1.383-2.38M8.832 12.55a.56.56 0 0 0-.287.492.575.575 0 1 0 1.073-.285.56.56 0 0 0-.211-.207.55.55 0 0 0-.575 0"}))),r||(r=u.createElement("path",{fill:"currentColor",d:"M1.565 9.758h1.519a.561.561 0 1 0 0-1.122H1.565a.561.561 0 0 0 0 1.122m2.176 2.107a.547.547 0 0 0-.589-.561H1.565a.575.575 0 0 0-.56.56.56.56 0 0 0 .56.562h1.546a.562.562 0 0 0 .63-.561M1.565 7.117h1.519a.561.561 0 0 0 0-1.122H1.565a.56.56 0 0 0-.56.479.575.575 0 0 0 .56.643"})),o||(o=u.createElement("path",{fill:"currentColor",d:"M14.523 1H4.233A2.463 2.463 0 0 0 1.77 3.477v1.218a.575.575 0 0 0 .602.574.575.575 0 0 0 .561-.574V3.477a1.37 1.37 0 0 1 1.369-1.369h10.221a1.37 1.37 0 0 1 1.369 1.369v11.44a1.37 1.37 0 0 1-1.369 1.368H4.233a1.37 1.37 0 0 1-1.368-1.369v-1.012a.575.575 0 0 0-1.136 0v1.012a2.504 2.504 0 0 0 2.504 2.504h10.29A2.477 2.477 0 0 0 17 14.944V3.477A2.477 2.477 0 0 0 14.523 1"})),a||(a=u.createElement("path",{fill:"currentColor",d:"M11.95 7.513a2.46 2.46 0 0 0-.683-1.847 2.82 2.82 0 0 0-2.053-.876 2.74 2.74 0 0 0-1.915.807 2.74 2.74 0 0 0-.821 1.916.48.48 0 0 0 .478.479.465.465 0 0 0 .48-.479 1.765 1.765 0 0 1 1.778-1.751 1.86 1.86 0 0 1 1.369.56 1.5 1.5 0 0 1 .424 1.136c0 .356 0 .698-1.068 1.724-.63.5-1.07 1.2-1.245 1.985a.48.48 0 0 0 .424.533.49.49 0 0 0 .48-.438c0-.396.396-.82.97-1.368 1.205-1.218 1.383-1.779 1.383-2.38M8.832 12.55a.56.56 0 0 0-.287.492.575.575 0 1 0 1.073-.285.56.56 0 0 0-.211-.207.55.55 0 0 0-.575 0"})),l||(l=u.createElement("path",{stroke:"currentColor",strokeWidth:.58,d:"M1.565 9.758h1.519a.561.561 0 1 0 0-1.122H1.565a.561.561 0 0 0 0 1.122Zm2.176 2.107a.547.547 0 0 0-.589-.561H1.565a.575.575 0 0 0-.56.56.56.56 0 0 0 .56.562h1.546a.562.562 0 0 0 .63-.561ZM1.565 7.117h1.519a.561.561 0 0 0 0-1.122H1.565a.56.56 0 0 0-.56.479.575.575 0 0 0 .56.643Z",mask:"url(#path-1-outside-1_1852_46182)"})),s||(s=u.createElement("path",{stroke:"currentColor",strokeWidth:.58,d:"M14.523 1H4.233A2.463 2.463 0 0 0 1.77 3.477v1.218a.575.575 0 0 0 .602.574.575.575 0 0 0 .561-.574V3.477a1.37 1.37 0 0 1 1.369-1.369h10.221a1.37 1.37 0 0 1 1.369 1.369v11.44a1.37 1.37 0 0 1-1.369 1.368H4.233a1.37 1.37 0 0 1-1.368-1.369v-1.012a.575.575 0 0 0-1.136 0v1.012a2.504 2.504 0 0 0 2.504 2.504h10.29A2.477 2.477 0 0 0 17 14.944V3.477A2.477 2.477 0 0 0 14.523 1Z",mask:"url(#path-1-outside-1_1852_46182)"})),c||(c=u.createElement("path",{stroke:"currentColor",strokeWidth:.58,d:"M11.95 7.513a2.46 2.46 0 0 0-.683-1.847 2.82 2.82 0 0 0-2.053-.876 2.74 2.74 0 0 0-1.915.807 2.74 2.74 0 0 0-.821 1.916.48.48 0 0 0 .478.479.465.465 0 0 0 .48-.479 1.765 1.765 0 0 1 1.778-1.751 1.86 1.86 0 0 1 1.369.56 1.5 1.5 0 0 1 .424 1.136c0 .356 0 .698-1.068 1.724-.63.5-1.07 1.2-1.245 1.985a.48.48 0 0 0 .424.533.49.49 0 0 0 .48-.438c0-.396.396-.82.97-1.368 1.205-1.218 1.383-1.779 1.383-2.38ZM8.832 12.55a.56.56 0 0 0-.287.492.575.575 0 1 0 1.073-.285.56.56 0 0 0-.211-.207.55.55 0 0 0-.575 0Z",mask:"url(#path-1-outside-1_1852_46182)"})))}},60079:function(e,n,t){"use strict";var i,r,o=t(94746);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}n.Z=function(e){return o.createElement("svg",a({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),i||(i=o.createElement("path",{fill:"#667085",d:"M7.374 5.948a.465.465 0 0 0-.465.465v2.063a.46.46 0 0 0 .14.318l.928 1.056a.464.464 0 0 0 .656.042.464.464 0 0 0 .042-.656l-.837-.953v-1.87a.464.464 0 0 0-.464-.465m6.328-1.357a7.4 7.4 0 0 0-2.706-2.534.465.465 0 1 0-.444.817 6.44 6.44 0 0 1 2.364 2.215.463.463 0 0 0 .642.145.467.467 0 0 0 .144-.643"})),r||(r=o.createElement("path",{fill:"#667085",d:"M7.84 2.999v-.493a.465.465 0 0 0-.931 0v.515a5.512 5.512 0 0 0-4.673 7.066.465.465 0 0 0 .89-.269 4.58 4.58 0 0 1 3.056-5.702 4.58 4.58 0 0 1 5.703 3.056 4.578 4.578 0 0 1-5.67 5.712 4.57 4.57 0 0 1-2.192-1.422.466.466 0 0 0-.71.604 5.52 5.52 0 0 0 5.785 1.699 5.51 5.51 0 0 0 3.677-6.863A5.51 5.51 0 0 0 7.84 3"})))}},72422:function(e,n,t){"use strict";var i,r=t(94746);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}n.Z=function(e){return r.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:17,height:17,fill:"none",viewBox:"0 0 17 17"},e),i||(i=r.createElement("path",{fill:"currentColor",d:"M2.53 12.526v.895c0 .451.16.886.45 1.217.288.331.685.534 1.109.568l.127.004h1.687a.82.82 0 0 1 .596.262.92.92 0 0 1 .247.633.92.92 0 0 1-.247.633.82.82 0 0 1-.596.262H4.216a3.28 3.28 0 0 1-2.385-1.048 3.7 3.7 0 0 1-.988-2.531v-.895c0-.237.09-.465.247-.633a.82.82 0 0 1 .597-.262.82.82 0 0 1 .596.262.92.92 0 0 1 .247.633m11.067-5.087 3.373 8.947a.47.47 0 0 1-.043.417.4.4 0 0 1-.151.144.4.4 0 0 1-.198.052h-.91a.4.4 0 0 1-.236-.077.44.44 0 0 1-.155-.204l-.905-2.402H10.92l-.905 2.402a.44.44 0 0 1-.155.204.4.4 0 0 1-.236.076h-.907a.4.4 0 0 1-.198-.052.4.4 0 0 1-.15-.144.46.46 0 0 1-.043-.416l3.373-8.948a.44.44 0 0 1 .155-.204.4.4 0 0 1 .236-.077h1.115c.171 0 .327.112.392.282m-.95 2.3-1.05 2.787h2.1zM5.059.448v1.34h2.953c.233 0 .42.201.42.447v5.37c0 .247-.189.446-.42.446H5.058v2.238c0 .247-.188.446-.42.446h-.844a.4.4 0 0 1-.298-.13.46.46 0 0 1-.123-.316V8.052H.423a.4.4 0 0 1-.3-.13A.45.45 0 0 1 0 7.605V2.236c0-.247.19-.446.422-.446h2.95V.448c0-.247.188-.448.42-.448h.844c.233 0 .421.2.421.448zm7.59.446c.895 0 1.752.377 2.385 1.048s.988 1.582.988 2.531v.895a.92.92 0 0 1-.247.633.82.82 0 0 1-.596.262.82.82 0 0 1-.597-.262.92.92 0 0 1-.246-.633v-.895c0-.99-.756-1.79-1.687-1.79H10.96a.82.82 0 0 1-.596-.262.92.92 0 0 1-.247-.632c0-.238.089-.465.247-.633a.82.82 0 0 1 .596-.262zM3.372 3.579H1.685v2.685h1.687zm3.373 0H5.058v2.685h1.687z"})))}},25232:function(e,n,t){"use strict";t.d(n,{h:function(){return r},p:function(){return o}});var i=t(2265),r=(0,i.createContext)({isFullScreen:!1,handleFullScreenToggle:function(){}}),o=function(){return(0,i.useContext)(r)}},36852:function(e,n,t){"use strict";t.d(n,{P:function(){return l}});var i=t(50059),r=t(57437),o=t(2265),a=t(39207);function l(e){var n=e.src,t=(e.alt,e.fallbackSrc),l=e.width,s=e.height,c=e.style,u=(0,i._)((0,o.useState)(""),2),d=u[0],f=u[1],h=(0,i._)((0,o.useState)(!1),2),p=h[0],v=h[1];return(0,o.useEffect)(function(){v(!1),(0,a.lRq)(n).then(function(e){200===e.status&&f("data:image/png;base64,"+btoa(function(e){for(var n="",t=0;t<e.length;t+=65536){var i=e.subarray(t,t+65536);n+=String.fromCharCode.apply(null,i)}return n}(new Uint8Array(e.data))))}).finally(function(){v(!0)})},[n]),(0,r.jsx)(r.Fragment,{children:d||!p?(0,r.jsx)("img",{src:d,width:l,height:s,style:c}):(0,r.jsx)("img",{src:t,width:l,height:s,style:c})})}},35046:function(e,n,t){"use strict";t.r(n),t.d(n,{BoxType:function(){return x},CardTab:function(){return eW},FileMetaTypeButtonText:function(){return e$},PodCastArticleButton:function(){return eV},SearchOriginBox:function(){return eP},SearchOriginListBox:function(){return eB},SummaryDialog:function(){return eY},anchorInfoToBoxItems:function(){return eD},convertDateStr:function(){return eF},getLanguage:function(){return eG},getLinkIcon:function(){return eO},getMarkdownContentOffsetTop:function(){return eA}});var i,r,o,a,l,s,c,u,d,f,h,p,v,x,g,m=t(12249),k=t(5194),C=t(1780),w=t(46796),b=t(50059),y=t(43923),j=t(85735),_=t(57437),S=t(47812),E=t(10301),T=t(2265),L=t(55833),I=t(79943),H=t(39207),M=t(13988),Z=t(22322),R=t(7870),N=t(71931),O=t(78693),A=t(47080),D=t(35389),B=t(73904),P=t(8350),F=t(19643),z=t(28450),W=t(59832),U=t(45225),V=t(36017),q=t(94746);function G(){return(G=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var X=function(e){return q.createElement("svg",G({xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",viewBox:"0 0 12 12"},e),o||(o=q.createElement("path",{fill:"#98A2B3",d:"M3.88 9.32h.28c.14 0 .253-.113.253-.253V5.08a.253.253 0 0 0-.253-.253h-.28a.253.253 0 0 0-.253.253v3.987c0 .14.113.253.253.253m1.96 0h.28c.14 0 .253-.113.253-.253V5.08a.253.253 0 0 0-.253-.253h-.28a.253.253 0 0 0-.253.253v3.987c0 .14.113.253.253.253m1.96 0h.28c.14 0 .253-.113.253-.253V5.08a.253.253 0 0 0-.253-.253H7.8a.253.253 0 0 0-.253.253v3.987c0 .14.113.253.253.253"})),a||(a=q.createElement("path",{fill:"#98A2B3",d:"M11.307 1.693H9.039L8.7.426a.26.26 0 0 0-.132-.163.3.3 0 0 0-.1-.023H3.534q-.054.002-.1.023a.26.26 0 0 0-.131.162L3.28.508l-.32 1.185H.68a.253.253 0 0 0-.253.253v.6c0 .14.113.254.253.254h1.18l.123 8.73q.001.072.037.13a.25.25 0 0 0 .22.127h7.627c.14 0 .253-.114.253-.253v-.414l-.001-.027.116-8.293h1.072c.14 0 .253-.113.253-.253v-.6a.253.253 0 0 0-.253-.254m-7.35-.666h4.087l.178.666H3.778zm5.374 9.84H2.764L2.651 2.8h6.793z"})))};function K(){return(K=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var Y=function(e){return q.createElement("svg",K({xmlns:"http://www.w3.org/2000/svg",width:18,height:19,fill:"none",viewBox:"0 0 18 19"},e),l||(l=q.createElement("g",{fill:"#000",clipPath:"url(#clip0_2553_22044)"},q.createElement("path",{d:"M13.847 19H3.153a2.714 2.714 0 0 1-2.715-2.714V4.008a2.714 2.714 0 0 1 2.715-2.714h10.694a2.714 2.714 0 0 1 2.714 2.714v12.278A2.714 2.714 0 0 1 13.847 19M3.153 3.103a.905.905 0 0 0-.905.905v12.278a.905.905 0 0 0 .905.905h10.694a.905.905 0 0 0 .905-.905V4.008a.905.905 0 0 0-.905-.905z"}),q.createElement("path",{d:"M4.809 0q.796 0 .796.796v2.796q0 .796-.796.796t-.796-.796V.796q0-.796.796-.796M8.5 0q.796 0 .796.796v2.796q0 .796-.796.796t-.796-.796V.796Q7.704 0 8.5 0M12.192 0q.795 0 .796.796v2.796q0 .796-.796.796t-.796-.796V.796q0-.796.796-.796M5.325 7.528h6.36q.795 0 .796.796 0 .796-.796.796h-6.36q-.797 0-.797-.796t.797-.796M5.325 11.699h6.36q.795 0 .796.796 0 .795-.796.796h-6.36q-.797 0-.797-.796t.797-.796"}))),s||(s=q.createElement("defs",null,q.createElement("clipPath",{id:"clip0_2553_22044"},q.createElement("path",{fill:"#fff",d:"M-1 0h19v19H-1z"})))))};function Q(){return(Q=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var $=function(e){return q.createElement("svg",Q({xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",viewBox:"0 0 12 12"},e),c||(c=q.createElement("path",{fill:"#515151",d:"M0 3.6A3.6 3.6 0 0 1 3.6 0h4.8A3.6 3.6 0 0 1 12 3.6v4.8A3.6 3.6 0 0 1 8.4 12H3.6A3.6 3.6 0 0 1 0 8.4zm3.6-2.5a2.5 2.5 0 0 0-2.5 2.5v4.8a2.5 2.5 0 0 0 2.5 2.5h4.8a2.5 2.5 0 0 0 2.5-2.5V3.6a2.5 2.5 0 0 0-2.5-2.5zm.403 4.288a.55.55 0 0 1 0-1.1h4.044a.55.55 0 0 1 0 1.1zm0 3.012a.55.55 0 0 1 0-1.1H6a.55.55 0 0 1 0 1.1z"})))};function J(){return(J=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var ee=function(e){return q.createElement("svg",J({xmlns:"http://www.w3.org/2000/svg",width:4,height:12,fill:"none",viewBox:"0 0 4 12"},e),u||(u=q.createElement("path",{stroke:"#98A2B3",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.333,d:"M2 6.667a.667.667 0 1 0 0-1.334.667.667 0 0 0 0 1.334M2 2A.667.667 0 1 0 2 .666.667.667 0 0 0 2 2M2 11.333A.667.667 0 1 0 2 10a.667.667 0 0 0 0 1.333"})))};function en(){return(en=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var et=function(e){return q.createElement("svg",en({xmlns:"http://www.w3.org/2000/svg",width:12,height:12,fill:"none",viewBox:"0 0 12 12"},e),d||(d=q.createElement("path",{fill:"currentColor",d:"M10.137 3.58 7.639 1.227H2.5a.636.636 0 0 0-.636.636v8.273a.636.636 0 0 0 .636.637h7a.637.637 0 0 0 .636-.637zM2.5.272H8.02l3.072 2.896v6.968a1.59 1.59 0 0 1-1.59 1.591h-7a1.59 1.59 0 0 1-1.592-1.59V1.862A1.59 1.59 0 0 1 2.5.273"})),f||(f=q.createElement("path",{fill:"#202020",d:"M10.455 3.133v.954H8.679a1.59 1.59 0 0 1-1.59-1.59V.454h.954v2.043a.636.636 0 0 0 .636.636zM6.5 4.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0M6.5 6.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0M6.5 8.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0"})))};function ei(){return(ei=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var er=function(e){return q.createElement("svg",ei({xmlns:"http://www.w3.org/2000/svg",width:11,height:12,fill:"none",viewBox:"0 0 11 12"},e),h||(h=q.createElement("path",{fill:"#202020",d:"M9.227 3.307 6.73.955H1.59a.636.636 0 0 0-.635.636v8.273a.636.636 0 0 0 .636.636h7a.636.636 0 0 0 .636-.636zM1.591 0h5.518l3.073 2.895v6.969a1.59 1.59 0 0 1-1.591 1.59h-7A1.59 1.59 0 0 1 0 9.865V1.59A1.59 1.59 0 0 1 1.59 0"})),p||(p=q.createElement("path",{fill:"#202020",d:"M9.545 2.86v.955H7.77a1.59 1.59 0 0 1-1.59-1.59V.18h.954v2.043a.636.636 0 0 0 .636.636zM2.386 5.09h5.395q.478 0 .478.478 0 .477-.478.477H2.386q-.477 0-.477-.477t.477-.477M2.386 7.636h5.395q.478 0 .478.478 0 .477-.478.477H2.386q-.477 0-.477-.477 0-.478.477-.478"})))},eo=t(90289),ea=t.n(eo);function el(){return(el=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var es=function(e){return q.createElement("svg",el({xmlns:"http://www.w3.org/2000/svg",width:11,height:10,fill:"none",viewBox:"0 0 11 10"},e),v||(v=q.createElement("path",{fill:"#858D9D",d:"M10.833 8.5c0 .398-.163.78-.453 1.06a1.57 1.57 0 0 1-1.093.44H8.77a1.57 1.57 0 0 1-1.093-.44 1.48 1.48 0 0 1-.452-1.06V7c0-.398.162-.78.452-1.06a1.57 1.57 0 0 1 1.093-.44h.516q.272.001.515.085V5c0-1.04-.417-2.038-1.162-2.784a4.18 4.18 0 0 0-2.832-1.214L5.68 1a4.2 4.2 0 0 0-2.87 1.128 3.95 3.95 0 0 0-1.25 2.747L1.556 5v.585q.243-.084.515-.085h.516a1.6 1.6 0 0 1 1.093.44A1.461 1.461 0 0 1 4.134 7v1.5c0 .398-.163.78-.453 1.06a1.57 1.57 0 0 1-1.093.44h-.516A1.57 1.57 0 0 1 .98 9.56 1.48 1.48 0 0 1 .526 8.5V5c0-2.761 2.307-5 5.154-5s5.153 2.239 5.153 5zm-8.245-2h-.516a.53.53 0 0 0-.342.126.5.5 0 0 0-.17.315L1.558 7v1.5c0 .122.046.24.13.332s.2.15.325.164l.06.004h.516a.52.52 0 0 0 .342-.126.5.5 0 0 0 .17-.316l.003-.058V7a.5.5 0 0 0-.151-.354.52.52 0 0 0-.364-.146m6.699 0H8.77a.52.52 0 0 0-.342.126.5.5 0 0 0-.17.315L8.257 7v1.5c0 .122.047.24.13.332.084.092.2.15.325.164l.06.004h.516a.53.53 0 0 0 .342-.126.5.5 0 0 0 .17-.316l.003-.058V7a.5.5 0 0 0-.15-.354.52.52 0 0 0-.365-.146"})))},ec=t(71096),eu=t.n(ec),ed=t(85462),ef=t.n(ed),eh=t(36852),ep=t(43180),ev=t(36331),ex=t(36706),eg=t(75825),em=t(89831),ek=t(54887),eC=t(94841),ew=t(25024),eb=t(36760),ey=t.n(eb),ej=t(45942),e_=t(96472),eS=t(16724),eE=t(89038),eT=t(31876),eL=t(74634),eI=t(60079),eH=t(3615),eM=t(41486),eZ=t(54632),eR=t(25922),eN=t(92498);function eO(e){var n=e.link||e.url;if(e.episode_img||e.podcast_img)return e.episode_img||e.podcast_img;if(!(n&&n.indexOf("http")>=0))return null;var t=new URL(n);return"https://metaso-static.oss-cn-beijing.aliyuncs.com/metaso/favicon/".concat(ef().getDomain(t.origin),".ico")}function eA(e){var n=document.querySelector(".searchLinkOffsetParent[data-id='".concat(e,"']"));return null==n?null:n.getBoundingClientRect().top}function eD(e){for(var n=null,t=[],i=new Set,r=0;r<e.length;r++){var o=e[r],a=o.repeatKey;a!=n&&t.push(o),o.linkBoxIndex=t.length-1,n=a,i.add(o.num-1)}return t}(i=x||(x={}))[i.LINK=1]="LINK",i[i.EXPLAIN_SESSION=2]="EXPLAIN_SESSION";var eB=(0,T.memo)((0,T.forwardRef)(function(e,n){var t=(0,T.useRef)(null),i=e.links,r=e.finished,o=(e.engineType,e.answerLinkNumHighlights),a=(0,b._)((0,T.useState)([]),2),l=a[0],s=a[1],c=(0,b._)((0,T.useState)([]),2),u=c[0],d=c[1],f=(0,b._)((0,T.useState)([]),2),h=f[0],p=f[1],v=(0,T.useRef)(h),x=eE.x.useAPI("pdfContainer"),g=(0,I.WS)(),m=(0,b._)((0,T.useState)("0"),2),k=m[0],C=m[1],w=L.Un.useBridge("ContentAPI"),y=(0,T.useRef)(null),S=L.vs.useBridge("tooltip"),Z=(0,T.useCallback)(function(e){var n=u.filter(function(n){return n.nodeId===e}),t=null;return n.length>0&&(Q(n[0].linkBoxIndex),t=n[0].linkBoxIndex),null!=t&&ei(e),t},[u]),A=(0,T.useMemo)(function(){return e.offsetTopOfMarkdownBody||112},[e.offsetTopOfMarkdownBody]),D=(0,T.useRef)(e.finished);(0,T.useEffect)(function(){e.finished&&!D.current&&setTimeout(function(){B()},500),D.current=e.finished},[e.finished]);var B=(0,T.useCallback)(function(){C((0,H.DOL)())},[]);L.Un.useRegister("LinkBoxAPI",{setActiveNode:function(n,t,i){var r=Z(n);if(null!=r){var o=l[r];if(1===o.type)er.current.highlightLinkText(n);else if(t)er.current.restoreSearchTool(null===(a=o.extraBox)||void 0===a?void 0:a.originData,!0);else if(er.current.restoreSearchTool(null===(s=o.extraBox)||void 0===s?void 0:s.originData,!1),i){var a,s,c,u=(0,E.getSelectContentHighlightElement)(n);null===(c=S.current)||void 0===c||c.setAnchorAndContent(u,(0,_.jsx)(eP,{engineType:e.engineType,dbResultId:e.dbResultId,isActive:!0,onLinkClicked:function(e){var n;e.preventDefault(),er.current.restoreSearchTool(null===(n=o.extraBox)||void 0===n?void 0:n.originData,!0)},item:o,onExtraBoxRemove:function(e){var n;w.current.removeSelectTextRange(e),null===(n=S.current)||void 0===n||n.cancel()}},n),e.engineType,function(){})}}},refresh:B,addSelectContentHandleNode:function(e){var n=P(e);if(h.filter(function(n){return n.id===e.id}).length>0){(null==n?void 0:n.finished)&&p(function(t){return t.map(function(t){return t.id!=e.id?t:Object.assign({},t,n)})});return}n&&(p(function(e){return(0,j._)(e).concat([n])}),setTimeout(function(){C((0,H.DOL)())},200),setTimeout(function(){var e;null===(e=y.current)||void 0===e||e.call(y,null==n?void 0:n.id)},300))}},[u,h,l]),(0,T.useEffect)(function(){v.current=h},[h]),(0,T.useEffect)(function(){y.current=Z},[Z]),(0,T.useEffect)(function(){e.extraBoxes&&e.extraBoxes.length>0&&p(e.extraBoxes.map(function(e){var n=e.session&&e.session.results&&e.session.results.length>0;return P(Object.assign(e,{finished:n,result:n?e.session.results[0].answer:""}))}).filter(function(e){return null!=e}))},[e.extraBoxes]);var P=(0,T.useCallback)(function(e){return e.type===M.V$.EXPLAIN?{type:2,title:e.selectText,date:eu()(new Date(e.createTime)).format("YYYY-MM-DD"),id:e.id,description:(0,R.iu)(e.result||""),sessionId:e.session.id,originData:e,finished:e.finished}:null},[]),F=(0,b._)((0,T.useState)(r),2),z=F[0],W=F[1];(0,T.useEffect)(function(){r&&(!z&&r&&(W(!0),setTimeout(function(){X()},200)),X())},[i,z,r,h,k]);var U=(0,T.useCallback)(function(e){var n;return null===(n=t.current)||void 0===n?void 0:n.querySelector("[origin-box-data-index='".concat(e,"']"))},[]),V=(0,T.useCallback)(function(e){return document.querySelectorAll(".reference-num[data-node-id='".concat(e,"']"))[0]},[]),q=(0,eN.Z)(function(){var n=v.current,t=[],i=eA(e.dbResultId);if(null!=i)return!function(e,n,t,i,r){var o=document.querySelectorAll("#search-content-container-".concat(e," .markdown-body .reference-num[data-link-index]"));if(0!=o.length)for(var a=0;a<o.length;a++){var l=o[a],s=parseInt(l.getAttribute("data-link-index")),c=i[s],u=l.getAttribute("data-node-id"),d=l.getBoundingClientRect();n.push({type:1,nodeId:u,num:s+1,repeatKey:s+1,offsetTopOfMarkdownBody:d.top-t,firstLineHeight:d.height,icon:eO(c),description:a<r.length?r[a]:"",originLink:c,title:c.title,titleLinkUrl:c.link||c.url,date:c.date||(0,R.l6)(c.publish_date,"-"),finished:!0})}}(e.dbResultId,t,i,e.links,o),!function(e,n,t){for(var i=1e5,r=0;r<t.length;r++){var o=t[r],a=(0,E.getSelectContentHighlightElement)(o.id);if(a){var l=a.getBoundingClientRect();e.push({type:o.type,nodeId:o.id,num:r+1,repeatKey:i++,offsetTopOfMarkdownBody:l.top-n,firstLineHeight:l.height,date:o.date,title:o.title,extraBox:o,description:o.description,finished:o.finished})}}}(t,i,n),t.sort(function(e,n){return e.offsetTopOfMarkdownBody-n.offsetTopOfMarkdownBody})}),G=(0,eN.Z)(function(){if(r){var e=q();0!=e.length&&(s(eD(e)),d(e))}}),X=(0,b._)((0,N.Nr)(G,30),1)[0],K=(0,b._)((0,T.useState)(null),2),Y=K[0],Q=K[1],$=(0,b._)((0,T.useState)([]),2),J=$[0],ee=$[1],en=(0,b._)((0,T.useState)(null),2),et=en[0],ei=en[1];(0,T.useLayoutEffect)(function(){try{var n=function(e,n,t,i,r,o){for(var a=[],l=0,s=new Map,c=0;c<e.length;c++){var u=e[c],d=function(e,n,t,i){for(var r=e+1,o=t;r<n.length&&n[r].linkBoxIndex==t.linkBoxIndex;)n[r].nodeId==i&&(o=n[r]),r++;return{lastRepeatNodeIndex:--r,chooseNodeInfo:o}}(c,e,u,n);u=d.chooseNodeInfo,c=d.lastRepeatNodeIndex;var f=t(u.linkBoxIndex).getBoundingClientRect().height;s.set(c,f);var h=u.nodeId===n,p=u.offsetTopOfMarkdownBody+u.firstLineHeight/2-f/2,v=h?o(u):p;if(l+5<=v){a.push(Math.max(5,v-l)),l+=a[a.length-1]+f;continue}if(a.push(5),h)for(var x=l+i-v,g=a.length-1;g>=0;){if(a[g]-i>x)a[g]=a[g]-x,x=0;else{var m=a[g];a[g]=i,x-=m-i}if(0==x){l=v;break}0==g&&x>0&&(a[g]-=x),g--}l+=a[a.length-1]+f}for(;c<r.length;c++)a.push(i);return a}(u,et,U,5,i,function(n){if(1!==n.type)return n.offsetTopOfMarkdownBody;var t=eA(e.dbResultId);if(null==t)return n.offsetTopOfMarkdownBody;var i=er.current.getActiveHighlightAnchor();return i?i.getBoundingClientRect().top-t:n.offsetTopOfMarkdownBody});ee(n)}catch(e){}},[u,U,et,i]);var er=L.Un.useBridge("ContentAPI"),eo=(0,T.useCallback)(function(e){Q(e);var n=l[e],t=u.filter(function(n){return n.linkBoxIndex===e});if(t.length>0){var i,r=t.filter(function(e){return e.nodeId===et}),o=et;0==r.length&&(ei(t[0].nodeId),o=t[0].nodeId),1==n.type?er.current.highlightLinkText(o,!0):2==n.type&&er.current.restoreSearchTool(null===(i=n.extraBox)||void 0===i?void 0:i.originData,!1)}},[u,et,Y,l,er.current]),ea=(0,T.useCallback)(function(n,t){var i,r=l[t];if(1==r.type){var o=r.originLink;if(o.file_meta){n.preventDefault(),n.stopPropagation();var a=V(et),s=a.getAttribute("data-index");(0,eH.SQ)(o,!1,g,x,{id:e.dbResultId,index:u.filter(function(e){return e.nodeId===et})[0].num-1,highlightText:r.description},a,s),setTimeout(function(){er.current.highlightTextByRid(s)},300)}}else 2==r.type&&er.current.restoreSearchTool(null===(i=r.extraBox)||void 0===i?void 0:i.originData,!0)},[l,g,x,er.current,et,e.dbResultId,u]),el=(0,T.useCallback)(function(e){s(function(n){return n.filter(function(n){return!n.extraBox||n.extraBox.id!=e})}),er.current.removeSelectTextRange(e),Q(null),ei(null),C((0,H.DOL)())},[er.current]),es=(0,T.useCallback)(function(e,n,t){s(function(i){return i.map(function(i){if(i.extraBox&&i.extraBox.originData&&i.extraBox.originData.session&&i.extraBox.originData.session.id===e){var r=Object.assign({},i);return r.extraBox.originData.session.topicId=n,r.extraBox.originData.session.topicName=t,r}return i})})},[]);return(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(O.Z,{className:"search-origin-list-box",sx:{display:"flex",flexDirection:"column",marginTop:"-".concat(A,"px"),transition:"margin-top .3s",overflow:"hidden",position:"relative"},ref:t,children:[(0,_.jsx)(O.Z,{sx:{position:"absolute",top:0,left:0,right:0,height:"".concat(A,"px"),zIndex:1,backgroundColor:"var(--gray)"}}),l.map(function(n,t){return(0,_.jsx)(eP,{sessionTopicChanged:es,dbResultId:e.dbResultId,onExtraBoxRemove:el,item:n,onLinkClicked:function(e){return ea(e,t)},style:{marginTop:"".concat(t<J.length?J[t]:5,"px"),transition:"margin-top .3s"},"origin-box-data-index":t,engineType:e.engineType,onClick:function(){return eo(t)},isActive:Y===t},t)})]})})}));function eP(e){var n,t,i,r,o,a,l,s,c,u,d,f,h,p,v=e.isActive,x=e.item,g=e.engineType,m=e.onBoxMouseEnter,j=e.onMouseLeave,E=e.onClick,N=(e.onLinkClicked,(0,w._)(e,["isActive","item","engineType","onBoxMouseEnter","onMouseLeave","onClick","onLinkClicked"])),B=1===x.type?x.originLink:{},P=B.episode_img||B.podcast_img||x.icon,F=(0,T.useMemo)(function(){var e=x.description;if(!e){if(1===x.type&&(null===(n=x.originLink)||void 0===n?void 0:n.matched_snippet))e=null===(i=x.originLink)||void 0===i?void 0:i.matched_snippet;else{if(1!==x.type||null===(t=x.originLink)||void 0===t||!t.abstract)return"";e=x.originLink.abstract}}if(e.trim().startsWith("[summary]"))return e.substring(e.indexOf("[summary]")+9);if(2===x.type){var n,t,i,r,o,a,l,s,c,u,d,f,h,p=(null===(l=x.extraBox)||void 0===l?void 0:null===(a=l.originData)||void 0===a?void 0:null===(o=a.realTimeData)||void 0===o?void 0:null===(r=o.data)||void 0===r?void 0:r.pinyin)||(null===(h=x.extraBox)||void 0===h?void 0:null===(f=h.originData)||void 0===f?void 0:null===(d=f.session)||void 0===d?void 0:null===(u=d.results[0])||void 0===u?void 0:null===(c=u.realTimeData)||void 0===c?void 0:null===(s=c.data)||void 0===s?void 0:s.pinyin);if(p)return"拼音：".concat(p[0])+"\n"+e}return e},[x.description,x.type,null===(n=x.originLink)||void 0===n?void 0:n.matched_snippet]),z=(0,I.WS)(),W=(0,eL.dM)(),q=W.ifGoToDownloadAppPageAvailable;W.tryGoToDownloadAppPage;var G=(0,T.useCallback)(function(n,t){t.stopPropagation(),t.preventDefault(),(0,H.XO6)(n.id).then(function(t){0==t.data.errCode?e.onExtraBoxRemove(n.id):(0,Z.y)("删除失败:".concat(t.data.errMsg),{variant:"error",autoHideDuration:3e3})}).catch(function(e){(0,Z.y)("删除失败",{variant:"error",autoHideDuration:3e3})}),(0,R.dW)(R.Gy.DELETE_EXTRA_BOX,{extraBox:n})},[e]),K=(0,b._)((0,T.useState)(!1),2),Y=K[0],Q=K[1],J=(0,b._)((0,T.useState)(!1),2),ee=J[0],en=J[1],et=(0,b._)((0,T.useState)(!1),2),ei=et[0],er=et[1],eo=(0,b._)((0,T.useState)(""),2),el=eo[0],es=eo[1],ec=(0,b._)((0,T.useState)(""),2),eu=ec[0],ed=ec[1],ef=(0,eN.Z)(function(n){ej(),x.originLink&&x.originLink.abstract&&x.originLink.id&&!x.originLink.file_meta?(n.preventDefault(),n.stopPropagation(),eQ(x.originLink.id)):e.onLinkClicked(n)}),ep=(0,eN.Z)(function(e){x.titleLinkUrl||ef(e)}),ev=L.wY.useAPI("pptAPI"),ek=(0,T.useCallback)(function(e){var n,t,i,r,o,a;null===(a=ev.current)||void 0===a||a.show(null===(n=x.originLink)||void 0===n?void 0:n.file_meta._id,{id:null===(t=x.originLink)||void 0===t?void 0:t.file_meta._id,title:null===(i=x.originLink)||void 0===i?void 0:i.file_meta.title,pdfUrl:null===(r=x.originLink)||void 0===r?void 0:r.file_meta.url,displayUrl:null===(o=x.originLink)||void 0===o?void 0:o.file_meta.url})},[x.originLink,e]),eC=(0,eM.BN)(),ew=eC.openWebsitePPT,eb=eC.pptLoading,ej=(0,eN.Z)(function(){e.fullScreenContext&&e.fullScreenContext.isFullScreen&&e.fullScreenContext.handleFullScreenToggle&&e.fullScreenContext.handleFullScreenToggle(!1)}),e_=(0,T.useCallback)(function(e,n){if(ej(),n.file_meta)ek(null);else if(e.titleLinkUrl){var t;ew(null===(t=e.originLink)||void 0===t?void 0:t.id,e.titleLinkUrl)}},[ek,ew]),eS=(0,T.useMemo)(function(){var e=ee?el:x.title;return(2===x.type&&(e="解释："+e),v)?(0,_.jsx)(V.SearchReferenceLink,{href:x.titleLinkUrl,preventCopy:function(){return q()},target:"_blank",sx:{cursor:"pointer"},onLinkClick:ep,children:Y?(0,_.jsx)(A.Z,{width:"100%"}):e}):e},[x.title,el,v,x.type,Y,ep,ee]),eE=(0,T.useCallback)(function(){ee?en(!1):ei?en(!0):eT()},[ee]),eT=function(){Q(!0),(0,H.UsC)(x.title+"\n\n"+F).then(function(e){if(0===e.data.errCode){var n=e.data.data,t=(0,y._)(n.split("\n\n")),i=t[0],r=t.slice(1);r=r.join("\n\n"),es(i),ed(r),Q(!1),en(!0),er(!0)}else if(e.data.errCode===em.cO.TOO_MANY_REQUESTS2)var o=0,a=setInterval(function(){o+=1,"true"===localStorage.getItem("cloudflareVerifySuccess")&&((0,R.Ev)(a),eT()),o>=300&&(0,R.Ev)(a)},1e3);else e.data.errCode===em.cO.TOO_MANY_REQUESTS?eT():((0,Z.y)("翻译失败",{variant:"error",autoHideDuration:2e3}),Q(!1))}).catch(function(e){(0,Z.y)("翻译失败",{variant:"error",autoHideDuration:2e3}),Q(!1)})},eH=(0,T.useMemo)(function(){var e=ee?eu:F;return(0,R.Qd)(e,150,75)},[F,eu,ee]),eO=(0,T.useMemo)(function(){return B&&B.type&&B.type.indexOf("summary")>=0&&eH?(0,_.jsx)($,{style:{marginRight:"4px",verticalAlign:"middle",marginBottom:"3px"}}):null},[B,eH]),eA=(0,T.useRef)(null),eD=(0,T.useCallback)(function(e){var n,t,i,r=null===(i=x.extraBox)||void 0===i?void 0:null===(t=i.originData)||void 0===t?void 0:null===(n=t.session)||void 0===n?void 0:n.id;r&&(0,ex.hr)(z,r,!0)},[null===(t=x.extraBox)||void 0===t?void 0:t.originData]),eB=(0,T.useCallback)(function(){eE()},[eE]),eP=L.vs.useBridge("tooltip"),eW=(0,T.useCallback)(function(){var n,t,i,r;null===(i=eA.current)||void 0===i||i.show(e.item.title,e.dbResultId,null===(n=e.item.originLink)||void 0===n?void 0:n.docId,null===(t=e.item.originLink)||void 0===t?void 0:t.matched_snippet),null===(r=eP.current)||void 0===r||r.keepVisible(!0)},[]),eV=(0,T.useCallback)(function(){var e;null===(e=eP.current)||void 0===e||e.cancel(!0)},[]),eq=(0,T.useMemo)(function(){var e=[];return 2===x.type?[{text:"打开",onClick:eD}]:(1===x.type&&(((0,M.CN)(x.title)||(0,M.CN)(F))&&e.push({text:ee?"取消翻译":"翻译",onClick:eB}),e.push({text:"总结",onClick:eW})),e)},[x.type,eD,x.title,eB,eW,F,ee]),eG=L.vs.useBridge("academicDetailAPI"),eQ=(0,T.useCallback)(function(e){if(eG.current)eG.current.show(e);else{var n=new URL(eg.l.AcademicDetail,location.origin);n.searchParams.set("id",e),z.push(n.href)}},[z]),eJ=(0,eR.F)().resolvedTheme;return(0,_.jsxs)(O.Z,(0,C._)((0,k._)({onMouseEnter:m,onMouseLeave:j,onClick:E,sx:{width:"380px",boxSizing:"border-box",display:"flex",flexDirection:"row",gap:"8px",borderRadius:"8px",cursor:v?void 0:"pointer",border:"1px solid ".concat(v?"var(--box-active-b-color)":"var(--box-b-color)"),padding:v?"12px 14px":"6px 12px",fontWeight:400,fontSize:"14px",lineHeight:"16px",color:"var(--box-text-color)",background:v?"var(--box-active-bg)":"var(--gray)","&:hover":(0,k._)({},v?{backgroundColor:"var(--box-active-hover-bg)"}:{backgroundColor:"var(--box-hover-bg)"})},className:ey()(ea()["search-origin-box"],"search-origin-box",v?"active":"")},N),{children:[(0,_.jsx)(O.Z,{className:ea().contentContainer,sx:{width:"100%","&:hover .deleteExtraBoxButton":{display:"flex"},"& .markdown-body":{lineHeight:"20px"}},children:v&&e.engineType==S.rG.PODCAST&&2!==x.type?(0,_.jsx)(O.Z,{children:(0,_.jsx)(ez,{reference:x.originLink,isActive:v})}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(O.Z,{sx:{display:"flex",alignItems:"center",gap:"5px",width:"100%"},children:[e.engineType!==S.rG.SCHOLAR&&P&&!B.scholar&&!B.file_meta&&(0,_.jsx)(eh.P,{src:P,fallbackSrc:"/image/default-website-icon.svg",width:16,style:{borderRadius:"4px"}}),2===x.type&&(0,_.jsx)(O.Z,{sx:{color:v?"black":"#ADB5C2",display:"inline-block",height:"18px"},children:(0,_.jsx)(U.Z,{})}),(0,_.jsx)(O.Z,{sx:{flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:v?"var(--black)":"var(--box-text-color)",a:{color:"var(--box-text-color)",textDecorationColor:"transparent"}},children:eS}),v&&!(null==x?void 0:null===(r=x.originLink)||void 0===r?void 0:null===(i=r.file_meta)||void 0===i?void 0:i.internalFile)&&(0,_.jsxs)(_.Fragment,{children:[v&&1===x.type&&(0,_.jsx)(O.Z,{sx:{display:"inline-flex"},children:(0,_.jsx)(V.AddToSubjectButton,{zIndex:100001,link:B})}),x.finished&&v&&2===x.type&&!!F.length&&(0,_.jsx)(O.Z,{sx:{display:"inline-flex"},children:(0,_.jsx)(V.AddToSubjectButton,{topicId:null===(o=x.extraBox)||void 0===o?void 0:o.originData.session.topicId,sessionTopicChanged:e.sessionTopicChanged,topicName:null===(a=x.extraBox)||void 0===a?void 0:a.originData.session.topicName,link:{},sessionId:null===(l=x.extraBox)||void 0===l?void 0:l.originData.session.id})})]})]}),v&&x.finished&&(B.authors||B.author)&&(0,_.jsx)(O.Z,{sx:{flex:"1",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"dark"===eJ?"#858D9D":"#20202078",fontSize:"12px",margin:"0 0 8px 0","&.hover":{color:"var(--black)"}},children:B.authors?B.authors.join(";"):B.author}),v&&(x.finished&&!Y?(0,_.jsxs)(O.Z,{sx:{paddingLeft:((e.engineType===S.rG.SCHOLAR||B.scholar)&&null!==(s=x.originLink)&&void 0!==s&&s.file_meta,"0")},children:[(0,_.jsxs)(O.Z,{sx:{position:"relative",fontSize:"13px",fontWeight:"400"},children:[(0,_.jsx)(V.AbstractMarkdown,{content:eH,fontSize:"13px",pLineHeight:"1.5",pColor:"dark"===eJ?"#FFFFFFB3":"#202020B3",firstLineIcon:eO}),e.engineType===S.rG.SCHOLAR&&x.originLink&&(0,_.jsx)(eU,{link:x.originLink})]}),(0,_.jsxs)(O.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",sx:{color:"dark"===eJ?"#858D9D":"#20202078",fontSize:"12px",fontWeight:"400",margin:"8px auto",alignItems:"center"},children:[(0,_.jsxs)(O.Z,{className:"min-w-0",children:[1===x.type&&!(null===(c=x.originLink)||void 0===c?void 0:c.video)&&(null===(u=x.originLink)||void 0===u?void 0:u.displaySource)&&(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(O.Z,{sx:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:null===(d=x.originLink)||void 0===d?void 0:d.displaySource})}),(null===(f=x.originLink)||void 0===f?void 0:f.video)&&(null===(h=x.originLink)||void 0===h?void 0:h.duration)&&(0,_.jsxs)(O.Z,{style:{display:"flex",alignItems:"center",gap:"4px",lineHeight:"16px"},children:[(0,_.jsx)(eI.Z,{}),(0,_.jsx)(O.Z,{style:{fontSize:"12px"},children:(0,R.LU)(x.originLink.duration)})]})]}),(0,_.jsx)(O.Z,{minWidth:"60px",children:x.date&&(0,_.jsx)(O.Z,{textAlign:"right",sx:{whiteSpace:"nowrap"},children:eF(x.date)})})]}),(0,_.jsxs)(O.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",sx:{color:"#858D9D",fontSize:"10px",lineHeight:"14px",fontWeight:"400",marginTop:"8px"},children:[(0,_.jsxs)(O.Z,{className:"flex-nowrap inline-flex min-w-24",alignItems:"center",children:[2===x.type&&(0,_.jsx)(O.Z,{sx:{cursor:"pointer",display:"none",alignItems:"center"},className:"deleteExtraBoxButton",onClick:function(e){return G(x.extraBox,e)},children:(0,_.jsx)(X,{})}),B.file_meta&&(0,_.jsx)(O.Z,{className:"w-[90px]  min-w-10!",onClick:ef,children:(0,_.jsx)(e$,{sx:{width:"calc(100% - 4px)",minWidth:0},resolvedTheme:eJ,type:g===S.rG.KNOWLEDGE?"LIB":(0,S.fv)(B.file_meta.type)})}),(B.file_meta||x.titleLinkUrl)&&(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(eZ.Z,{sx:{minWidth:40,border:"dark"===eJ?"1px solid #4BA1FF":"1px solid #1570EF",color:"dark"===eJ?"#4BA1FF":"",gap:"4px",width:"90px",fontSize:"13px",marginRight:"4px",padding:"2px 8px",fontWeight:"normal",alignItems:"center",":hover":{backgroundColor:"dark"===eJ?"#2b3c4e":"#FFFFFF"}},onClick:function(){return e_(x,B)},disabled:eb,children:eb?(0,_.jsx)(D.Z,{size:19.5,sx:{color:"dark"===eJ?"#4BA1FF":"#1570EF"}}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("svg",{width:"12",height:"14",viewBox:"0 0 14 18",fill:"dark"===eJ?"#4BA1FF":"#1570EF",xmlns:"http://www.w3.org/2000/svg",children:(0,_.jsx)("path",{d:"M1.16675 3.15797C1.16675 2.34866 1.16675 1.94401 1.33549 1.72095C1.48249 1.52663 1.70718 1.40638 1.95041 1.39186C2.22961 1.37519 2.5663 1.59965 3.23968 2.04857L12.0026 7.89054C12.5591 8.26148 12.8373 8.44695 12.9342 8.68072C13.019 8.8851 13.019 9.11479 12.9342 9.31917C12.8373 9.55294 12.5591 9.73841 12.0026 10.1093L3.23968 15.9513C2.5663 16.4002 2.22961 16.6247 1.95041 16.608C1.70718 16.5935 1.48249 16.4733 1.33549 16.2789C1.16675 16.0559 1.16675 15.6512 1.16675 14.8419V3.15797Z",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,_.jsx)(O.Z,{children:"讲解"})]})})})]}),(0,_.jsxs)(O.Z,{className:"inline-flex",alignItems:"center",children:[x.originLink&&x.originLink.quote&&(0,_.jsxs)(O.Z,{display:"flex",fontSize:"12px",children:[(0,_.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:[(0,_.jsx)("g",{clipPath:"url(#clip0_3234_5194)",children:(0,_.jsx)("path",{d:"M11.4902 7.25C11.6254 7.25 11.7551 7.30268 11.8507 7.39645C11.9463 7.49021 12 7.61739 12 7.75V10.5C12 10.6326 11.9463 10.7598 11.8507 10.8536C11.7551 10.9473 11.6254 11 11.4902 11H8.94118C8.80597 11 8.6763 10.9473 8.58069 10.8536C8.48508 10.7598 8.43137 10.6326 8.43137 10.5V7.0925C8.43067 6.10499 8.78995 5.14977 9.44437 4.39929C10.0988 3.6488 11.0052 3.15251 12 3V5.25C11.5944 5.25 11.2054 5.40804 10.9185 5.68934C10.6317 5.97064 10.4706 6.35218 10.4706 6.75V7.25H11.4902ZM11.4902 4.815V3.6525C10.7539 3.8663 10.1077 4.30768 9.64791 4.91089C9.18812 5.5141 8.93934 6.24686 8.93863 7V7.25H8.94118V10.25C8.94118 10.3163 8.96803 10.3799 9.01584 10.4268C9.06364 10.4737 9.12847 10.5 9.19608 10.5H11.2353C11.3029 10.5 11.3677 10.4737 11.4155 10.4268C11.4633 10.3799 11.4902 10.3163 11.4902 10.25V8C11.4902 7.9337 11.4633 7.87011 11.4155 7.82322C11.3677 7.77634 11.3029 7.75 11.2353 7.75H9.96078V6.75C9.96112 6.30686 10.1115 5.87639 10.3883 5.52616C10.6651 5.17593 11.0527 4.92578 11.4902 4.815ZM7.05882 11H4.5098C4.3746 11 4.24493 10.9473 4.14932 10.8536C4.05371 10.7598 4 10.6326 4 10.5V7.0925C3.99929 6.10499 4.35858 5.14977 5.013 4.39929C5.66741 3.6488 6.57384 3.15251 7.56863 3L7.30429 4.815C6.98416 5.25 6.77399 5.40804 6.48717 5.68934C6.20035 5.97064 6.03922 6.35218 6.03922 6.75V7.25H7.05882C7.19403 7.25 7.3237 7.30268 7.41931 7.39645C7.51492 7.49021 7.56863 7.61739 7.56863 7.75V10.5C7.56863 10.6326 7.51492 10.7598 7.41931 10.8536C7.3237 10.9473 7.19403 11 7.05882 11ZM7.05882 8C7.05882 7.9337 7.03197 7.87011 6.98416 7.82322C6.93636 7.77634 6.87153 7.75 6.80392 7.75H5.52941V6.75C5.52975 6.30686 5.68013 5.87639 5.95695 5.52616C6.23377 5.17593 6.48717 4.91089 6.8 4.6L7.05882 3.6525C6.32251 3.8663 5.67632 4.30768 5.21654 4.91089C4.75675 5.5141 4.50797 6.24686 4.50726 7V7.25H4.5098V10.25C4.5098 10.3163 4.53666 10.3799 4.58446 10.4268C4.63227 10.4737 4.6971 10.5 4.76471 10.5H6.80392C6.87153 10.5 6.93636 10.4737 6.98416 10.4268C7.03197 10.3799 7.05882 10.3163 7.05882 10.25V8Z",fill:"#858D9D"})}),(0,_.jsx)("defs",{children:(0,_.jsx)("clipPath",{id:"clip0_3234_5194",children:(0,_.jsx)("rect",{width:"14",height:"14",fill:"white"})})})]}),(0,_.jsx)("div",{className:"basis-[5px] shrink-1 min-w-[1px]"}),x.originLink.quote]}),g!=S.rG.VIDEO&&!(null===(p=x.originLink)||void 0===p?void 0:p.video)&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"basis-[15px] shrink-1 min-w-[4px]"}),(0,_.jsx)(eX,{items:eq})]})]})]})]}):(0,_.jsx)(O.Z,{sx:{marginTop:"8px"},children:(0,_.jsx)(eK,{})}))]})}),(0,_.jsx)(eY,{ref:eA,afterClose:eV})]}))}function eF(e){var n=e.replace(/[年月]/g,"-").replace(/[日秒]/g,"").replace(/[时分]/g,":");try{return eu()(new Date(n)).format("YYYY-MM-DD")}catch(n){return e}}function ez(e){var n=e.reference,t=e.isActive,i=(0,b._)((0,T.useState)(V.PodCastTab.INTRO),2),r=i[0],o=i[1],a=(0,b._)((0,T.useState)(n.episode_img||n.podcast_img||ew.Z.src),2),l=a[0],s=a[1];(0,T.useEffect)(function(){(0,T.startTransition)(function(){s(n.episode_img||n.podcast_img||ew.Z.src),o(V.PodCastTab.INTRO)})},[n]);var c=(0,T.useCallback)(function(){window.open(n.episode_url,"_blank")},[]),u=(0,b._)((0,T.useState)(),2),d=u[0],f=u[1];return(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(O.Z,{children:[(0,_.jsxs)(O.Z,{sx:{display:"flex",alignItems:"flex-start",gap:"10px",width:"100%"},children:[(0,_.jsx)(O.Z,{sx:{color:t?"black":"#ADB5C2",height:d?"60px":"18px",display:"inline-flex",justifyContent:"center"},children:(0,_.jsx)("img",{src:l,width:d?60:16,height:d?60:16,style:{borderRadius:"4px"},onError:function(){return s(ew.Z.src)}})}),(0,_.jsxs)(O.Z,{sx:{display:"flex",flex:"1",flexDirection:"column",minHeight:d?"60px":"16px",justifyContent:"space-between"},children:[(0,_.jsxs)(O.Z,{sx:{display:"flex",flex:"1",flexDirection:"row",justifyContent:"space-between"},children:[(0,_.jsx)(O.Z,{sx:{flex:"1",fontSize:"16px",lineHeight:"18px",maxWidth:"314px",overflow:"hidden",textOverflow:"ellipsis",color:t?"var(--black)":"var(--box-text-color)",a:{color:"var(--box-text-color)",textDecorationColor:"transparent"}},style:{maxWidth:d?"270px":"314px",whiteSpace:d?"normal":"nowrap"},children:(0,_.jsx)(V.SearchReferenceLink,{href:n.episode_url,target:"_blank",sx:{cursor:"pointer"},children:n.episode_name})}),(0,_.jsx)(O.Z,{onClick:function(){return f(function(e){return!e})},sx:{cursor:"pointer",width:"20px"},children:d?(0,_.jsx)(e_.Z,{}):(0,_.jsx)(ej.Z,{})})]}),d&&(0,_.jsxs)(O.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"4px"},children:[(0,_.jsx)(O.Z,{children:e.reference.top&&(0,_.jsxs)(O.Z,{className:ea().podcastToTag,children:["Top ",e.reference.top]})}),(0,_.jsx)(O.Z,{display:"flex",alignItems:"center",children:e.reference.episode_duration&&(0,_.jsxs)(O.Z,{sx:{fontWeight:400,fontSize:"10px",lineHeight:"22px",color:"#858D9D"},children:[Math.floor(e.reference.episode_duration/60),"分钟"]})})]})]})]}),(0,_.jsxs)(B.Z,{sx:{"& .MuiTabs-flexContainer":{marginTop:"5px",gap:"20px"},"&[class]":{overflow:"unset !important",minHeight:"unset"},".MuiTabs-scroller[class]":{overflow:"unset !important"},".MuiTabs-scroller .MuiTabs-indicator[class]":{borderRadius:"10px",height:"1px",bgcolor:"#1570ef",transform:"translateY(1px) scaleX(.8)"},".Mui-selected[class][class]":{color:"#1570ef"}},value:r,onChange:function(e,n){o(n)},children:[(0,_.jsx)(eW,{activeTab:r,label:"介绍",value:V.PodCastTab.INTRO}),n.episode_desc_summary_guest&&(0,_.jsx)(eW,{activeTab:r,label:"嘉宾",value:V.PodCastTab.GUEST}),n.episode_desc_summary_timeline&&(0,_.jsx)(eW,{activeTab:r,label:"时间轴",value:V.PodCastTab.TIMELINE})]}),(0,_.jsx)(P.Z,{className:ea().tabLine}),(0,_.jsxs)(O.Z,{sx:{position:"relative"},children:[(0,_.jsxs)(O.Z,{sx:{maxHeight:"140px",overflowY:"auto"},children:[(0,_.jsxs)(O.Z,{display:r===V.PodCastTab.INTRO?"block":"none !important",children:[(0,_.jsx)(V.AbstractMarkdown,{content:n.episode_desc_summary_intro||"暂无",fontSize:"12px"}),(0,_.jsx)(O.Z,{className:ea()["content-footer-mask"]})]}),n.episode_desc_summary_guest&&(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(O.Z,{display:r===V.PodCastTab.GUEST?"block":"none !important",children:[(0,_.jsx)(V.AbstractMarkdown,{content:n.episode_desc_summary_guest,fontSize:"12px"}),(0,_.jsx)(O.Z,{className:ea()["content-footer-mask"]})]})}),n.episode_desc_summary_timeline&&(0,_.jsx)(_.Fragment,{children:(0,_.jsxs)(O.Z,{display:r===V.PodCastTab.TIMELINE?"block":"none !important",children:[(0,_.jsx)(V.TimeLine,{content:n.episode_desc_summary_timeline,url:n.episode_url,fontSize:"12px"}),(0,_.jsx)(O.Z,{className:ea()["content-footer-mask"]})]})})]}),n.has_script&&(0,_.jsx)(eV,{link:n})]}),(0,_.jsxs)(O.Z,{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",sx:{color:"#667085",marginTop:"8px",fontSize:"10px",fontWeight:400,alignItems:"center",lineHeight:"16px"},children:[(0,_.jsx)(O.Z,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"200px",cursor:"pointer"},onClick:function(){c()},children:e.reference.podcast_name}),(0,_.jsxs)(O.Z,{display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",children:[e.reference.episode_audio_play>0&&(0,_.jsxs)(F.Z,{direction:"row",spacing:.5,alignItems:"center",sx:{cursor:"pointer"},onClick:function(){c()},children:[(0,_.jsx)(es,{}),(0,_.jsx)(O.Z,{children:e.reference.episode_audio_play>=1e4?Math.round(e.reference.episode_audio_play/1e3)/10+"万":e.reference.episode_audio_play})]}),e.reference.episode_audio_publish_date&&(0,_.jsx)(O.Z,{sx:{marginLeft:"15px",cursor:"pointer"},onClick:function(){c()},children:eF(e.reference.episode_audio_publish_date)}),(0,_.jsx)(O.Z,{children:(0,_.jsx)(eX,{items:[{text:"打开",onClick:c}]})})]})]})]})})}(r=g||(g={})).ZH="zh",r.EN="en";var eW=(0,T.memo)(function(e){var n=e.className,t=e.activeTab,i=e.value,r=(0,w._)(e,["className","activeTab","value"]);return(0,_.jsx)(z.Z,(0,k._)({className:ey()(n,[ea().cardTab],(0,m._)({},ea().cardTabActive,t===i)),value:i},r))});function eU(e){var n=(0,I.WS)(),t=L.vs.useBridge("academicDetailAPI"),i=L.vs.useBridge("tooltip"),r=(0,T.useCallback)(function(){var r;if(t.current)t.current.show(e.link.id);else{var o=new URL(eg.l.AcademicDetail,location.origin);o.searchParams.set("id",e.link.id),n.push(o.href)}null===(r=i.current)||void 0===r||r.cancel(!0)},[e.link.id,n]);return(0,_.jsxs)(eq,{onClick:r,children:[(0,_.jsx)(et,{}),"摘要"]})}function eV(e){var n=(0,eS.useShowDoucment)({isH5:e.isH5,reference:e.link}).showDocument,t=(0,T.useCallback)(function(){n()},[]);return(0,_.jsxs)(eq,{onClick:t,sxx:e.sxx||{},children:[(0,_.jsx)(er,{}),"文稿"]})}function eq(e){return(0,_.jsx)(O.Z,{className:"descriptionFloatToolButton",onClick:e.onClick,sx:(0,k._)({position:"absolute",display:"none",bottom:"0px",right:"-7px",width:"60px",lineHeight:"20px",fontSize:"12px",fontWeight:400,flexDirection:"row",alignItems:"center",gap:"5px",cursor:"pointer",border:"1px solid #EAECF0",backgroundColor:"white",borderRadius:"14px 0px 0px 14px",paddingLeft:"10px",borderRight:"none",color:"#667085","&:hover":{color:"black",borderColor:"#667085"}},e.sxx),children:e.children})}function eG(e,n){return(0,R.$Z)(e)&&(!n||n&&(0,R.$Z)(n))?"en":"zh"}function eX(e){var n=(0,T.useRef)(null),t=(0,b._)((0,T.useState)(!1),2),i=t[0],r=t[1],o=(0,b._)((0,T.useState)(null),2),a=o[0],l=o[1];(0,ep.bQ)({anchor:function(){return a},popover:function(){var e;return null===(e=n.current)||void 0===e?void 0:e.nodeRef.current}},i,function(){return r(!1)});var s=(0,eN.Z)(function(e){e.stopPropagation(),r(function(e){return!e})});return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(ev.Z,{ref:l,sx:{color:"#667085",width:16,height:16,minWidth:0,flex:"none",fontSize:"16px",fontWeight:400,marginBottom:"1px"},checked:i,onClick:s,children:(0,_.jsx)(ee,{})}),(0,_.jsx)(ep.ZP,{offsetOptions:{mainAxis:20},zIndex:100001,isAutoUpdate:!0,ref:n,placement:"bottom-end",open:i,onOpenChanged:function(e){r(e)},anchor:a,children:(0,_.jsx)(O.Z,{className:ea().moreActionMenu,children:e.items.map(function(e,n){return(0,_.jsx)(O.Z,{className:ea().moreActionMenuItem,onClick:function(n){r(!1),e.onClick(n),(0,R.dW)(R.Gy.SEARCH_RIGHT_BOX_MORE_ACTION_CLICKED,{type:e.text})},children:e.text},n)})})})]})}function eK(){return(0,_.jsxs)(O.Z,{children:[(0,_.jsx)(A.Z,{width:"100%"}),(0,_.jsx)(A.Z,{width:"100%"}),(0,_.jsx)(A.Z,{width:"100%"}),(0,_.jsx)(A.Z,{width:"100%"})]})}var eY=(0,T.memo)((0,T.forwardRef)(function(e,n){var t=(0,b._)((0,T.useState)(!1),2),i=t[0],r=t[1];(0,T.useImperativeHandle)(n,function(){return{show:function(e,n,t,i){p(e,n,t,i)}}},[]);var o=(0,b._)((0,T.useState)(!1),2),a=o[0],l=o[1],s=(0,b._)((0,T.useState)(""),2),c=s[0],u=s[1],d=(0,b._)((0,T.useState)(""),2),f=d[0],h=d[1],p=(0,T.useCallback)(function(e,n,t,i){if(r(!0),u(e.trim()),!t){h(i);return}l(!0),(0,H.tXK)(n,t).then(function(e){0===e.data.errCode?0==e.data.data.trim().length?m("总结失败"):h(e.data.data):e.data.errCode===em.cO.NOT_FOUND?m("总结失败，请等待搜索完成之后再尝试总结功能"):m("总结失败:"+e.data.errMsg)}).catch(function(e){m("总结失败")}).finally(function(){l(!1)}),(0,R.dW)(R.Gy.SEARCH_GET_SUMMARY,{dbResultId:n,linkId:t})},[m]),v=(0,b._)((0,T.useState)(i),2),x=v[0],g=v[1],m=(0,T.useCallback)(function(e){(0,Z.y)(e,{variant:"error",autoHideDuration:2e3}),r(!1)},[]),k=(0,T.useCallback)(function(){r(!1)},[]);(0,T.useEffect)(function(){x==i||i||e.afterClose(),g(i)},[i]);var C=(0,T.useRef)(0),w=(0,T.useRef)(0),y=(0,T.useRef)(!1),j=(0,b._)((0,T.useState)(0),2),S=j[0],E=j[1],L=(0,b._)((0,T.useState)(0),2),I=L[0],M=L[1],N=(0,T.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),C.current=e.pageX-S,w.current=e.pageY-I,y.current=!0},[S,I]),A=(0,T.useCallback)(function(e){y.current&&(E(e.pageX-C.current),M(e.pageY-w.current))},[]);(0,T.useEffect)(function(){E(0),M(0)},[i]);var D=(0,T.useCallback)(function(e){y.current=!1},[]);return(0,T.useEffect)(function(){return document.addEventListener("mousemove",A),document.addEventListener("mouseup",D),function(){document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",D)}},[]),i?(0,ek.createPortal)((0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(O.Z,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1001},onClick:k}),(0,_.jsxs)(F.Z,{onClick:function(e){e.stopPropagation()},className:"answerSearchContentPopover",sx:{width:"".concat(610,"px"),height:"".concat(270,"px"),minHeight:"50px",position:"fixed",backgroundColor:"var(--gray)",borderRadius:"8px",boxShadow:"0 2px 6px 0 rgba(0,0,0,.18)",zIndex:100001,paddingBottom:"25px",overflow:"hidden",display:i?"flex":"none"},style:{top:"calc(50% - 135px + ".concat(I,"px)"),left:"calc(50% - 305px + ".concat(S,"px)")},children:[(0,_.jsxs)(F.Z,{onMouseDown:N,spacing:.8,direction:"row",sx:{fontSize:"14px",padding:"10px 18px 0 18px",cursor:"grab",height:"40px",position:"sticky",top:0,left:0,backgroundColor:"var(--gray)",zIndex:200},alignItems:"center",children:[(0,_.jsx)(Y,{}),(0,_.jsx)(O.Z,{sx:{fontWeight:"bold"},children:"总结"}),(0,_.jsx)(eC.K,{show:!a,children:(0,_.jsx)(V.AddToSubjectButton,{title:"".concat(c,"-总结"),text:f,link:{},addText:!0})}),(0,_.jsx)(O.Z,{sx:{flex:1}}),(0,_.jsx)(W.Z,{onClick:k,children:(0,_.jsx)(eT.Z,{})})]}),(0,_.jsx)(O.Z,{sx:{padding:"0 18px",overflowY:"auto",flex:1},children:a?(0,_.jsx)(eQ,{}):(0,_.jsx)(O.Z,{sx:{fontWeight:400,lineHeight:"22px",color:"black"},children:(0,_.jsx)(V.AbstractMarkdown,{content:f})})})]})]}),document.body):(0,_.jsx)(_.Fragment,{})}));function eQ(){return(0,_.jsxs)(F.Z,{sx:{width:"100%"},spacing:2,children:[(0,_.jsx)(A.Z,{width:"100%"}),(0,_.jsx)(A.Z,{width:"100%"}),(0,_.jsx)(A.Z,{width:"100%"}),(0,_.jsx)(A.Z,{width:"100%"}),(0,_.jsx)(A.Z,{width:"100%"}),(0,_.jsx)(A.Z,{width:"100%"}),(0,_.jsx)(A.Z,{width:"60%"})]})}function e$(e){var n=(0,S.IA)(e.type);return"dark"===e.resolvedTheme&&"LIB"===e.type&&(n="#FFFFFF"),(0,_.jsx)(eZ.Z,{style:{color:n,border:"1px solid ".concat(n)},sx:(0,R.Vc)({cursor:"pointer",marginRight:"4px",borderRadius:"4px",fontSize:"13px",fontWeight:"normal",width:"90px",itemsAlign:"center",padding:"2px 8px",":hover":{backgroundColor:"dark"===e.resolvedTheme?"#2b3c4e":"#FFFFFF"}},e.sx),children:e.type})}},10301:function(e,n,t){"use strict";t.r(n),t.d(n,{Content:function(){return e5},Markdown:function(){return eW},MarkdownContent:function(){return ez},Mermaid:function(){return eD},PreCode:function(){return eP},ReferenceNum:function(){return e3},SelectNoneText:function(){return ne},_Content:function(){return eQ},_ReferenceNum:function(){return e2},getAllSelectContentHighlightElement:function(){return eJ},getSelectContentHighlightElement:function(){return e$},makeRefNodeSelectTextRange:function(){return eV}});var i,r,o,a,l,s,c=t(2403),u=t(12249),d=t(5194),f=t(1780),h=t(46796),p=t(50059),v=t(85735),x=t(98158),g=t(5853),m=t(57437),k=t(2265);t(2446);var C=t(89574),w=t(87928),b=t(79778),y=t(63791),j=t(20929),_=t(7870),S=t(60252),E=t(10638),T=t(28816),L=t(55833),I=t(99305),H=t(26058),M=t(19643),Z=t(35389),R=t(78693),N=t(43180),O=t(54887),A=t(47812),D=t(48359),B=t.n(D),P=t(36760),F=t.n(P),z=t(25922),W=t(36017),U=t(16724),V=t(64654),q=t(74634),G=t(79943),X=t(79817),K=t(39207),Y=t(54632),Q=t(28902),$=t(94746);function J(){return(J=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var ee=function(e){return $.createElement("svg",J({xmlns:"http://www.w3.org/2000/svg",width:13,height:15,fill:"none",viewBox:"0 0 13 15"},e),o||(o=$.createElement("path",{fill:"#fff",d:"M11.792 15H1.208a1.23 1.23 0 0 1-.855-.349A1.17 1.17 0 0 1 0 13.814V1.186C0 .533.542 0 1.208 0h7.064v4.038c0 .638.53 1.154 1.182 1.154H13v8.622c0 .653-.542 1.186-1.208 1.186m-1.746-8.076H2.954a.6.6 0 0 0-.417.168.57.57 0 0 0 0 .816c.11.108.26.168.417.168h7.09a.6.6 0 0 0 .396-.18.57.57 0 0 0 0-.791.6.6 0 0 0-.394-.181m0 2.306H2.954a.6.6 0 0 0-.418.17.57.57 0 0 0 0 .815c.111.108.262.17.418.17h7.09a.6.6 0 0 0 .402-.178.57.57 0 0 0 .001-.799.6.6 0 0 0-.401-.178m0 2.308H2.954a.6.6 0 0 0-.417.169.57.57 0 0 0 0 .815c.11.108.26.17.417.17h7.09a.6.6 0 0 0 .396-.181.57.57 0 0 0 0-.792.6.6 0 0 0-.394-.18m-.592-8.076V.578l2.954 3.461h-2.363a.58.58 0 0 1-.424-.163.56.56 0 0 1-.167-.414"})))};function en(){return(en=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var et=function(e){return $.createElement("svg",en({xmlns:"http://www.w3.org/2000/svg",width:7,height:7,fill:"none",viewBox:"0 0 7 7"},e),a||(a=$.createElement("path",{fill:"#E922D9",d:"M5.833 0A1.167 1.167 0 0 1 7 1.167v4.666A1.167 1.167 0 0 1 5.833 7H1.167A1.167 1.167 0 0 1 0 5.833V1.167A1.167 1.167 0 0 1 1.167 0zm0 .583H1.167a.583.583 0 0 0-.582.54l-.002.044v4.666a.583.583 0 0 0 .54.582l.044.002h4.666a.583.583 0 0 0 .582-.54l.002-.044V1.167a.583.583 0 0 0-.54-.582zm-3.162 1.25q.12 0 .23.047l.053.027 1.95 1.083a.583.583 0 0 1 .046.991l-.046.029-1.95 1.083a.583.583 0 0 1-.864-.45l-.003-.06V2.417a.583.583 0 0 1 .583-.583m0 .583v2.168L4.62 3.5z"})))};function ei(){return(ei=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var er=function(e){return $.createElement("svg",ei({xmlns:"http://www.w3.org/2000/svg",width:10,height:9,fill:"none",viewBox:"0 0 10 9"},e),l||(l=$.createElement("path",{fill:"#EB47BA",d:"M.5.375H.49q-.018 0-.036.002za.53.53 0 0 0-.307.096.5.5 0 0 0-.083.076L.106.55l-.01.012-.022.03L.106.55A.44.44 0 0 0 0 .833v7.349l.001.022L0 8.167c0 .102.038.201.106.282l.004.005a.5.5 0 0 0 .174.126q.102.045.216.045h.016l.025-.001-.041.001c.112 0 .22-.034.308-.097L5.93 4.859a.5.5 0 0 0 .14-.16.43.43 0 0 0-.001-.4.5.5 0 0 0-.141-.16l-.308-.22L.808.472.794.463.763.443l.045.03A.53.53 0 0 0 .51.374zm7 .458a.52.52 0 0 0-.354.135.44.44 0 0 0-.146.324v6.416a.44.44 0 0 0 .146.324c.094.086.221.135.354.135s.26-.049.354-.135A.44.44 0 0 0 8 7.708V1.292a.44.44 0 0 0-.146-.324A.52.52 0 0 0 7.5.833m-6.5.94L4.808 4.5 1 7.227zM9.066.968A.52.52 0 0 1 9.42.833c.133 0 .26.049.354.135a.44.44 0 0 1 .146.324v6.416a.44.44 0 0 1-.147.324.52.52 0 0 1-.353.135.52.52 0 0 1-.354-.135.44.44 0 0 1-.146-.324V1.292a.44.44 0 0 1 .146-.324"})))},eo=t(68791),ea=t(13988),el=t(40045),es=t(35046),ec=t(64798),eu=t.n(ec),ed=t(3864),ef=t(89038),eh=t(25075),ep=t(45008),ev=t(35108),ex=t(59832),eg=t(17162),em=t(16210),ek=t(28452),eC=t.n(ek),ew=t(26018),eb=t(36331),ey=t(41628),ej=t(36570),e_=t(39293),eS=t(20144),eE=t(11741),eT=t(96398);function eL(){var e=(0,ep._)(["\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n    min-width: 0;\n\n    .","."," > & {\n        color: #1570Ef;\n    }\n"]);return eL=function(){return e},e}var eI=[{label:"默认折叠",value:A.iR.DEFAULT_COLLAPSE},{label:"开始回答后折叠",value:A.iR.COLLAPSE_ON_ANSWERING},{label:"默认显示",value:A.iR.KEEP_OPEN}],eH=(0,k.memo)((0,k.forwardRef)(function(e,n){var t=e.finished,i=e.text,r=e.links,o=e.isH5,a=(0,p._)((0,k.useState)(!e.showOption),2),l=a[0],s=a[1],c=(0,k.useRef)(null),d=(0,p._)((0,k.useState)(!1),2),f=d[0],h=d[1],v=(0,k.useRef)(null),x=(0,k.useRef)(null),g=(0,p._)((0,k.useState)(A.iR.DEFAULT_COLLAPSE),2),C=g[0],w=g[1],b=(0,p._)((0,k.useState)(!1),2),y=b[0],j=b[1];(0,k.useImperativeHandle)(n,function(){return{setOpen:s,getMarkdownNode:function(){return x.current}}}),(0,k.useEffect)(function(){e.onVisibleChange(l)},[l]),(0,k.useLayoutEffect)(function(){var n=ej.ZP.thinkingDisplayMode.get();w(n),n!==A.iR.DEFAULT_COLLAPSE&&e.showOption&&s(!0),j(!0)},[e.showOption]),(0,N.bQ)({anchor:function(){return c.current},popover:function(){var e;return null===(e=v.current)||void 0===e?void 0:e.nodeRef.current}},f,function(){h(!1)}),(0,k.useEffect)(function(){t&&e.autoClose&&(C===A.iR.COLLAPSE_ON_ANSWERING||!e.showOption)&&s(!1)},[t,y,C,e.showOption]);var _=(0,k.useCallback)(function(n){n===A.iR.DEFAULT_COLLAPSE?s(!1):n===A.iR.KEEP_OPEN?s(!0):e.finished||s(!0),w(n),ej.ZP.thinkingDisplayMode.set(n)},[e.finished]),S=(0,k.useMemo)(function(){return(0,m.jsxs)(m.Fragment,{children:["    ",e.showOption&&(0,m.jsx)(N.ZP,{isAutoUpdate:!0,anchor:c.current,open:f,children:(0,m.jsx)(ev.Z,{sx:{fontSize:"14px"},children:eI.map(function(e,n){var t=e.value===C;return(0,m.jsxs)(eE.Z,{className:F()(e_.M.ListItem,(0,u._)({},e_.M.Selected,t)),onClick:function(){_(e.value)},children:[(0,m.jsx)(eM,{className:"meta-selector-option--label",children:e.label}),(0,m.jsx)(e_.Z,{className:"meta-selector-option--suffix",sx:{pl:1,ml:"auto",width:20,height:20},children:t&&(0,m.jsx)(eS.Z,{})})]},n)})})})]})},[f,C]);return(0,m.jsxs)(m.Fragment,{children:[y&&(0,m.jsxs)(R.Z,{children:[(0,m.jsxs)(M.Z,{direction:"row",alignItems:"center",sx:{marginBottom:"16px"},children:[e.showOption&&(0,m.jsx)(eb.Z,{onClick:function(){h(!f)},ref:c,checked:f,sx:{marginLeft:"-20px !important",width:"20px",minWidth:"unset",padding:0,color:"var(--black)"},children:(0,m.jsx)(ey.Z,{})}),(0,m.jsx)(R.Z,{sx:{flexShrink:0,marginBottom:"0 !important"},className:F()(eC().title,(0,u._)({},eC().finished,t),(0,u._)({},eC().collapse,!l)),onClick:function(){s(!l)},children:e.title||"思考过程"}),!e.hideButton&&(0,m.jsx)(ex.Z,{sx:{color:"#9DA7B6"},className:F()("collapseItemArrow",l?"":"active"),onClick:function(){s(!l)},children:(0,m.jsx)(ew.Z,{})}),e.answerFinished&&(0,m.jsx)(M.Z,{sx:{marginLeft:"20px"},children:(0,m.jsx)(eT.B,{sessionId:e.sessionId,resultId:e.resultId})})]}),(0,m.jsx)(eg.Z,{in:l,children:(0,m.jsx)(R.Z,{sx:{borderLeft:"solid 2px var(--border-color2)",paddingLeft:"10px",marginBottom:"12px"},className:eC().content,children:(0,m.jsx)(R.Z,{className:"markdown-body",ref:x,children:(0,m.jsx)(ez,{isFinished:t,engineType:e.engineType,isH5:o,answerLinkNumHighlights:e.answerLinkNumHighlights,searchResultId:e.resultId,content:i,links:r})})})})]}),S]})})),eM=(0,em.ZP)(e_.Z)(eL(),e_.M.ListItem,e_.M.Selected),eZ=t(25232),eR=t(92498),eN=[],eO=function(e){eN.push(e)},eA=(i=(0,c._)(function(){var e;return(0,g.Jh)(this,function(n){switch(n.label){case 0:if(!(eN.length>0)||!(e=eN.shift()))return[3,2];return[4,e()];case 1:n.sent(),n.label=2;case 2:return setTimeout(eA,50),[2]}})}),function(){return i.apply(this,arguments)});function eD(e){var n=(0,k.useRef)(null),t=(0,p._)((0,k.useState)(!1),2),i=t[0],r=t[1];return(0,k.useEffect)(function(){if(e.code&&n.current){var t;eO((t=(0,c._)(function(){return(0,g.Jh)(this,function(e){return r(!0),[2]})}),function(){return t.apply(this,arguments)}))}},[e.code]),(0,k.useEffect)(function(){i&&S.N.run({nodes:[n.current]}).then(function(){e.onLoaded&&e.onLoaded()}).catch(function(n){e.onError()})},[i]),(0,m.jsx)("div",{className:"no-dark",style:{cursor:"pointer",overflow:"auto"},ref:n,onClick:function(){return e.onClick?e.onClick():function(){var e,t=null===(e=n.current)||void 0===e?void 0:e.querySelector("svg");if(t){var i=new Blob([new XMLSerializer().serializeToString(t)],{type:"image/svg+xml"}),r=URL.createObjectURL(i),o=window.open(r);o&&(o.onload=function(){return URL.revokeObjectURL(r)})}}()},children:i&&e.code})}eA();var eB=["bash","c","cpp","javascript","lua","python","ruby","shell","java","sh"];function eP(e){var n=(0,k.useRef)(null),t=(0,p._)((0,k.useState)(""),2),i=t[0],r=t[1],o=(0,p._)((0,k.useState)(""),2),a=o[0],l=o[1],s=(0,p._)((0,k.useState)(""),2),c=s[0],u=s[1],d=(0,p._)((0,k.useState)(!1),2),f=d[0],h=d[1],v=(0,p._)((0,k.useState)(!1),2),x=v[0],g=v[1],C=(0,p._)((0,k.useState)(!1),2),w=C[0],b=C[1];(0,k.useLayoutEffect)(function(){if(n.current){var e,t=null===(e=n.current.querySelector("code"))||void 0===e?void 0:e.className.match(/language-([^\s]+)/);t&&r(t[1])}},[e.children]),(0,k.useLayoutEffect)(function(){-1!==eB.indexOf(i)&&b(!0)},[i]);var y=(0,k.useCallback)(function(){var e;x||(g(!0),h(!1),(0,K.QrE)({sandbox:i,command:"run",files:{"":null===(e=n.current)||void 0===e?void 0:e.innerText},version:""}).then(function(e){e.data.data.stdout?(l(e.data.data.stdout),u("")):(u(e.data.data.stderr),l(""))}).finally(function(){g(!1),b(!1)}))},[i,x]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("pre",{ref:n,style:{position:"relative"},contentEditable:f,children:[(0,m.jsx)("span",{className:"copy-code-button",onClick:function(){if(n.current){var e=n.current.innerText;(0,_.vQ)(e),(0,V.yv)("复制成功",{variant:"success"})}}}),e.children]}),(0,m.jsx)(M.Z,{direction:"row",sx:{marginBottom:"16px"},spacing:2,children:w&&!e.inShareImg&&(0,m.jsx)(Y.Z,{className:"code-run-button",disabled:!e.finished,onClick:y,variant:"outlined",sx:{color:"var(--black3)",borderRadius:0,padding:"10px 30px",borderColor:"var(--card-border-color)","&:hover":{borderColor:"var(--card-border-color)"}},children:x?(0,m.jsx)(M.Z,{sx:{width:"51px",height:"21px",alignItems:"center",justifyContent:"center"},children:(0,m.jsx)(Z.Z,{size:"15px",sx:{color:"gray"},thickness:2})}):(0,m.jsxs)(M.Z,{direction:"row",spacing:1,alignItems:"center",className:"range-offset-ignore",children:[(0,m.jsx)("svg",{width:"14",height:"18",viewBox:"0 0 14 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,m.jsx)("path",{d:"M1.16675 3.15797C1.16675 2.34866 1.16675 1.94401 1.33549 1.72095C1.48249 1.52663 1.70718 1.40638 1.95041 1.39186C2.22961 1.37519 2.5663 1.59965 3.23968 2.04857L12.0026 7.89054C12.5591 8.26148 12.8373 8.44695 12.9342 8.68072C13.019 8.8851 13.019 9.11479 12.9342 9.31917C12.8373 9.55294 12.5591 9.73841 12.0026 10.1093L3.23968 15.9513C2.5663 16.4002 2.22961 16.6247 1.95041 16.608C1.70718 16.5935 1.48249 16.4733 1.33549 16.2789C1.16675 16.0559 1.16675 15.6512 1.16675 14.8419V3.15797Z",stroke:"currentColor",strokeWidth:"1.66667",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,m.jsx)(R.Z,{children:"运行"})]})})}),a&&(0,m.jsxs)(R.Z,{className:"terminal",children:[(0,m.jsx)(R.Z,{className:"terminal-title",children:"输出结果："}),(0,m.jsx)(R.Z,{className:"terminal-content",children:a})]}),c&&(0,m.jsxs)(R.Z,{className:"terminal std-error",children:[(0,m.jsx)(R.Z,{className:"terminal-title",children:"错误信息："}),(0,m.jsx)(R.Z,{className:"terminal-content",children:c})]})]})}function eF(e){e.onParagraphMounted;var n=(0,h._)(e,["onParagraphMounted"]),t=(0,k.useRef)(null);return(0,k.useEffect)(function(){var n;null===(n=e.onParagraphLoaded)||void 0===n||n.call(e)},[]),(0,m.jsx)("p",(0,f._)((0,d._)({},n),{ref:t}))}var ez=k.memo(function(e){var n=e.content.replace(/([^\\])?~/g,"$1\\~"),t=(0,q.F)(),i=(0,G.WS)(),r=(0,k.useCallback)(function(n){var r,o,a=null===(o=e.imgMetas)||void 0===o?void 0:null===(r=o.current)||void 0===r?void 0:r.find(function(e){return e.thumbnailUrl.replace(/metaso-static\.oss-cn-beijing\.aliyuncs\.com/g,"oss.metaso.cn")===n});a&&(t?(0,Q.L)({index:0,images:[a],h5:!0,router:i,onSubmit:e.onImgSubmit}):(0,Q.Nn)(n,a,e.onImgSubmit))},[e.onImgSubmit]),o=L.Un.useBridge("LinkBoxAPI"),a=ef.x.useAPI("pdfContainer"),l=L.Un.useBridge("singletonDrawer"),s=function(n,t,r){var o,s,c=null===(s=e.imgMetas)||void 0===s?void 0:null===(o=s.current)||void 0===o?void 0:o.find(function(e){return e.thumbnailUrl.replace(/metaso-static\.oss-cn-beijing\.aliyuncs\.com/g,"oss.metaso.cn")===t});if(c){var u=JSON.parse(JSON.stringify(e.links[0]));c=JSON.parse(JSON.stringify(c)),u.total_page=c.total_page,u.page=c.page,u.file_meta=c.file_meta,u.file_meta.exist=!0,e.engineType==A.rG.KNOWLEDGE?(u.file_meta.internalFile=!0,u.link="/api/file/".concat(c.file_meta._id,"/preview"),u.file_meta.file_path="document/".concat(c.file_meta._id,".pdf"),u.file_meta.downloadUrl="/api/file/".concat(c.file_meta._id,"/stream-download"),u.file_meta.url="/api/file/".concat(c.file_meta._id,"/preview")):(u.file_meta.internalFile=!1,u.link=c.origin_url,u.file_meta.file_path=c.file_meta.file_path,u.file_meta.downloadUrl="https://metaso-static.oss-accelerate.aliyuncs.com/metaso/document/"+c.file_meta._id+".pdf",u.file_meta.url=c.origin_url,u.title=c.title||""),u.file_meta.type=c.file_type,u.display=c.display,(0,W.openReferenceDrawer)({router:i,api:l.current,isH5:e.isH5,link:u,links:e.links,engineType:e.engineType,sourceIndex:c.display.refer_id,linkIndex:-999999,pdfContainerAPI:a.current,gid:e.gid,openInNewTab:e.referenceOpenNewWindow,clickImage:!0})}};return(0,m.jsx)(eo.s,{remarkPlugins:[C.Z,y.Z,w.Z],rehypePlugins:[b.Z,[j.Z,{detect:!1,ignoreMissing:!0}],E.Z],components:{pre:function(n){return n.children.map(function(t,i){var r=t.props,o=(r.node,r.inline,r.className),a=r.children;return(null==o?void 0:o.includes("language-mermaid"))?(0,m.jsx)(eD,{code:String(a),onError:function(){}},i):(0,k.createElement)(eP,(0,f._)((0,d._)({},n),{key:i,finished:e.isFinished,inShareImg:e.inShareImg}))})},a:function(e){var n=e.href||"";return n=n.match(/^http(s)?:\/{2}/)?n:"https://".concat(n),(0,m.jsx)("a",(0,f._)((0,d._)({},e),{href:n,onClick:function(e){var t,i;((null===(t=(0,H.ZD)())||void 0===t?void 0:t.isMiniWebView)||(null===(i=(0,H.ZD)())||void 0===i?void 0:i.isAliApp))&&(e.preventDefault(),(0,_.vQ)(n,!0,e.currentTarget),(0,I.pv)())},target:"_blank"}))},span:function(n){var t;if((null===(t=n.className)||void 0===t?void 0:t.includes("reference-num"))&&e.links[parseInt(n.children)-1]){var i=parseInt(n.children);if(i<1||i>e.links.length)return(0,m.jsx)("span",(0,d._)({},n));try{var r=eK[parseInt(n["data-pages"])];return(0,m.jsx)(e3,{openInNewWindow:e.referenceOpenNewWindow,pages:r,index:i-1,gid:e.gid,rid:parseInt(n["data-key"]),from:e.from||ed.ik.Content,engineType:e.engineType,disableTooltip:!e.isFinished,isH5:e.isH5,num:e.links[i-1].display?e.links[i-1].display.refer_id:i,link:e.links[i-1],answerLinkNumHighlights:e.answerLinkNumHighlights,searchResultId:e.searchResultId,links:e.links})}catch(n){return(0,m.jsxs)("span",{children:["[[",e.links[i-1].display.refer_id,"]]"]})}}return(0,m.jsx)("span",(0,d._)({},n))},mt:function(n){if(A.El.VIDEOS==n.type){var t=JSON.parse(n.data),i=t.map(function(n){return e.links[n-1]}).filter(function(e){return null!=e});return 0==i.length&&e.videoMap&&e.videoMap.size>0&&(i=t.map(function(n){return e.videoMap.get(n)}).filter(function(e){return null!=e})),(0,m.jsx)(eh.cn,{links:i,isH5:e.isH5})}return(0,m.jsx)("span",{})},p:function(n,t){return(0,m.jsx)(eF,(0,f._)((0,d._)({},n),{onParagraphMounted:e.onParagraphMounted,onParagraphLoaded:e.onParagraphLoaded}))},img:function(n){var t,i,a=n.src;if(null==a?void 0:a.match(/\/file\/(\d+)\/figures/)){var l=new URL(a=(0,K.FGH)(a),location.origin),c=location.pathname;l.hostname!==location.hostname&&(l.hostname=location.hostname),!l.searchParams.has("sessionId")&&c.startsWith("/search")&&(l.searchParams.set("sessionId",c.replace("/search/","")),a=l.href)}var u=null===(i=e.imgMetas)||void 0===i?void 0:null===(t=i.current)||void 0===t?void 0:t.find(function(e){return e.thumbnailUrl.replace(/metaso-static\.oss-cn-beijing\.aliyuncs\.com/g,"oss.metaso.cn")===n.src});return(0,m.jsxs)(R.Z,{sx:{textAlign:"center","& img":{cursor:"pointer",marginTop:"14px"},position:"relative"},className:F()(B()["img-container"],"range-offset-ignore"),children:[(0,m.jsx)("img",(0,f._)((0,d._)({},n),{src:a,onLoad:function(){var e;return null===(e=o.current)||void 0===e?void 0:e.refresh()},onClick:function(t){u&&u.file_meta||e.engineType==A.rG.KNOWLEDGE?s(n,n.src,t):r(n.src)}})),n.alt&&(0,m.jsx)(R.Z,{sx:{fontSize:"12px",color:"var(--content-op-color)"},children:n.alt}),(u&&u.file_meta||e.engineType==A.rG.KNOWLEDGE)&&(0,m.jsxs)(R.Z,{className:B()["img-view-container"],onClick:function(e){s(n,n.src,e)},children:[(0,m.jsx)(ee,{}),(0,m.jsx)("span",{children:"查看"})]})]})}},skipHtml:!1,children:n})});function eW(e){var n,t=(0,k.useRef)(null),i=(0,k.useRef)(0),r=(0,k.useRef)(!!e.defaultShow);return(0,m.jsx)("div",{className:"markdown-body",style:{fontSize:"".concat(null!==(n=e.fontSize)&&void 0!==n?n:14,"px"),height:!r.current&&i.current>0?i.current:"auto"},ref:t,onContextMenu:e.onContextMenu,onDoubleClickCapture:e.onDoubleClickCapture,children:r.current&&(e.loading?(0,m.jsx)(T.Z,{}):(0,m.jsx)(ez,{gid:e.gid,isFinished:!!e.isFinished,isH5:e.isH5,content:e.content}))})}(r=s||(s={}))[r.TEXT=0]="TEXT",r[r.REFERENCE=1]="REFERENCE",r[r.CODE_BLOCK=2]="CODE_BLOCK",r[r.INLINE_MATH=3]="INLINE_MATH",r[r.MATH_BLOCK=4]="MATH_BLOCK",r[r.GENERATE_TABLE=5]="GENERATE_TABLE";var eU=new Set([".","。","!","！","?","？",";","；"]);function eV(e,n){var t=e.querySelectorAll(".reference-num[data-node-id]"),i=document.createRange();i.setStart(e.firstChild,0);for(var r=0;r<t.length;r++){var o=t[r];if(o.getAttribute("data-node-id")===n){i.setEndBefore(o);for(var a=r-1;a>=0;){var l=eq(t[a]);if(null==l)break;if(i.setStart(l,0),0==i.toString().trim().length)i.setEndBefore(t[a]);else break;a--}0==i.toString().trim().length&&i.setStart(e.firstChild,0);var s=i.toString().trim(),c=!1;if(s.match(/[，。].{0,2}$/)&&(c=!0),s.length<2&&(c=!0),c){i.setStart(o,0),r+1<t.length?i.setEndBefore(t[r+1]):i.setEnd(e.lastChild,(null===(f=e.lastChild.textContent)||void 0===f?void 0:f.length)||0);var u=eq(o);u&&i.setStart(u,0);var d=i.toString().trim();if(d.length<2)for(var f,h,p=r+1;p<t.length&&(p+1<t.length?i.setEndBefore(t[p+1]):i.setEnd(e.lastChild,(null===(h=e.lastChild.textContent)||void 0===h?void 0:h.length)||0),!((d=i.toString().trim()).length>=2));)p++}else if(s.length<2){for(var v=a-1;v>=0;){var x=eq(t[v]);if(x&&(i.setStart(x,0),i.toString().trim().length>=2))break;v--}i.toString().trim().length<2&&i.setStart(e.firstChild,0)}break}}for(var g=i.toString(),m=0;m<g.length;)if(eU.has(g.charAt(m)))m++;else break;if(m>0){var k=i.startContainer.textContent||"";i.startOffset+m<=k.length?i.setStart(i.startContainer,i.startOffset+m):function(e,n){for(var t=e.startContainer,i=e.startOffset;n>0;){if(t.nodeType===Node.TEXT_NODE){var r=(t.textContent||"").length;if(i+n<=r){e.setStart(t,i+n);return}n-=r-i,i=r}var o=eq(t);if(o)t=o,i=0;else break}}(i,m)}return i}function eq(e){var n=e.parentNode,t=null;if(n){var i=e.nextSibling;if(i&&i.nodeType===Node.TEXT_NODE)t=i;else for(i=n.nextSibling;i;){if(i.nodeType===Node.TEXT_NODE){t=i;break}i=(n=i).nextSibling}}return t}var eG=function(e,n,t,i,r,o,a){var l=0,s=e.substring(n.length),c=n.replace(/metaso-static\.oss-cn-beijing\.aliyuncs\.com/g,"oss.metaso.cn").split(RegExp("(^```|\\n\\s*?```)|(`(\\[\\[\\d+]])+`)|(\\[\\[\\d+]])|(\\[\\[表：.+]])|(\\$\\$|\\\\\\[|\\\\\\]|\\\\\\(|\\\\\\)|\\$)","gi")).filter(function(e){return e}),u=void 0,d=!1,f=c.map(function(e,n){if(e.trim().startsWith("```")&&(d=!d),d)return{type:0,text:e};if(e.match(/^\[\[(\d+)]]/gi)){if(r===A.Qo.Clawer)return{type:0,text:""};var t=parseInt(e.match(/\[\[(\d+)]]/)[1])-1;return t<o.length&&t>-1?{type:1,reference:{link:o[t],index:t}}:{type:0,text:'<span data-type="index-error">'.concat(e.substring(1,e.length-1),"</span>")}}return e.match(/\[\[表：.+]]/)?{type:5,headers:e.match(/\[\[表：(.+)]]/)[1].split("、")}:e.match(/\$\$|\\\[|\\\(|\\\)|\\\]|\$/)?(l++,{type:4,text:e}):{type:0,text:e}}),h=[],p=function(e){var n=e.map(function(e){return e.reference});(0,ed._p)(n,function(e){eK.push(e.pages),eX++;var n='<span data-key="'.concat(i,'" class="reference-num" data-pages="').concat(JSON.stringify(e.pages).page,'">').concat(e.num+1,"</span>");h.push(n),i===a&&(u=i),i++})},v=[];f.forEach(function(e,n){0===e.type||4===e.type?(v.length>0&&(p(v),v=[]),h.push(e.text)):1===e.type?v.push(e):5===e.type&&h.push('\n<div class="generate-table-btn" data-headers=\''.concat(JSON.stringify(e.headers),"'></div>\n"))}),v.length>0&&(p(v),v=[]);var x=h.join("");return s&&"$$"==s.trim()||d||l%2!=0?{content:x+s,activeIndex:u,rIndex:i}:{content:x+(s?'<span class="fade-in-05" data-key="'.concat(n.length,'">').concat(s,"</span>"):""),activeIndex:u,rIndex:i}},eX=0,eK=[],eY=k.createContext(null);function eQ(e){var n=(0,k.useRef)(null),t=(0,k.useRef)(void 0),i=(0,k.useRef)(null),r=(0,p._)((0,k.useState)(!1),2),o=r[0],a=r[1],l=(0,p._)((0,k.useState)([]),2),s=l[0],c=l[1],d=(0,p._)((0,k.useState)([]),2),f=d[0],h=d[1],x=(0,k.useRef)(null),g=(0,k.useRef)(!1),C=(0,k.useRef)(0),w=(0,k.useRef)(null),b=(0,p._)((0,k.useState)(""),2),y=b[0],j=b[1],S=(0,p._)((0,k.useState)(""),2),E=S[0],T=S[1],I=(0,k.useRef)(""),H=(0,k.useRef)(!0),M=(0,p._)((0,k.useState)(!0),2),Z=M[0],N=M[1],O=(0,k.useRef)(null),A=(0,p._)((0,k.useState)([]),2),D=A[0],P=A[1],z=(0,k.useRef)(null),W=L.Un.useBridge("LinkBoxAPI"),U=(0,p._)((0,k.useState)(!!e.text),2),V=U[0],q=U[1],G=(0,k.useCallback)(function(){a(!0)},[]);(0,k.useEffect)(function(){!V&&e.text&&q(!0)},[e.text,V]);var Y=(0,k.useRef)(0);(0,k.useEffect)(function(){var n=e.isH5&&e.referenceStartIndex?e.referenceStartIndex:0;if(e.thinkingText){if(H.current||V){clearTimeout(O.current);var i=eG(e.thinkingText,e.thinkingText,V,n,e.label,e.links,e.rid),r=i.content,o=i.activeIndex,a=i.rIndex;Y.current=a,void 0!==o&&(t.current=o),T(r),H.current=!1,O.current=null}else null===O.current&&(O.current=setTimeout(function(){var i=eG(e.thinkingText,e.thinkingText,V,n,e.label,e.links,e.rid),r=i.content,o=i.activeIndex,a=i.rIndex;Y.current=a,void 0!==o&&(t.current=o),T(r),O.current=null},500))}},[e.thinkingText,e.gid,e.rid,e.links,e.label,V]),(0,k.useEffect)(function(){if(e.text){var n=(e.isH5&&e.referenceStartIndex?e.referenceStartIndex:0)+Y.current;if(H.current||e.finished){clearTimeout(O.current);var i=eG(e.text,e.lastText,e.finished,n,e.label,e.links,e.rid),r=i.content,o=i.activeIndex;void 0!==o&&(t.current=o),I.current=r,j(I.current),H.current=!1,P(e.links)}else null===O.current&&(O.current=setTimeout(function(){var i=eG(e.text,e.lastText,e.finished,n,e.label,e.links,e.rid),r=i.content,o=i.activeIndex;void 0!==o&&(t.current=o),I.current=r,j(I.current),O.current=null,P(e.links)},500))}},[e.text,e.referenceStartIndex,e.lastText,e.finished,e.gid,e.rid,e.links,e.label]);var Q=(0,k.useCallback)(function(e){var i=g.current?0:500;if(void 0===e||void 0===t.current){c([]);return}g.current=!0,setTimeout(function(){if(void 0!==t.current&&n.current){var e=n.current.querySelector("span[data-index='".concat(t.current,"']")),i="",r=0,o=!0,a=!1,l=void 0;try{for(var s,u=e.parentNode.parentNode.childNodes[Symbol.iterator]();!(o=(s=u.next()).done)&&s.value!==(null==e?void 0:e.parentElement);o=!0)r++}catch(e){a=!0,l=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw l}}for(var d=!1,f=r;f>=0;f--){var h,p,v=e.parentNode.parentNode.childNodes.item(f);if(v.nodeType===Node.ELEMENT_NODE&&v.childNodes.item(0)&&v.childNodes.item(0).nodeType===Node.ELEMENT_NODE){if(v.childNodes.item(0).className.includes("Mui")){if(i)break}else{if(!i&&(null===(h=v.textContent)||void 0===h?void 0:h.match(/[，。]$/))){d=!0;break}i=v.textContent+i}}else if(v.textContent){if(!i&&(null===(p=v.textContent)||void 0===p?void 0:p.match(/[，。]$/))){d=!0;break}i=v.textContent+i}}if(d)for(var x=r;x<e.parentNode.parentNode.childNodes.length;x++){var g=e.parentNode.parentNode.childNodes.item(x);if(g.nodeType===Node.ELEMENT_NODE&&g.childNodes.item(0)&&g.childNodes.item(0).nodeType===Node.ELEMENT_NODE){if(g.childNodes.item(0).className.includes("Mui")){if(i)break}else i+=g.textContent}else g.textContent&&(i+=g.textContent)}(i=i.replace(/^[.,，。]/,""))&&c($((0,_.rx)(i,n.current)))}},i)},[]),$=(0,k.useCallback)(function(e,n){var t=[],r=i.current.getBoundingClientRect(),o=!0,a=!1,l=void 0;try{for(var s,c=e.getClientRects()[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var u=s.value;t.push({id:n,top:u.top-r.top,left:u.left-r.left,width:u.width,height:u.height})}}catch(e){a=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}return t},[]),J=(0,p._)((0,k.useState)(null),2),ee=J[0],en=J[1],et=(0,p._)((0,k.useState)([]),2),ei=et[0],er=et[1],eo=(0,k.useRef)(null),es=(0,p._)((0,k.useState)(e.extraBoxes||[]),2),ec=es[0],ed=es[1],ef=(0,p._)((0,k.useState)(""),2),eh=ef[0],ep=ef[1],ev=(0,k.useCallback)(function(){eR(eZ.current),ep(K.DOL)},[]),ex=(0,k.useRef)(null);(0,k.useEffect)(function(){if(!e.isH5){var n;null===(n=ex.current)||void 0===n||n.hideIfActiveNodeNotMe(ee)}},[ee,e.isH5]);var eg=eu()(ev,300),em=(0,k.useRef)(0);(0,k.useEffect)(function(){var e=n.current;if(e){var t=new ResizeObserver(function(e){var n=!0,t=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var a=r.value.contentRect.width;a!==em.current&&(eg(),em.current=a)}}catch(e){t=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(t)throw i}}});return t.observe(e),function(){t.unobserve(e)}}},[]);var ek=(0,k.useCallback)(function(e){ec.filter(function(n){return n.id===e.id}).length>0||ed(function(n){return(0,v._)(n).concat([e]).sort(function(e,n){return e.start-n.start})})},[ec]),eC=(0,k.useCallback)(function(e){ed(function(n){return n.filter(function(n){return n.id!==e})})},[]);(0,k.useEffect)(function(){h([]),setTimeout(function(){0!=ec.length&&o||h([]);var e=ec.map(function(e){return[e.start,e.end]}),n=(0,el.pl)(z.current,e);Z||(n=n.filter(function(e){var n,t,i;return e.startContainer!==(null===(n=w.current)||void 0===n?void 0:n.getMarkdownNode())&&!(null===(i=w.current)||void 0===i?void 0:null===(t=i.getMarkdownNode())||void 0===t?void 0:t.contains(e.startContainer))})),h(n.flatMap(function(e,n){return $(e,ec[n].id)}))},500)},[ec,$,o,eh,Z]),(0,k.useEffect)(function(){},[Z]);var ew=L.Un.useBridge("referenceDrawer"),eb=(0,p._)((0,k.useState)(!1),2),ey=eb[0],ej=eb[1],e_=(0,k.useRef)(null),eS=L.Un.useBridge("searchRightExtraKitsApi"),eE=(0,k.useCallback)(function(n,t){e_.current=setTimeout(function(){if(e.isH5){ew.current.openByNodeId(n);return}if((null===(o=eS.current)||void 0===o?void 0:o.isNotSourceTabAndPin())||t){var i,r,o,a;eN(n)?setTimeout(function(){var e;null===(e=W.current)||void 0===e||e.setActiveNode(n,t,!0)},400):null===(a=W.current)||void 0===a||a.setActiveNode(n,t,!0),ej(!0)}else null===(i=eS.current)||void 0===i||i.setSourceTabIfNeed(),null===(r=W.current)||void 0===r||r.setActiveNode(n,!1),eN(n)},100)},[e.isH5]),eT=(0,k.useCallback)(function(){e_.current&&clearTimeout(e_.current)},[]);(0,k.useEffect)(function(){var t=function(e,n){var t=i.current.getBoundingClientRect(),r=e.pageX,o=e.pageY,a=!0,l=!1,s=void 0;try{for(var c,u=f[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d,h=c.value,p=h.left+t.left,v=h.top+t.top,x=p<=r&&r<=p+h.width,g=v<=o&&o<=v+h.height;if(x&&g){eE(h.id,n);return}ey&&(null===(d=eB.current)||void 0===d||d.cancel(),ej(!1))}}catch(e){l=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw s}}eT()},r=function(e){t(e,!1)},o=function(e){if(ey){var n;null===(n=eB.current)||void 0===n||n.cancel(),ej(!1)}t(e,!0)},a=function(e){var n=e.changedTouches[0].clientX,t=e.changedTouches[0].clientY,i=!0,r=!1,o=void 0;try{for(var a,l=f[Symbol.iterator]();!(i=(a=l.next()).done);i=!0){var s=a.value,c=e$(s.id);if(!c)return;var u=c.getBoundingClientRect(),d=u.x,h=u.y,p=u.width,v=u.height;if(d<=n&&n<=d+p&&h<=t&&t<=h+v){eE(s.id);return}}}catch(e){r=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw o}}},l=n.current;return e.isH5?l.addEventListener("touchend",a):(l.addEventListener("mousemove",r),l.addEventListener("click",o)),function(){l&&(e.isH5?l.removeEventListener("touchend",a):(l.removeEventListener("mousemove",r),l.removeEventListener("click",o)))}},[f,e.isH5,ey]);var eL=(0,k.useCallback)(function(n){if(e.isH5)e.setH5ExtraBox(n);else{var t;null===(t=W.current)||void 0===t||t.addSelectContentHandleNode(n)}},[e.isH5,e.setH5ExtraBox,e.gid]),eI=(0,k.useCallback)(function(e){var t;return null===(t=n.current)||void 0===t?void 0:t.querySelector(".reference-num[data-node-id='".concat(e,"']"))},[]),eM=(0,k.useCallback)(function(e){en(e),eN(e)},[]);L.Un.useRegister("ContentAPI",{highlightLinkText:function(n,t){var i,r;(null===(r=w.current)||void 0===r?void 0:null===(i=r.getMarkdownNode())||void 0===i?void 0:i.querySelector(".reference-num[data-node-id='".concat(n,"']")))?(w.current.setOpen(!0),eR(n,t),setTimeout(function(){eR(n,t)},500)):eR(n,t),e.isH5&&!n&&eM("")},highlightTextByRid:function(e){t.current=e,Q(e)},getActiveHighlightAnchor:function(){return eo.current},clearHighlightText:function(){Q(void 0)},restoreSearchTool:function(n,t){e.isH5||ex.current.restoreSearchTool(n,t),eM(n.id)},removeSelectTextRange:function(e){eC(e)},refresh:eg,showThink:function(){var e;null===(e=w.current)||void 0===e||e.setOpen(!0)}},[Q,ee,eM,eC,e.isH5]);var eZ=(0,k.useRef)(null),eR=(0,k.useCallback)(function(e,n){if(!e){er([]);return}var t=eI(e);if(t){var i=function(e,n){var t=null,i=1/0,r=!0,o=!1,a=void 0;try{for(var l,s=n[Symbol.iterator]();!(r=(l=s.next()).done);r=!0){var c=l.value,u=e.closest(c);if(u){for(var d=0,f=e;f&&f!==u;)f=f.parentNode,d++;d<i&&(i=d,t=u)}}}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return t}(t,["p","td","li"]);if(i){var r=eV(i,e);er($(r,e)),en(e),n&&eO(r,t),eZ.current=e}}},[eI,$]),eN=function(e){try{var t=eJ(n.current,e),i=document.createRange();return i.setStartBefore(t[0]),i.setEndAfter(t[t.length-1]),eO(i,n.current)}catch(e){}},eO=(0,k.useCallback)(function(e,n){try{var t=e.getBoundingClientRect();if(0===t.y&&0===t.x)return;if(t.y<61){var i=(0,_.Bo)(n);if(i)return(0,_.GZ)(i,i.scrollTop+t.y-61-10,300),!0}else if(t.y+t.height+20>window.innerHeight){var r=(0,_.Bo)(n);if(r)return(0,_.GZ)(r,r.scrollTop+Math.min(t.y+t.height+20-window.innerHeight/2,t.y-61,300)),!0}}catch(e){return!1}},[]),eA=(0,k.useRef)(void 0),eD=(0,k.useCallback)(function(){Q(eA.current),eR(eZ.current)},[]);(0,k.useEffect)(function(){if(-1===e.rid||void 0===e.rid){c([]),g.current=!1,eg();return}return C.current=i.current.clientWidth,Q(e.rid),eA.current=e.rid,eg(),window.addEventListener("resize",eD),function(){window.removeEventListener("resize",eD)}},[e.rid]),(0,k.useEffect)(function(){var e,n;!Z&&(null===(n=w.current)||void 0===n?void 0:null===(e=n.getMarkdownNode())||void 0===e?void 0:e.querySelector(".reference-num[data-node-id='".concat(eZ.current,"']")))?eM(""):eg()},[Z]);var eB=L.vs.useBridge("tooltip"),eP=(0,k.useMemo)(function(){return(0,m.jsxs)(R.Z,{sx:{position:"absolute",left:0,top:0,right:0,bottom:0,pointerEvents:"none",zIndex:0},ref:i,id:"markdown-highlight-content-"+e.gid,children:[s.map(function(e,n){return(0,m.jsx)(R.Z,{ref:0===n?x:null,sx:{position:"absolute",top:e.top+"px",left:e.left+"px",width:e.width+"px",height:e.height+"px",backgroundColor:"var(--highlight-bg)"}},n)}),f.map(function(e,n){return(0,m.jsx)(R.Z,{ref:0===n?x:null,id:"select-content-highlight-rect-".concat(e.id),className:B()["select-highlight"],sx:{cursor:"pointer",position:"absolute",top:e.top+"px",left:e.left+"px",width:e.width+"px",height:e.height+"px",backgroundColor:ee===e.id?"var(--active-bg-color)":"var(--bg-color)",borderBottom:"1px solid ".concat(ee===e.id?"var(--active-border-color)":"var(--border-color)"),zIndex:ee===e.id?1:0}},n)}),ei.map(function(e,n){return(0,m.jsx)(R.Z,{ref:0===n?eo:null,className:F()((0,u._)({},B()["highlight-text"],ee===e.id)),sx:{position:"absolute",top:e.top+"px",left:e.left+"px",width:e.width+"px",height:e.height+"px"}},n)})]})},[s,f,ei,ee]),eF=(0,k.useMemo)(function(){return(0,m.jsx)(m.Fragment,{children:E&&(0,m.jsx)(eH,{title:e.thinkingTitle,sessionId:e.sessionId,resultId:e.searchResultId,ref:w,onVisibleChange:N,isH5:e.isH5,autoClose:!e.isH5,showOption:!e.isH5,finished:V,answerFinished:e.finished,text:E,links:e.links,answerLinkNumHighlights:e.answerLinkNumHighlights})})},[e.gid,e.thinkingTitle,e.engineType,E,V,D,e.isH5,e.finished,e.answerLinkNumHighlights,e.searchResultId]),eW=(0,k.useMemo)(function(){return(0,m.jsx)(R.Z,{className:"markdown-body",children:(0,m.jsx)(ez,{from:e.from,gid:e.gid,engineType:e.engineType,content:y,links:e.links,isH5:e.isH5,inShareImg:e.inShareImg,isFinished:e.finished,imgMetas:e.imgMetas,onImgSubmit:e.onImgSubmit,onParagraphLoaded:G,onParagraphMounted:e.onParagraphMounted,referenceOpenNewWindow:e.referenceOpenNewWindow,onGenerateTable:e.onGenerateTable,tableData:e.tableData,answerLinkNumHighlights:e.answerLinkNumHighlights,searchResultId:e.searchResultId,videoMap:e.videoMap})})},[e.gid,e.engineType,V,E,y,D,e.isH5,e.finished,e.referenceOpenNewWindow,e.answerLinkNumHighlights]),eU=(0,X.k)().fontSizeStyles;return(0,m.jsxs)(R.Z,{sx:(0,_.KI)({fontSize:eU.searchResult},2),ref:n,children:[(0,m.jsxs)(eY.Provider,{value:ee,children:[eP,(0,m.jsxs)(R.Z,{zIndex:1,position:"relative",ref:z,children:[eF,e.beforeAnswerNode,eW]})]}),!e.needNotSearchTool&&e.finished&&(0,m.jsx)(ea.ji,{ref:ex,addHighlightRange:ek,removePermanentHighlightRange:eC,selectContentHandleResultChange:eL,isH5:e.isH5,textContainer:z,resultId:e.gid})]})}var e$=function(e){return document.getElementById("select-content-highlight-rect-".concat(e))},eJ=function(e,n){return e.querySelectorAll("[id='select-content-highlight-rect-".concat(n,"']"))},e0=new Map,e1=0,e5=k.memo(eQ);function e2(e){var n,t,i,r={id:e.gid,index:e.index},o=L.HK.useAPI("singletonDrawer"),a=(0,q.F)(),l=e.num,s=e.link,c=(e.onTooltipHoverChange,e.isH5),u=e.targetId,d=(0,p._)((0,k.useState)(null),2),f=d[0],h=d[1],v=ef.x.useAPI("pdfContainer"),g=(0,p._)((0,k.useState)(!1),2),C=g[0],w=g[1],b=e.link.file_meta?(0,A.fv)(e.link.file_meta.type):void 0;(0,p._)((0,N.bQ)({anchor:f},C,function(){w(!1)}),1)[0],s.abstract||s.export||s.source;var y=(0,G.WS)(),j=L.vs.useBridge("tooltip"),_=L.Un.useBridge("LinkBoxAPI"),S=L.Un.useBridge("extraInfo"),E=(0,U.useShowDoucment)({isH5:c,reference:s,onBack:function(){var n=e.answerLinkNumHighlights||[];(0,W.openReferenceDrawer)({router:y,api:o.current,isH5:a,link:s,highlightText:void 0!==e.rid&&e.rid<n.length?n[e.rid]:void 0,engineType:e.engineType,sourceIndex:l,showDocument:E,linkIndex:e.index,pdfContainerAPI:v.current,openInNewTab:e.openInNewWindow})}}).showDocument;(0,k.useEffect)(function(){e.link.link&&(0,O.prefetchDNS)(e.link.link)},[]);var T=L.Un.useBridge("referenceDrawer"),I=(0,eZ.p)(),H=I.isFullScreen,M=I.handleFullScreenToggle,Z=(0,eR.Z)(function(){H&&M&&M(!1)}),D=(0,k.useCallback)(function(n){null===(t=j.current)||void 0===t||t.cancel();var t,i,r=e.answerLinkNumHighlights||[];if(a&&T.current)e.from===ed.ik.Content?T.current.openByNodeId(et.nodeId):e.from===ed.ik.TABLE||e.from===ed.ik.Mapping?T.current.singleOpen(et):((0,W.recordReferenceJump)(s.link||s.url),window.open(s.link||s.url||s.file_meta.url));else{Z();var o=function(){(0,W.openReferenceDrawer)({router:y,isH5:!1,link:s,engineType:e.engineType,sourceIndex:l,showDocument:E,linkIndex:e.index,highlightText:void 0!==e.rid&&e.rid<r.length?r[e.rid]:void 0,pdfContainerAPI:v.current,gid:e.gid,rid:e.rid,target:u&&document.getElementById(u)||n.target,openInNewTab:e.openInNewWindow})};s.file_meta?setTimeout(function(){o()},100):o()}null===(i=j.current)||void 0===i||i.cancel(!0),e.onClick&&e.onClick()},[r,a,s.link,s.title,l,v.current,e.gid,e.rid,u,e.from,et,e.answerLinkNumHighlights]),B=e.from==ed.ik.Content&&e.engineType==A.rG.PODCAST,P=e.engineType===A.rG.KNOWLEDGE,F=e.engineType===A.rG.VIDEO||e.link.video,z=(0,k.useRef)(null),V=(0,p._)((0,k.useState)((n=e.searchResultId,(void 0===(t=e.rid)?"undefined":(0,x._)(t))===void 0&&(t=++e1),i="".concat(n,"-").concat(t),e0.has(i)||e0.set(i,(0,K.DOL)()),e0.get(i))),2),X=V[0];V[1];var Y=X===k.useContext(eY),Q=(0,m.jsx)(m.Fragment,{children:B?(0,m.jsx)(e6,{link:e.link,isH5:c,active:Y,onClick:D,"data-node-id":X,"data-link-index":e.index}):F?(0,m.jsx)(e4,{num:l,isH5:c,onClick:D,active:Y,"data-node-id":X,"data-link-index":e.index}):P?(0,m.jsx)(e9,{type:"",active:Y,"data-index":e.rid,"data-node-id":X,"data-link-index":e.index,onClick:D,ref:h,children:l}):b?c?(0,m.jsx)(R.Z,{component:"sup",sx:{fontSize:"10px"},onClick:D,children:(0,m.jsx)(nt,{active:Y,type:b,nodeId:X,index:e.index,children:l})}):(0,m.jsx)(e8,{active:Y,"data-index":e.rid,"data-node-id":X,"data-link-index":e.index,isH5:a,type:b,ref:h,onClick:D,children:l}):c?(0,m.jsx)(R.Z,{component:"sup",sx:{color:"#667085",cursor:"pointer",fontSize:"10px",fontStyle:"normal",lineHeight:"12px",p:"2px"},onClick:D,children:(0,m.jsx)(nn,{active:Y,nodeId:X,index:e.index,children:l})}):(0,m.jsx)(e7,{active:Y,ref:h,onClick:D,"data-node-id":X,"data-link-index":e.index,children:l})}),$=(0,k.useRef)(),J=(0,k.useCallback)(function(e){$.current=setTimeout(function(){var e;null===(e=_.current)||void 0===e||e.setActiveNode(X)},100)},[X]),ee=L.Un.useBridge("searchRightExtraKitsApi"),en=(0,eZ.p)(),et=(0,k.useMemo)(function(){var n=e.link,t=e.answerLinkNumHighlights||[];return{type:es.BoxType.LINK,nodeId:X,num:e.index+1,repeatKey:n.display.refer_id,offsetTopOfMarkdownBody:0,firstLineHeight:0,icon:(0,es.getLinkIcon)(n),description:e.rid<t.length?t[e.rid]:"",originLink:n,title:n.title||n.export,titleLinkUrl:n.link||n.url,date:n.date,finished:!0}},[e.link,e.index,X,e.rid,e.answerLinkNumHighlights]);return(0,k.useEffect)(function(){var e,n;null===(e=_.current)||void 0===e||e.refresh(),null===(n=S.current)||void 0===n||n.refresh()},[X]),a?Q:(0,m.jsx)("span",{ref:z,onMouseEnter:function(n){var t,i,r,o;e.searchResultId&&e.from!==ed.ik.TABLE&&e.from!==ed.ik.Mapping&&e.from!==ed.ik.TABLE_FULL&&e.from!==ed.ik.FLOW_CHART&&ee.current?(null===(t=ee.current)||void 0===t?void 0:t.isNotSourceTabAndPin())?null===(r=j.current)||void 0===r||r.setAnchorAndContent(z.current,(0,m.jsx)(es.SearchOriginBox,{engineType:e.engineType,dbResultId:e.searchResultId,isActive:!0,onLinkClicked:function(e){e.preventDefault(),D(e)},item:et,onExtraBoxRemove:function(){}},et.nodeId),e.engineType,function(){}):e.from===ed.ik.Content&&(null===(o=ee.current)||void 0===o||o.setSourceTabIfNeed()):null===(i=j.current)||void 0===i||i.setAnchorAndContent(z.current,(0,m.jsx)(es.SearchOriginBox,{fullScreenContext:{isFullScreen:null==en?void 0:en.isFullScreen,handleFullScreenToggle:null==en?void 0:en.handleFullScreenToggle},engineType:e.engineType,dbResultId:e.searchResultId,isActive:!0,onLinkClicked:function(e){e.preventDefault(),D(e)},item:et,onExtraBoxRemove:function(){}}),e.engineType,function(){},1e5),J(n)},onMouseLeave:function(){var e;null===(e=j.current)||void 0===e||e.cancel(!1),$.current&&clearTimeout($.current)},children:Q})}var e6=function(e){e.link,e.isH5,e.onClick;var n=(0,h._)(e,["link","isH5","onClick"]),t=(0,k.useMemo)(function(){return(e.link.episode_name,"".startsWith("《"))?e.link.episode_name:"《"+e.link.episode_name+"》"},[e.link.episode_name]),i=(0,k.useCallback)(function(n){var t;null===(t=e.onClick)||void 0===t||t.call(e,n)},[e.isH5,e.onClick]);return(0,m.jsx)("span",(0,f._)((0,d._)({style:{color:"#DC6803",display:"inline",cursor:"pointer",userSelect:"none"},className:"reference-num",onClick:i},n),{children:t}))},e4=function(e){var n=e.num,t=(e.onClick,(0,h._)(e,["num","onClick"])),i=(0,k.useCallback)(function(n){var t;null===(t=e.onClick)||void 0===t||t.call(e,n)},[e.onClick]);return e.isH5?(0,m.jsxs)("span",(0,f._)((0,d._)({style:{cursor:"pointer",userSelect:"none"},className:F()("reference-num",B()["video-reference"],B()["video-reference-h5"],(0,u._)({},B().active,e.active)),onClick:i},t),{children:[(0,m.jsx)("span",{children:"["}),(0,m.jsx)("span",{className:B()["video-reference-num"],children:(0,m.jsx)(ne,{text:n})}),(0,m.jsx)(er,{}),(0,m.jsx)("span",{children:"]"})]})):(0,m.jsxs)("span",(0,f._)((0,d._)({style:{cursor:"pointer",userSelect:"none"},className:F()("reference-num",B()["video-reference"],(0,u._)({},B().active,e.active)),onClick:i},t),{children:[(0,m.jsx)("span",{className:B()["video-reference-num"],children:(0,m.jsx)(ne,{text:n})}),(0,m.jsx)("span",{className:B()["video-reference-line"]}),(0,m.jsx)("span",{className:B()["video-reference-play"],children:(0,m.jsx)(et,{})})]}))},e3=k.memo(e2),e7=(0,k.forwardRef)(function(e,n){var t=e.children,i=e.onClick,r=e.active,o=(e.linkIndex,(0,h._)(e,["children","onClick","active","linkIndex"]));(0,k.useRef)(null),(0,z.F)().theme;var a=(0,p._)((0,k.useState)(!1),2),l=(a[0],a[1]);return(0,m.jsx)(R.Z,(0,d._)({ref:n,component:"span",onMouseEnter:function(){l(!0)},onMouseLeave:function(){return l(!1)},className:F()(B()["reference-dot"],"reference-num",(0,u._)({},B().active,r)),onClick:i,"data-number":t},o))}),e8=(0,k.forwardRef)(function(e,n){var t=e.children,i=e.onClick,r=e.type,o=e.table,a=e.isH5,l=e.active,s=(0,h._)(e,["children","onClick","type","table","isH5","active"]),c=(0,p._)((0,k.useState)(!1),2),v=c[0],x=c[1],g=(0,ed.QI)(r),C=g.color,w=g.hoverColor;return(0,m.jsxs)(M.Z,(0,f._)((0,d._)({ref:n,color:v&&!a?w.stroke:C.stroke,component:"span","data-number":t,"data-type":r,onMouseEnter:function(){x(!0)},className:F()(B()["doc-reference-dot"],"reference-num",(0,u._)({},B()["table-reference"],o),(0,u._)({},B().active,l)),sx:{border:"solid 1px ".concat(C.stroke),"&:hover":{border:"solid 1px ".concat(a?C.stroke:w.stroke)}},onClick:i},s),{children:[(0,m.jsx)(ne,{text:t}),(0,m.jsx)(R.Z,{component:"span",sx:{height:"7px",borderRight:"solid 1px ".concat(w.stroke),opacity:"0.5",margin:"0 2px"}}),(0,m.jsx)(ne,{text:r})]}))}),e9=(0,k.forwardRef)(function(e,n){var t=e.children,i=e.onClick,r=e.table,o=e.active,a=(0,h._)(e,["children","onClick","table","active"]);return(0,m.jsxs)(M.Z,(0,f._)((0,d._)({ref:n,component:"span",className:F()(B()["doc-reference-dot"],"reference-num",(0,u._)({},B()["table-reference"],r),(0,u._)({},B().active,o)),sx:{border:"solid 1px var(--black3)",color:"var(--black3)"},onClick:i},a),{"data-number":t,children:[(0,m.jsx)(ne,{text:t}),(0,m.jsx)(R.Z,{component:"span",sx:{height:"7px",borderRight:"solid 1px var(--card-border-color)",margin:"0 2px"}}),(0,m.jsx)("svg",{width:"10",height:"9",viewBox:"0 0 10 9",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,m.jsx)("path",{d:"M5 7.875L4.96248 7.81872C4.70199 7.42798 4.57174 7.23261 4.39966 7.09118C4.24732 6.96597 4.07179 6.87203 3.8831 6.81473C3.66997 6.75 3.43517 6.75 2.96556 6.75H2.45C2.02996 6.75 1.81994 6.75 1.65951 6.66825C1.51839 6.59635 1.40365 6.48161 1.33175 6.34049C1.25 6.18006 1.25 5.97004 1.25 5.55V2.325C1.25 1.90496 1.25 1.69494 1.33175 1.53451C1.40365 1.39339 1.51839 1.27865 1.65951 1.20675C1.81994 1.125 2.02996 1.125 2.45 1.125H2.6C3.44008 1.125 3.86012 1.125 4.18099 1.28849C4.46323 1.4323 4.6927 1.66177 4.83651 1.94401C5 2.26488 5 2.68492 5 3.525M5 7.875V3.525M5 7.875L5.03752 7.81872C5.29801 7.42798 5.42826 7.23261 5.60034 7.09118C5.75268 6.96597 5.92821 6.87203 6.1169 6.81473C6.33003 6.75 6.56483 6.75 7.03444 6.75H7.55C7.97004 6.75 8.18006 6.75 8.34049 6.66825C8.48161 6.59635 8.59635 6.48161 8.66825 6.34049C8.75 6.18006 8.75 5.97004 8.75 5.55V2.325C8.75 1.90496 8.75 1.69494 8.66825 1.53451C8.59635 1.39339 8.48161 1.27865 8.34049 1.20675C8.18006 1.125 7.97004 1.125 7.55 1.125H7.4C6.55992 1.125 6.13988 1.125 5.81901 1.28849C5.53677 1.4323 5.3073 1.66177 5.16349 1.94401C5 2.26488 5 2.68492 5 3.525",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})})]}))});function ne(e){var n=e.text,t=(0,q.F)();return(0,m.jsx)("span",{className:F()(B()["select-none-text"],(0,u._)({},B()["select-none-text-pc"],!t)),"data-text":n})}function nn(e){var n=e.children,t=e.nodeId,i=e.index,r=e.active;return(0,m.jsx)(R.Z,{component:"span",className:F()(B()["num-bracket"],"reference-num",(0,u._)({},B().h5Active,r)),"data-node-id":t,"data-link-index":i,children:(0,m.jsx)(ne,{text:"[".concat(n,"]")})})}function nt(e){var n=e.type,t=e.children,i=e.nodeId,r=e.index,o=e.active,a=(0,ed.QI)(n).color;return(0,m.jsx)(R.Z,{component:"span",className:F()(B()["num-bracket"],"reference-num",(0,u._)({},B().h5Active,o)),color:a.stroke,"data-node-id":i,"data-link-index":r,"data-type":n,children:(0,m.jsx)(ne,{text:"[".concat(t," ").concat(n,"]")})})}},41796:function(e,n,t){"use strict";t.r(n),t.d(n,{SearchOriginList:function(){return E}});var i=t(12249),r=t(5194),o=t(1780),a=t(46796),l=t(50059),s=t(57437),c=t(2265),u=t(78693),d=t(34913),f=t.n(d),h=t(7870),p=t(54887),v=t(36017),x=t(47812);t(25590);var g=t(55833),m=t(36760),k=t.n(m);t(15598);var C=t(75545),w=t(99376),b=t(79943),y=t(74634);t(86602),t(39207);var j=t(35046),_=t(89038),S=t(14250);function E(e){var n=e.list,t=e.isH5,d=e.engineType,m=e.gid,E=e.rid,T=(e.resultId,(0,a._)(e,["list","isH5","engineType","gid","rid","resultId"])),L=n;(0,b.WS)(),(0,v.useOpenAcademicDetail)().openDetail;var I=(0,c.useMemo)(function(){return(0,C.p)(n,d)},[n]);I&&(L=I.links),_.x.useAPI("pdfContainer");var H=(0,S.k)({isH5:t,displayLinks:L,gid:m,pdfTransformResult:I}).onLinkClick;(0,c.useEffect)(function(){L.forEach(function(e){e.link&&(0,p.prefetchDNS)(e.link)})},[]);var M=(0,l._)((0,c.useState)({}),2);M[0],M[1];var Z=g.Un.useBridge("referenceDrawer"),R=(0,c.useCallback)(function(e){var n;null===(n=Z.current)||void 0===n||n.singleOpen(e)},[]),N=(0,w.usePathname)();(0,w.useSearchParams)();var O=g.vs.useBridge("tooltip"),A=(0,c.useMemo)(function(){return"undefined"==typeof location?N:location.origin+N},[N]),D=(0,l._)((0,c.useState)(!1),2),B=D[0],P=D[1];(0,c.useEffect)(function(){(0,c.startTransition)(function(){P(!0)})},[]);var F=(0,y.dM)(),z=F.ifGoToDownloadAppPageAvailable;F.tryGoToDownloadAppPage;var W=(0,w.useSearchParams)();return(0,c.useEffect)(function(){if(W.has("pdfId")&&L.length>0){var e=L.findIndex(function(e){return e.id===W.get("pdfId")}),n=L[e];if(n){var t=new URL(location.href);t.searchParams.delete("pdfId"),history.replaceState(null,"",t.href),H(new Event("click"),n,e,!0)}}},[W,L]),(0,s.jsx)(u.Z,(0,o._)((0,r._)({},T),{className:f()["meta-list"],children:B&&L.map(function(e,n){var r,o={type:j.BoxType.LINK,nodeId:n,num:n+1,repeatKey:(null===(r=e.display)||void 0===r?void 0:r.refer_id)||e.id,offsetTopOfMarkdownBody:0,firstLineHeight:0,icon:(0,j.getLinkIcon)(e),originLink:e,title:e.title||e.export,titleLinkUrl:e.link||e.url,date:e.date,finished:!0};return(e.abstract||e.export,e.danger)?(0,s.jsx)(c.Fragment,{},n):d===x.rG.PODCAST?(0,s.jsx)(u.Z,{className:f()["pod-ref-container"],children:(0,s.jsx)(v.PodCastReference,{reference:e,visible:!0,isH5:t})},n):(0,s.jsx)(u.Z,{className:k()(f()["list-item"],(0,i._)({},f().active,E===1e4+n)),id:"reference-"+m+"-"+(e.display?e.display.refer_id:n+1),children:(0,s.jsxs)("span",{children:[A.indexOf(e.link||e.url)>-1?(0,s.jsx)(s.Fragment,{children:n+1+". "+(e.export||e.title)+"  "}):(0,s.jsxs)(s.Fragment,{children:[L[n].display.refer_id+". ",e.file_meta&&(0,s.jsx)(u.Z,{component:"span",sx:{borderRadius:"20px",marginRight:"5px",verticalAlign:"bottom",fontSize:"9px",padding:"2px 5px",border:"solid 1px rgba(152, 162, 179, 1)",color:"var(--black)"},children:d===x.rG.KNOWLEDGE?"LIB":(0,x.fv)(e.file_meta.type)}),(0,s.jsx)(v.SearchReferenceLink,{href:e.link||e.url,target:"_blank",sx:{cursor:"pointer"},preventCopy:function(){return z()},onLinkClick:function(i){t&&d===x.rG.SCHOLAR?(i.preventDefault(),R(o)):H(i,e,n)},children:(0,s.jsx)(v.TitleMarkdown,{content:(e.export||e.title)+(e.author?". ".concat(e.author,"."):"")+"  "})})]}),(0,s.jsx)(u.Z,{component:"span",sx:{fontSize:13,color:"var(--black)",whiteSpace:"nowrap"},children:!!(e.date||e.publish_date)&&"[".concat((0,h.l6)(e.date||e.publish_date,"-"),"]")}),(e.abstract||e.source||e.data||e.quote)&&!t&&(0,s.jsx)(u.Z,{sx:{display:"inline-flex",verticalAlign:"middle",cursor:"pointer",margin:"0 0 4px 5px"},className:"search-origin-box-wrapper",onMouseEnter:function(t){var i;null===(i=O.current)||void 0===i||i.setAnchorAndContent(t.currentTarget,(0,s.jsx)(j.SearchOriginBox,{engineType:x.rG.SCHOLAR,dbResultId:m,isActive:!0,onLinkClicked:function(){H(t,e,n,!0)},item:o,onExtraBoxRemove:function(){}}),x.rG.SCHOLAR,function(){})},onMouseLeave:function(){var e;null===(e=O.current)||void 0===e||e.cancel(!1)},children:(0,s.jsx)("svg",{width:"18",height:"16",viewBox:"0 0 18 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:f()["book-open-svg"],children:(0,s.jsx)("path",{d:"M9 14.75L8.92496 14.6374C8.40398 13.856 8.14349 13.4652 7.79933 13.1824C7.49464 12.9319 7.14357 12.7441 6.7662 12.6295C6.33994 12.5 5.87033 12.5 4.93112 12.5H3.9C3.05992 12.5 2.63988 12.5 2.31901 12.3365C2.03677 12.1927 1.8073 11.9632 1.66349 11.681C1.5 11.3601 1.5 10.9401 1.5 10.1V3.65C1.5 2.80992 1.5 2.38988 1.66349 2.06901C1.8073 1.78677 2.03677 1.5573 2.31901 1.41349C2.63988 1.25 3.05992 1.25 3.9 1.25H4.2C5.88016 1.25 6.72024 1.25 7.36197 1.57698C7.92646 1.8646 8.3854 2.32354 8.67302 2.88803C9 3.52976 9 4.36984 9 6.05M9 14.75V6.05M9 14.75L9.07504 14.6374C9.59602 13.856 9.85651 13.4652 10.2007 13.1824C10.5054 12.9319 10.8564 12.7441 11.2338 12.6295C11.6601 12.5 12.1297 12.5 13.0689 12.5H14.1C14.9401 12.5 15.3601 12.5 15.681 12.3365C15.9632 12.1927 16.1927 11.9632 16.3365 11.681C16.5 11.3601 16.5 10.9401 16.5 10.1V3.65C16.5 2.80992 16.5 2.38988 16.3365 2.06901C16.1927 1.78677 15.9632 1.5573 15.681 1.41349C15.3601 1.25 14.9401 1.25 14.1 1.25H13.8C12.1198 1.25 11.2798 1.25 10.638 1.57698C10.0735 1.8646 9.6146 2.32354 9.32698 2.88803C9 3.52976 9 4.36984 9 6.05",strokeWidth:"1.75",strokeLinecap:"round",strokeLinejoin:"round"})})})]})},n)})}))}},13988:function(e,n,t){"use strict";t.d(n,{ji:function(){return eX},ZU:function(){return s},Gt:function(){return eU},V$:function(){return c},$h:function(){return eO},CN:function(){return eZ},aL:function(){return eD},ZX:function(){return eW}});var i,r,o,a,l,s,c,u=t(2403),d=t(5194),f=t(50059),h=t(45008),p=t(5853),v=t(57437),x=t(2265),g=t(78693),m=t(19643),k=t(8350),C=t(59832),w=t(47080),b=t(35389),y=t(16210),j=t(43180),_=t(54632),S=t(39207),E=t(47812),T=t(54493),L=t(55833),I=t(10301),H=t(80089),M=t(53998),Z=t(7167),R=t(41796),N=t(23665),O=t.n(N),A=t(22804),D=t(94841),B=t(22322),P=t(72422),F=t(45225),z=t(29823),W=t(72391),U=t(86602),V=t(7870),q=t(23760),G=t(22629),X=t(96339),K=t(89831),Y=t(56731),Q=t(36017),$=t(92838),J=t.n($),ee=t(58494),en=t(26058),et=t(40045),ei=t(54887),er=t(61447),eo=t(19741),ea=t(76904),el=t(63080),es=t(36570),ec=t(1780),eu=t(89051),ed=t(94746);function ef(){return(ef=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var eh=function(e){return ed.createElement("svg",ef({xmlns:"http://www.w3.org/2000/svg",width:10,height:14,fill:"none",viewBox:"0 0 10 14"},e),o||(o=ed.createElement("path",{fill:"currentColor",d:"M8.193 0H0v3.114h1.807V1.826h2.297v7.588H2.759v1.826h4.496V9.414H5.91V1.826h2.283v1.288H10V0zM0 12.584h10V14H0z"})))};function ep(){return(ep=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var ev=function(e){return ed.createElement("svg",ep({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",viewBox:"0 0 20 20"},e),a||(a=ed.createElement("path",{fill:"currentColor",d:"M13.193 3H5v3.114h1.807V4.826h2.297v7.588H7.759v1.826h4.496v-1.826H10.91V4.826h2.283v1.288H15V3zM5 15.584h10V17H5z"})),l||(l=ed.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:1.5,d:"m3 3 13 11"})))},ex=t(54892),eg=t(64798),em=t.n(eg),ek=function(e,n,t,i){return(0,x.useMemo)(function(){return em()(e,n,t)},i)},eC=(0,x.memo)((0,x.forwardRef)(function(e,n){var t=e.hasMark,i=ek(e.onCopy,100,{leading:!1,trailing:!0},[e.onCopy]),r=ek(e.onExplain,100,{leading:!1,trailing:!0},[e.onExplain]),o=ek(e.onTranslate,100,{leading:!1,trailing:!0},[e.onTranslate]),a=ek(e.onMark,100,{leading:!1,trailing:!0},[e.onMark]);return e.isH5?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(ew,{onClick:i,onTouchEnd:i,children:"复制"}),(0,v.jsx)(ew,{onClick:r,onTouchEnd:r,children:"解释"}),!e.hideTranslate&&(0,v.jsx)(ew,{onClick:o,onTouchEnd:o,children:"翻译"}),e.translateMode===ex.R.ORIGINAL&&(0,v.jsxs)(ew,{onTouchEnd:a,onClick:a,onMouseDown:function(e){e.preventDefault()},children:[" ",t?"删线":"划线"]})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(eu.Z,{title:"复制",placement:"top",classes:{tooltip:"custom-tooltip-popper",arrow:"custom-tooltip-arrow"},children:(0,v.jsx)(C.Z,{sx:{color:"var(--black3)",width:"37px",height:"37px"},onClick:e.onCopy,onTouchEnd:e.onCopy,children:(0,v.jsx)(z.Z,{style:{width:"18px"}})})}),(0,v.jsx)(eu.Z,{title:"解释",placement:"top",classes:{tooltip:"custom-tooltip-popper",arrow:"custom-tooltip-arrow"},children:(0,v.jsx)(C.Z,{sx:{color:"var(--black3)",width:"37px",height:"37px"},onClick:e.onExplain,onTouchEnd:e.onExplain,children:(0,v.jsx)(F.Z,{})})}),!e.hideTranslate&&(0,v.jsx)(eu.Z,{title:"翻译",placement:"top",classes:{tooltip:"custom-tooltip-popper",arrow:"custom-tooltip-arrow"},children:(0,v.jsx)(C.Z,{sx:{color:"var(--black3)",width:"37px",height:"37px"},onClick:e.onTranslate,onTouchEnd:e.onTranslate,children:(0,v.jsx)(P.Z,{})})}),e.translateMode===ex.R.ORIGINAL&&(0,v.jsx)(eu.Z,{title:t?"删除划线":"划线",placement:"top",classes:{tooltip:"custom-tooltip-popper",arrow:"custom-tooltip-arrow"},children:(0,v.jsx)(C.Z,{sx:{color:"var(--black3)",width:"37px",height:"37px"},onClick:function(){e.onMark()},children:t?(0,v.jsx)(ev,{}):(0,v.jsx)(eh,{})})})]})}));function ew(e){return(0,v.jsx)(_.Z,(0,ec._)((0,d._)({},e),{sx:(0,V.Vc)((0,V.KI)({ml:0,fontSize:14,fontWeight:"normal",color:"var(--black)"},2),e.sx)}))}var eb=t(24095),ey=t(31876),ej=t(74634),e_=t(25060),eS=t(89038),eE=t(5806),eT=t(94084);function eL(){var e=(0,h._)(["\n    .MuiDrawer-paper {\n        max-height: 70vh;\n        height: 50vh;\n        padding-bottom: 30px;\n        @media screen and (min-width: 600px) {\n            padding-left: 30px;\n            padding-right: 30px;\n        }\n    }\n"]);return eL=function(){return e},e}var eI=!1,eH=(0,x.forwardRef)(function(e,n){var t=(0,f._)((0,x.useState)(!1),2),i=t[0],r=t[1],o=(0,f._)((0,x.useState)(null),2),a=o[0],l=o[1],s=(0,x.useRef)(null),c=(0,f._)((0,x.useState)(""),2),u=c[0],d=c[1],h=(0,f._)((0,x.useState)(0),2),p=h[0],m=h[1],k=(0,x.useCallback)(function(){l(null),r(!1),m(p+1),null==a||a.remove()},[p]);(0,j.bQ)({anchor:a,popover:function(){var e;return null===(e=s.current)||void 0===e?void 0:e.nodeRef.current}},i,function(){k()}),(0,x.useImperativeHandle)(n,function(){return{show:function(e,n,t){d(n),l(e),r(!0),T(t)},hide:function(){r(!1),m(p+1)}}},[p]);var C=(0,x.useId)(),w=(0,ej.a8)(),b=(0,f._)((0,x.useState)(null),2),y=b[0],_=b[1],S=(0,f._)((0,x.useState)(void 0),2),E=S[0],T=S[1];return(0,v.jsxs)(v.Fragment,{children:[w&&(0,ei.createPortal)((0,v.jsx)(g.Z,{sx:{width:"100vw",height:"100vh",overflow:"hidden",pointerEvents:"none",position:"fixed",top:0,left:0,zIndex:3e3,"&>*":{pointerEvents:"auto"}},ref:_,id:"search-popover-portal-".concat(C)}),document.body),(0,v.jsx)(j.ZP,{ref:s,anchor:a,open:i,offsetOptions:E,floatRoot:y||void 0,isAutoUpdate:!0,classes:{contentWrapper:"search-tool-popover"},style:{zIndex:9999,userSelect:"none"},onOpenChanged:function(e){},children:i&&(0,v.jsx)(eR,{onTranslate:e.onTranslate,previewMode:e.previewMode,translateMode:e.translateMode,isH5:e.isH5,isPPT:e.isPPT,onClose:k,isWebview:e.isWebview,text:u,popoverApi:s,onTypeChange:e.onTypeChange,onCreateSession:e.onSessionChange,onSelectionChange:e.onSelectionChange},p)})]})}),eM=x.memo(eH);function eZ(e){var n=(0,V.N_)(e);return n.englishWordCount,!!(n.chineseCharCount<=0||(0,V.$I)(e))}function eR(e){var n=(0,f._)((0,x.useState)(""),2),t=n[0],i=n[1],r=(0,f._)((0,x.useState)(!0),2),o=r[0],a=r[1],l=(0,f._)((0,x.useState)(!1),2),s=l[0],c=l[1],u=(0,f._)((0,x.useState)(!1),2),h=u[0],p=u[1],C=(0,f._)((0,x.useState)("rgba(253, 203, 132, 1)"),2),w=C[0],b=C[1],y=(0,f._)((0,x.useState)(0),2),j=y[0],L=y[1],I=(0,f._)((0,x.useState)(0),2),H=I[0],M=I[1],Z=(0,f._)((0,x.useState)(null),2),R=Z[0],N=Z[1],O=(0,q.LM)(function(e){return e.login}),A=[{color:"rgba(253, 203, 132, 1)"},{color:"rgba(183, 159, 255, 1)"},{color:"rgba(116, 180, 252, 1)"},{color:"rgba(112, 211, 131, 1)"},{color:"rgba(255, 144, 156, 1)"}];(0,x.useEffect)(function(){var e=es.ZP.pdfHighlightColor.get();L(e),b(A[e].color)},[]),(0,x.useEffect)(function(){i(e.text)},[e.text]),(0,x.useEffect)(function(){localStorage.getItem("pdf-markType")&&M(parseInt(localStorage.getItem("pdf-markType")||"0"))},[]),(0,x.useEffect)(function(){localStorage.setItem("pdf-markType",H.toString())},[H]),(0,x.useEffect)(function(){t||(a(!0),c(!1));var e=(0,V.N_)(t);a((e.englishWordCount,e.chineseCharCount>0)),c((0,V.$I)(t))},[t]);var D=(0,x.useRef)(!1),W=(0,q.LM)(function(e){return e.model}),U=(0,x.useCallback)(function(n){var t;(0,V.dW)("pdf-explain",{content:n}),e.onClose(),null===(t=window.getSelection())||void 0===t||t.removeAllRanges(),D.current||(D.current=!0,eO(n,W).then(function(n){D.current=!1,e.onCreateSession(n)}).catch(function(e){e instanceof T.dp?(e.code===K.cO.USER_CREDIT_RUN_OUT&&(0,Y.Z)(),(0,B.y)(e.message,{variant:"warning",autoHideDuration:3e3})):(0,B.y)("网络错误",{variant:"error",autoHideDuration:3e3})}).finally(function(){D.current=!1}))},[W]),G=(0,x.useCallback)(function(n){e.onClose(),(0,V.dW)("pdf-translate",{content:n}),D.current||(D.current=!0,(0,S.bE6)(n).then(function(n){0===n.data.errCode&&e.onTranslate(n.data.data.translate)}).finally(function(){D.current=!1}))},[]),Q=eS.x.useAPI("pdfMarkdown"),$=eS.x.useAPI("getPreviewContainer"),J=eS.x.useAPI("getPdfContainer");(0,x.useEffect)(function(){var n=null;if(n=e.previewMode?null===(t=$.current)||void 0===t?void 0:t.call($):null===(i=J.current)||void 0===i?void 0:i.call(J),e.isPPT&&(n=document.querySelector(".ppt-viewport-regular")),n){var t,i,r,o=function(e){var n=window.getSelection();if(!n.rangeCount)return null;var t=n.getRangeAt(0);return e.contains(t.startContainer)&&e.contains(t.endContainer)?(e.textContent,{startOffset:ez(t.startContainer,t.startOffset,e),endOffset:ez(t.endContainer,t.endOffset,e),selectedText:t.toString(),range:t}):null}(n);N(o),null===(r=e.onSelectionChange)||void 0===r||r.call(e,o),o||e.onClose()}},[e.text,e.previewMode,e.isPPT]);var ee=(0,x.useCallback)(function(n,t){if(!O){e.onClose(),e.isWebview?(0,eb.ZP)({type:E.jo.NeedLogin,value:{}}):(0,X.x3)({showTips:!0,tipsHtml:"登录后，可以添加划线",logDesc:"add-underline",redirectUrl:location.href});return}if(R){var i,r;null===(i=Q.current)||void 0===i||i.addRange(null==R?void 0:R.startOffset,null==R?void 0:R.endOffset,A[n].color,t),null===(r=getSelection())||void 0===r||r.removeAllRanges(),ei(!0)}},[R,O,e.onClose]),en=(0,f._)((0,x.useState)(!1),2),et=en[0],ei=en[1],er=(0,x.useCallback)(function(){var e;null===(e=Q.current)||void 0===e||e.deleteRange(null==R?void 0:R.startOffset,null==R?void 0:R.endOffset),ei(!1)},[R]);(0,x.useEffect)(function(){if(R){var e,n=null===(e=Q.current)||void 0===e?void 0:e.getRange(R.startOffset,R.endOffset);n&&n.length>0?ei(!0):ei(!1)}},[R]);var eo=(0,x.useCallback)(function(){(0,V.vQ)(t,!0),(0,B.y)("复制成功",{variant:"success",autoHideDuration:3e3}),e.onClose()},[t,e.onClose]),ea=(0,x.useCallback)(function(){eI=!0,p(!0),et?(er(),e.onClose()):ee(j,H)},[er,er,j,H,et]);return(0,v.jsxs)(m.Z,{sx:{padding:"5px 10px"},onClick:function(e){e.stopPropagation(),e.preventDefault()},children:[(0,v.jsx)(m.Z,{direction:"row",justifyContent:"center",alignItems:"center",spacing:1,children:e.previewMode?(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(eC,{isH5:e.isH5,isPPT:e.isPPT,translateMode:e.translateMode,onCopy:function(){if((0,eb.f7)()){var n;(0,eb.ZP)({type:E.jo.OnMenuCopyClick,value:{value:t}}),null===(n=getSelection())||void 0===n||n.removeAllRanges()}else eo();e.onClose()},onExplain:function(){if(e.onTypeChange("解释"),(0,eb.f7)()){var n;(0,eb.ZP)({type:E.jo.OnMenuExplainClick,value:{value:t}}),null===(n=getSelection())||void 0===n||n.removeAllRanges()}else U("解释：".concat(t)),(0,el.Kn)(el.Df.OpenSourceDrawer,"");e.onClose()},hideTranslate:!(!o||s),onTranslate:function(){if(e.onTypeChange("翻译"),(0,eb.f7)()){var n;(0,eb.ZP)({type:E.jo.OnMenuTranslateClick,value:{value:t}}),null===(n=getSelection())||void 0===n||n.removeAllRanges()}else G(t);e.onClose()},hasMark:et,onMark:ea})}):(0,v.jsxs)(v.Fragment,{children:[!e.isPPT&&(0,v.jsx)(_.Z,{startIcon:(0,v.jsx)(z.Z,{style:{width:"18px"}}),sx:{color:"var(--black3)"},variant:"text",onClick:function(){e.isH5||eo()},onTouchEnd:eo,children:e.previewMode?"":"复制"}),(0,v.jsx)(_.Z,{startIcon:(0,v.jsx)(F.Z,{}),sx:{color:"var(--black3)"},variant:"text",onClick:function(){e.isH5||(e.onTypeChange("解释"),U("解释：".concat(t)))},onTouchEnd:function(n){e.onTypeChange("解释"),U("解释：".concat(t)),(0,el.Kn)(el.Df.OpenSourceDrawer,""),n.preventDefault(),n.stopPropagation()},children:e.previewMode?"":"解释"}),!e.isPPT&&(!o||s)&&(0,v.jsx)(_.Z,{startIcon:(0,v.jsx)(P.Z,{}),sx:{color:"var(--black3)"},variant:"text",onClick:function(){e.onTypeChange("翻译"),G(t)},children:e.previewMode?"":"翻译"})]})}),h&&(0,v.jsxs)(m.Z,{direction:"row",spacing:1,alignItems:"center",justifyContent:e.isH5?"space-evenly":"center",sx:(0,d._)({},e.isH5?{borderTop:"1px solid #e6e6e6",mx:"-10px",py:1}:{borderTop:"1px solid var(--border-color)",paddingTop:"10px"}),children:[(0,v.jsx)(g.Z,{onClick:function(){M(0),ee(j,0)},sx:{borderRadius:"5.24px",height:"20px",width:"20px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",backgroundColor:0===H?w:"var(--gray-2)",fontSize:"14px",lineHeight:"23px"},children:"A"}),(0,v.jsx)(g.Z,{onClick:function(){M(1),ee(j,1)},sx:{height:"20px",width:"20px",display:"flex",cursor:"pointer",alignItems:"center",justifyContent:"center",textDecoration:"underline",textUnderlineOffset:"5px",textDecorationColor:1===H?A[j].color:"unset"},children:"A"}),(0,v.jsx)(k.Z,{sx:{height:"20px"},orientation:"vertical"}),A.map(function(e,n){return(0,v.jsx)(eN,{color:e.color,onClick:function(t){ee(n,H),L(n),b(e.color),es.ZP.pdfHighlightColor.set(n)},checked:j===n},n)})]})]})}function eN(e){return(0,v.jsx)(g.Z,{className:J()["color-btn"],sx:{backgroundColor:e.color},onClick:e.onClick,children:e.checked&&(0,v.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,v.jsx)("path",{d:"M9.0541 1.13672L3.64824 6.86636L0.945312 3.83965",stroke:"#344054","stroke-width":"0.675732","stroke-linecap":"round","stroke-linejoin":"round"})})})}function eO(e,n,t,i){return eA.apply(this,arguments)}function eA(){return(eA=(0,u._)(function(e,n,t,i){var r,o,a=arguments;return(0,p.Jh)(this,function(l){switch(l.label){case 0:if(r=!(a.length>4)||void 0===a[4]||a[4],!q.LM.getState().login&&!G.a2.getState().canSearch(1))return(0,X.x3)({showTips:!0,tipsHtml:"登录后，可继续<b>免费</b>使用",logDesc:"do-search-but-not-available"}),[2,null];return(0,V.dW)("search-create-session",{query:e,s:new URLSearchParams(location.search).get("s")||localStorage.getItem("s")||ee.ZP.load("s"),mode:"detail",engineType:E.rG.DEFAULT,client:(0,en.Fk)(),explain:!0,model:n}),[4,(0,S.ed6)({engineType:E.rG.DEFAULT,scholarSearchDomain:E.wb.ALL,searchType:"web",mode:"detail",question:e,groupId:void 0,topicId:void 0,topicName:void 0,searchTopicId:void 0,imgId:void 0,advanceMath:void 0,model:n,pptId:t,pptPageId:i},r)];case 1:if(0===(o=l.sent()).data.errCode)return q.LM.getState().login||(0,ea.WR)(o.data.data.id)||G.a2.getState().appendRecord(o.data.data),[2,o.data.data];throw new T.dp(o.data.errCode,o.data.errMsg||"")}})})).apply(this,arguments)}function eD(e,n){var t=(0,x.useRef)(0),i=(0,x.useRef)(0),r=(0,x.useRef)(!1),o=(0,x.useRef)(0),a=(0,x.useRef)(0),l=(0,x.useCallback)(function(e){e.stopPropagation(),t.current=e.pageX-o.current,i.current=e.pageY-a.current,r.current=!0},[]),s=(0,x.useCallback)(function(n){r.current&&(o.current=n.pageX-t.current,a.current=n.pageY-i.current,e(o.current,a.current))},[]);(0,x.useEffect)(function(){o.current=0,a.current=0},[n]);var c=(0,x.useCallback)(function(e){r.current=!1},[]);return(0,x.useEffect)(function(){return document.addEventListener("mousemove",s),document.addEventListener("mouseup",c),function(){document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",c)}},[]),{onMouseDown:l}}function eB(e){var n=eD(e.onDragMove).onMouseDown;return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(m.Z,{onMouseDown:n,spacing:.8,direction:"row",sx:{fontSize:"16px",padding:"10px 18px 0 18px",cursor:"grab",height:"40px",position:"sticky",top:0,left:0,backgroundColor:"var(--gray)",zIndex:200},alignItems:"center",children:[(0,v.jsx)(P.Z,{}),(0,v.jsx)(g.Z,{sx:{fontWeight:"bold"},children:"翻译"}),(0,v.jsx)(g.Z,{sx:{flex:1}}),!e.isH5&&(0,v.jsx)(C.Z,{onClick:e.onClose,children:(0,v.jsx)(ey.Z,{})})]}),(0,v.jsx)(g.Z,{sx:{padding:"0 18px",overflowY:"auto",flex:1},children:(0,v.jsx)(Q.AbstractMarkdown,{content:e.content,fontSize:"16px"})})]})}(i=s||(s={}))[i.FILL=0]="FILL",i[i.UNDERLINE=1]="UNDERLINE";var eP=(0,x.forwardRef)(function(e,n){var t=(0,L.Rx)(e,n,{maxWidth:652}),i=(t.analyzeMode,t.collapse,t.result),r=t.lastTextRef,o=t.links,a=t.finished,l=t.label,s=(t.containerRef,t.noData),c=(t.isLast,t.showFadeAnimation,t.resultId,t.copyContent,t.abort,t.notDangerLinks,t.idRef),u=t.realTimeData,d=(t.searchProgressRef,t.debugId,t.abortSearching,t.realQuestion,t.fontSize,t.loadingSkeletonRef,t.setMindMappingLoaded,t.sourceCount),h=(t.hasResult,t.mindMappingLoaded,t.imgMetas);(0,er.gE)(),(0,x.useEffect)(function(){var n,t,r;null==e||null===(n=e.finishedChanged)||void 0===n||n.call(e,a,o),null==e||null===(t=e.resultChanged)||void 0===t||t.call(e,i),null==e||null===(r=e.realTimeDataChanged)||void 0===r||r.call(e,u)},[a,i,u]);var p=(0,eE.a)(),k=p.onSearchSubmit;p.modelRef;var w=(0,x.useCallback)(function(n,t){k({question:t||e.question,_mode:e.mode,engineType:E.rG.IMAGE,imgInfo:JSON.stringify(n),autoChange:!0,scholarSearchDomain:E.wb.ALL})},[e.question,e.mode]),b=(0,x.useCallback)(function(){},[]),y=(0,x.useRef)(null),j=(0,f._)((0,x.useState)(!1),2),S=j[0],T=j[1],M=eD((0,x.useCallback)(function(n,t){if(e.onDragMove)e.onDragMove(n,t);else{var i;(null===(i=e.deskRef)||void 0===i?void 0:i.current)&&(e.deskRef.current.style.left="calc(50% - 305px + ".concat(n,"px)"),e.deskRef.current.style.top="calc(50% - 229px + ".concat(t,"px)"))}},[]),e.open).onMouseDown;(0,x.useEffect)(function(){y.current&&(y.current.scrollTop=0)},[S]);var N=function(){T(!0)};return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(m.Z,{onMouseDown:M,spacing:.8,direction:"row",sx:{fontSize:"14px",padding:"10px 18px 0 18px",cursor:"grab",height:"40px",position:"sticky",top:0,left:0,backgroundColor:"var(--gray)",zIndex:200},alignItems:"center",children:[S?(0,v.jsx)(_.Z,{sx:{padding:"5px 0",justifyContent:"start",width:"20px",minWidth:0},onClick:function(){T(!1)},children:(0,v.jsx)("svg",{width:"8",height:"15",viewBox:"0 0 8 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,v.jsx)("path",{d:"M7 1.5L1 7.5L7 13.5",stroke:"var(--black)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}):(0,v.jsxs)(v.Fragment,{children:["翻译"===e.type?(0,v.jsx)(P.Z,{}):(0,v.jsx)(v.Fragment,{children:e.isH5?(0,v.jsx)(v.Fragment,{}):(0,v.jsx)(F.Z,{})}),(0,v.jsx)(g.Z,{sx:{fontWeight:"bold",fontSize:"18px",lineHeight:"24px"},children:e.type}),e.isH5?(0,v.jsx)(v.Fragment,{children:d>0&&a&&"翻译"!==e.type&&(0,v.jsx)(_.Z,{className:O()["answer-link-btn"],sx:{fontSize:"14px !important",width:"40px !important"},onClick:N,children:(0,v.jsx)(A.Z,{style:{marginRight:4,width:14,height:14,flex:"none"}})})}):(0,v.jsx)(v.Fragment,{children:a&&(0,v.jsx)(Q.AddToSubjectButton,{buttonSx:{padding:"2px"},topicId:e.topicId,sessionTopicChanged:function(){(0,V.v_)("explain-box-session-map",e.id)},topicName:e.topicName,link:{},sessionId:e.id})})]}),(0,v.jsx)(g.Z,{sx:{flex:1}}),e.isH5?(0,v.jsx)(v.Fragment,{children:a&&(0,v.jsx)(Q.AddToSubjectButton,{topicId:e.topicId,placement:"left-start",sessionTopicChanged:function(){(0,V.v_)("explain-box-session-map",e.id)},topicName:e.topicName,link:{},sessionId:e.id})}):(0,v.jsxs)(v.Fragment,{children:[d>0&&a&&"翻译"!==e.type&&(0,v.jsxs)(_.Z,{className:O()["answer-link-btn"],sx:{fontSize:"14px !important",width:"40px !important"},onClick:N,children:[(0,v.jsx)(A.Z,{style:{marginRight:4,width:14,height:14,flex:"none"}}),(0,v.jsx)("span",{style:{marginTop:"2px"},children:d})]}),a&&(0,v.jsx)(C.Z,{onClick:function(n){var t;null===(t=e.onClose)||void 0===t||t.call(e,a,n)},children:(0,v.jsx)(ey.Z,{})})]})]}),(0,v.jsx)(g.Z,{ref:y,sx:{padding:"0 18px",overflowY:"auto",flex:1},children:S?(0,v.jsx)(D.K,{show:!0,children:(0,v.jsx)(m.Z,{spacing:2,children:(0,v.jsx)(R.SearchOriginList,{list:o})})}):(0,v.jsx)(v.Fragment,{children:s?(0,v.jsx)(Z.fR,{question:e.question,engineType:e.engineType}):(0,v.jsx)(v.Fragment,{children:i?(0,v.jsx)(H.Z,{children:(0,v.jsxs)(g.Z,{sx:{minHeight:"112px",textAlign:"justify"},children:[u&&"dict"===u.infoType&&u.data.pinyin&&(0,v.jsx)(g.Z,{className:"markdown-body",children:(0,v.jsxs)("p",{children:["拼音：",u.data.pinyin.join("；")]})}),(0,v.jsx)(I.Content,{onImgSubmit:w,imgMetas:h,gid:c.current,searchResultId:c.current,rid:e.activeResultId===c.current?e.activeReferenceId:void 0,label:l,engineType:e.engineType,finished:a,onParagraphMounted:b,text:i,lastText:r.current,referenceOpenNewWindow:!0,isH5:e.isH5,needNotSearchTool:!0,links:o})]})}):(0,v.jsx)(eF,{})})})})]})});function eF(){var e=(0,f._)((0,x.useState)(!1),2),n=e[0],t=e[1];return(0,x.useEffect)(function(){t(!0)},[]),(0,v.jsxs)(m.Z,{sx:{width:"100%"},spacing:2,children:[(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"100%":0}),(0,v.jsx)(w.Z,{width:n?"60%":0})]})}function ez(e,n,t){var i=document.createRange();return i.setStart(t,0),i.setEnd(e,n),i.toString().length}function eW(e){e.isPPT;var n,t=(0,f._)((0,x.useState)(null),2),i=t[0],r=t[1],o=(0,f._)((0,x.useState)(""),2),a=o[0],l=o[1],s=(0,f._)((0,x.useState)(!1),2),c=s[0],d=s[1],h=(0,x.useRef)(null),m=(0,f._)((0,x.useState)(null),2),k=m[0],C=m[1],w=(0,f._)((0,x.useState)(null),2),y=w[0],j=w[1],_=(0,x.useRef)(null),S=(0,f._)((0,x.useState)(""),2),T=S[0],L=S[1],I="search-tool-anchor",H=(0,x.useCallback)(function(e,n,t){C(e),j(n)},[k]),M=(0,x.useRef)(null),Z=(0,x.useCallback)(function(n){var t;setTimeout(function(){var t=window.getSelection(),i=(null==t?void 0:t.rangeCount)?null==t?void 0:t.getRangeAt(0):null;if(null==t?void 0:null===(r=t.toString())||void 0===r?void 0:r.trim()){var r,o,a,l=0;if(i){var s=i.getBoundingClientRect(),c=s.height,u=s.bottom;c<40&&(l=u-n.pageY+60)}null===(o=document.getElementById(I))||void 0===o||o.remove();var d=document.createElement("span");d.id=I,d.style.position="absolute",e.isPPT?(d.style.top=n.pageY+10+"px",d.style.left=n.pageX+10+"px"):(d.style.top=n.pageY-60+l+"px",d.style.left=n.pageX+"px"),document.body.append(d),M.current=d,null===(a=h.current)||void 0===a||a.show(d,null==t?void 0:t.toString())}},100),null===(t=e.afterSourceMouseUp)||void 0===t||t.call(e,n)},[e]),R=eS.x.useAPI("getPreviewContainer"),N=eS.x.useAPI("getPdfContainer"),O=(0,x.useCallback)((n=(0,u._)(function(n){var t,i,r,o,a,l,s,c,u,d,f,v,x,g,m,k;return(0,p.Jh)(this,function(p){return n.preventDefault(),(o=null==(r=window.getSelection())?void 0:r.getRangeAt(0))&&(a=o.startContainer,l=null==r?void 0:r.toString(),s=null===(t=N.current)||void 0===t?void 0:t.call(N),c=null===(i=R.current)||void 0===i?void 0:i.call(R),u=e.previewMode?c&&a&&c.contains(a):s&&a&&s.contains(a),l&&u&&(v=o.getClientRects(),x=e.isH5?v.item(v.length-1):v.item(0),null===(d=document.getElementById(I))||void 0===d||d.remove(),(g=document.createElement("span")).id=I,x&&(m=Math.max(Math.min(document.body.clientWidth,x.left),0),k=Math.max(Math.min(document.body.clientHeight,x.top),0),g.style.cssText="\n        position: absolute;\n        top: ".concat(k,"px;\n        left: ").concat(m,"px;\n        height: ").concat(x.height,"px;\n        width: ").concat(x.width,"px;\n      ")),document.body.append(g),null===(f=h.current)||void 0===f||f.show(g,l,{mainAxis:30}))),[2]})}),function(e){return n.apply(this,arguments)}),[e.previewMode]),A=(0,x.useCallback)(function(e){if(!eI){var n;null===(n=h.current)||void 0===n||n.hide()}},[]),D=(0,x.useCallback)(function(e){if(e.key.startsWith("Arrow")){var n;null===(n=h.current)||void 0===n||n.hide()}},[]),B=(0,x.useCallback)(function(e){var n;null===(n=h.current)||void 0===n||n.hide()},[]),P=(0,x.useMemo)(function(){return em()(O,400,{trailing:!0})},[O]),F=(0,x.useMemo)(function(){return em()(O,30,{trailing:!0})},[O]),z=(0,x.useCallback)(function(n){e.isH5&&((0,eb.EM)()||(0,e_.Je)()||(0,e_._2)())&&P(n)},[P,e.isH5]);(0,ej.Vo)("selectionchange",z),(0,ej.Vo)("contextmenu",F);var U=(0,x.useCallback)(function(n){e.isH5&&n.preventDefault()},[]);(0,ej.Vo)("contextmenu",U),(0,x.useEffect)(function(){if(e.isH5)document.addEventListener("selectionchange",A);else{var n,t;e.isPPT?null===(n=document.querySelector(".ppt-viewport-regular"))||void 0===n||n.addEventListener("mouseup",Z):null===(t=document.querySelector("#pdf-viewer"))||void 0===t||t.addEventListener("mouseup",Z)}return function(){if(e.isH5)document.removeEventListener("selectionchange",A);else{var n,t;null===(n=document.querySelector(".ppt-viewport-regular"))||void 0===n||n.removeEventListener("mouseup",Z),null===(t=document.querySelector("#pdf-viewer"))||void 0===t||t.removeEventListener("mouseup",Z)}}},[e.isH5,e.isPPT]),(0,x.useEffect)(function(){document.addEventListener("keydown",D);var e=document.querySelector('#preview-container [class*="markdown-page-content"]');return null==e||e.addEventListener("scroll",B),null==e||e.addEventListener("wheel",B),function(){document.removeEventListener("keydown",D),null==e||e.removeEventListener("scroll",B),null==e||e.removeEventListener("wheel",B)}},[D,B,e.previewMode]);var V=(0,x.useRef)(null),q=function(){C(null),j(null),r(null),d(!1),L("")};return{onPdfSelectionChange:A,onPdfMouseUp:Z,searchPopoverRef:h,type:a,setType:l,open:c,setOpen:d,session:i,setSession:r,sessionComponent:function(){return i?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(eP,{needNotChangeDocumentTitleByQuery:!0,history:i.results&&i.results.length>0?i.results[0]:null,id:i.id,index:i.expectedCurrentSessionSearchCount?i.expectedCurrentSessionSearchCount:0,open:c,question:i.question,engineType:i.engineType,mode:i.mode,onMindMapChange:function(){},languageDomain:i.languageDomain||E.wb.ALL,topicId:k,topicName:y,onDragMove:null==e?void 0:e.onDragMove,searchTopicId:null,searchTopicName:null,onTitleClick:function(){},onShareClicked:function(){},onMouseEnter:function(){},type:a,resultChanged:function(n){var t;null==e||null===(t=e.resultChanged)||void 0===t||t.call(e,n)},finishedChanged:function(n,t){var i;null==e||null===(i=e.finishedChanged)||void 0===i||i.call(e,n,t)},onClose:q,topicPopoverRef:_,isH5:e.isH5,deskRef:V},i.key?i.key:i.id),(0,v.jsx)(W.p,{ref:_,onChange:H,id:k,sx:e.isH5?{height:"40vh",overflowY:"auto"}:void 0,sessionDTO:i})]}):T?(0,v.jsx)(eB,{onDragMove:null==e?void 0:e.onDragMove,content:T,deskRef:V,isH5:e.isH5,onClose:q}):(0,v.jsx)(g.Z,{sx:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,v.jsxs)(g.Z,{sx:{position:"relative"},children:[(0,v.jsx)(b.Z,{variant:"determinate",className:J()["progress-bottom"],thickness:4,value:100,size:42}),(0,v.jsx)(b.Z,{variant:"indeterminate",disableShrink:!0,className:J()["progress-top"],thickness:4,size:42})]})})},anchorRef:M,setTopicId:C,setTopicName:j,translateContent:T,setTranslateContent:L}}var eU=(0,x.memo)((0,x.forwardRef)(function(e,n){var t,i=(0,x.useRef)(null),r=(0,f._)((0,x.useState)(null),2),o=r[0],a=r[1],l=(0,f._)((0,x.useState)([]),2),s=l[0],c=l[1],u=(0,f._)((0,x.useState)(0),2),d=u[0],h=u[1],p=(0,f._)((0,x.useState)(0),2),k=p[0],C=p[1];(0,x.useLayoutEffect)(function(){h(document.body.clientWidth/2-305),C(document.body.clientHeight/2-229)},[]);var w=(0,x.useCallback)(function(e,n){(null==i?void 0:i.current)&&(i.current.style.left="".concat(d+e,"px"),i.current.style.top="".concat(k+n,"px"))},[d,k]),b=eW({isH5:null!==(t=e.isH5)&&void 0!==t&&t,onDragMove:w,previewMode:!!e.previewMode,isPPT:e.isPPT}),y=b.onPdfMouseUp,j=b.searchPopoverRef,_=(b.type,b.setType),S=b.open,E=b.setOpen,T=(b.session,b.setSession),I=b.sessionComponent,H=b.setTopicId,Z=b.setTopicName,R=(b.translateContent,b.setTranslateContent);(0,x.useImperativeHandle)(n,function(){return{hide:function(){var e;return null===(e=j.current)||void 0===e?void 0:e.hide()}}});var N=function(){H(null),Z(null),T(null),R(""),E(!1)};return(0,x.useEffect)(function(){var n;return null===(n=document.getElementById(e.containerId))||void 0===n||n.addEventListener("scroll",N),function(){var n;null===(n=document.getElementById(e.containerId))||void 0===n||n.removeEventListener("scroll",N)}},[]),(0,x.useEffect)(function(){if(e.isH5);else{var n,t,i;e.isPPT?null===(n=document.querySelector(".ppt-viewport-regular"))||void 0===n||n.addEventListener("mouseup",y):(null===(t=document.getElementById(e.previewerId))||void 0===t||t.addEventListener("mouseup",y),null===(i=document.getElementById("preview-container"))||void 0===i||i.addEventListener("mouseup",y))}return function(){if(e.isH5);else{var n,t,i;null===(n=document.getElementById(e.previewerId))||void 0===n||n.removeEventListener("mouseup",y),null===(t=document.getElementById("preview-container"))||void 0===t||t.removeEventListener("mouseup",y),null===(i=document.querySelector(".ppt-viewport-regular"))||void 0===i||i.removeEventListener("mouseup",y)}}},[e.isH5,e.previewMode,e.isPPT]),(0,x.useEffect)(function(){if(s&&0!==s.length){var e=function(e,n,t){var i=e.reduce(function(e,n){return{top:Math.min(e.top,n.top),bottom:Math.max(e.bottom,n.bottom),left:Math.min(e.left,n.left),right:Math.max(e.right,n.right)}},{top:e[0].top,bottom:e[0].bottom,left:e[0].left,right:e[0].right}),r=window.innerHeight,o=window.innerWidth,a=i.left+(i.right-i.left-610)/2;a=Math.max(50,Math.min(a,o-610-20));var l=i.bottom+20,s="bottom";if(l+343>r-20){var c=i.top-343-20;if(c>20)l=c,s="top";else{var u=i.left-n-20;s="left",u<20&&i.right+20+n<o&&(u=i.right+20,s="right"),u>50?(a=u,l=Math.max(20,Math.min(l=(r-t)/2,r-t-20))):(l=r-t-40,s="bottom-fixed")}}return{left:a,top:l,position:s}}(s,610,343);h(e.left),C(e.top)}},[s]),(0,x.useEffect)(function(){if(S&&(null==o?void 0:o.range)){var n;c((0,V.GS)(o.range)),e.isH5||null===(n=window.getSelection())||void 0===n||n.removeAllRanges()}else c([])},[S,o]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(eM,{ref:j,isPPT:e.isPPT,onTypeChange:function(e){_(e),E(!0)},onSessionChange:function(e){e?T(e):N()},onTranslate:function(e){e?R(e):R("翻译失败")},isH5:e.isH5,isWebview:e.isWebview,previewMode:e.previewMode,translateMode:e.translateMode,onSelectionChange:a}),!e.onlyPopover&&(0,v.jsx)(L.vs.Boundary,{children:S&&(0,v.jsx)(v.Fragment,{children:e.isH5?(0,v.jsx)(eK,{open:S,onClose:N,children:(0,v.jsx)(g.Z,{ref:i,sx:{overflowY:"auto"},children:I()})}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g.Z,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:1e3},onClick:N}),(0,v.jsx)(g.Z,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:999},onClick:N,children:!e.previewMode&&s&&s.length>0&&(0,v.jsx)(eV,{rects:s})}),(0,v.jsxs)(m.Z,{onClick:function(e){e.stopPropagation()},ref:i,sx:{width:"610px",height:"343px",minHeight:"50px",position:"fixed",top:"".concat(k,"px"),left:"".concat(d,"px"),backgroundColor:"var(--gray)",borderRadius:"8px",boxShadow:"0 2px 6px 0 rgba(0,0,0,.18)",zIndex:1001,paddingBottom:"25px",overflow:"hidden"},children:[I(),(0,v.jsx)(M.kq,{})]})]})})})]})}));function eV(e){var n=(0,x.useMemo)(function(){return Array.from(e.rects)||[]},[e.rects]);return(0,v.jsx)(g.Z,{id:"pdf-temp-highlight",children:n.map(function(e,n){return(0,v.jsx)(g.Z,{sx:{backgroundColor:"#0000ff40",position:"fixed",left:e.left,top:e.top,width:e.width,height:e.height}},n)})})}(r=c||(c={}))[r.EXPLAIN=1]="EXPLAIN";var eq=(0,x.memo)((0,x.forwardRef)(function(e,n){var t=(0,f._)((0,x.useState)(!1),2),i=t[0],r=t[1],o=(0,f._)((0,x.useState)(null),2),a=o[0],l=o[1],s=(0,x.useRef)(null),c=(0,f._)((0,x.useState)(""),2),u=c[0],d=c[1],h=(0,f._)((0,x.useState)(0),2),p=h[0],g=h[1],m=(0,x.useCallback)(function(){null==a||a.remove(),r(!1),g(p+1)},[p]);(0,j.bQ)({anchor:a,popover:function(){var e;return null===(e=s.current)||void 0===e?void 0:e.nodeRef.current}},i,function(){m()}),(0,x.useImperativeHandle)(n,function(){return{show:function(e,n){d(n),l(e),r(!0)},hide:function(){r(!1),g(p+1),null==a||a.remove()}}},[p]);var k=function(e){r(!1)};return(0,x.useEffect)(function(){var e,n;i?null===(e=document.getElementById("search-page-scroller"))||void 0===e||e.addEventListener("scroll",k):null===(n=document.getElementById("search-page-scroller"))||void 0===n||n.removeEventListener("scroll",k)},[i,k]),(0,v.jsx)(j.ZP,{ref:s,anchor:a,open:i,onOpenChanged:function(e){},children:(0,v.jsx)(eG,{isH5:e.isH5,onClose:function(){m()},text:u,popoverApi:s,onTypeChange:e.onTypeChange,onCreateSession:e.onSessionChange,onError:e.onError},p)})}));function eG(e){var n=(0,f._)((0,x.useState)(""),2),t=n[0],i=n[1];(0,x.useEffect)(function(){i(e.text)},[e.text]);var r=(0,x.useRef)(!1),o=(0,q.LM)(function(e){return e.model}),a=(0,x.useCallback)(function(n){var t;(0,V.dW)("pdf-explain",{content:n}),e.onClose(),null===(t=window.getSelection())||void 0===t||t.removeAllRanges(),r.current||(r.current=!0,eO(n,o).then(function(n){r.current=!1,e.onCreateSession(n)}).catch(function(n){var t;n instanceof T.dp?(n.code===K.cO.USER_CREDIT_RUN_OUT&&(0,Y.Z)(),(0,B.y)(n.message,{variant:"warning",autoHideDuration:3e3})):(0,B.y)("网络错误",{variant:"error",autoHideDuration:3e3}),null===(t=e.onError)||void 0===t||t.call(e,n)}).finally(function(){r.current=!1}))},[o]);return(0,v.jsx)(m.Z,{sx:{padding:"5px 10px"},onClick:function(e){e.stopPropagation(),e.preventDefault()},children:(0,v.jsxs)(m.Z,{direction:"row",alignItems:"center",spacing:1,children:[e.isH5&&(0,v.jsx)(_.Z,{startIcon:(0,v.jsx)(z.Z,{style:{width:"18px"}}),sx:{color:"var(--black3)"},variant:"text",onClick:function(){if(!e.isH5){var n;(0,V.vQ)((null===(n=window.getSelection())||void 0===n?void 0:n.toString())||"",!0),(0,B.y)("复制成功",{variant:"success",autoHideDuration:3e3}),e.onClose()}},onTouchEnd:function(){var n;(0,V.vQ)((null===(n=window.getSelection())||void 0===n?void 0:n.toString())||"",!0),(0,B.y)("复制成功",{variant:"success",autoHideDuration:3e3}),e.onClose()},children:"复制"}),(0,v.jsx)(_.Z,{startIcon:(0,v.jsx)(F.Z,{}),sx:{color:"var(--black3)"},variant:"text",onClick:function(){e.isH5||(e.onTypeChange("解释"),a("解释：\n".concat(t)))},onTouchEnd:function(n){e.onTypeChange("解释"),a("解释：\n".concat(t)),(0,el.Kn)(el.Df.OpenSourceDrawer,""),n.preventDefault(),n.stopPropagation()},children:"解释"})]})})}var eX=(0,x.memo)((0,x.forwardRef)(function(e,n){var t,i,r,o,a,l,s,c,u,d,h,p,k,C,w,y,j,_,T,I,H,Z,R,N=(0,f._)((0,x.useState)(null),2);N[0],N[1];var O=(0,f._)((0,x.useState)(0),2),A=O[0],D=O[1],P=(0,f._)((0,x.useState)(0),2),F=P[0],z=P[1],U=(0,f._)((0,x.useState)(0),2),q=U[0],G=U[1],X=(0,f._)((0,x.useState)(0),2),K=X[0],Y=X[1],Q=(0,f._)((0,x.useState)(null),2),$=Q[0],ee=Q[1],en=(0,x.useRef)(null),er=(0,x.useCallback)(function(e){ee(e),en.current=e},[]),el=(0,x.useCallback)(function(e,n,t,i){var r=e+i+10,o=n+(t-610)/2;window.innerWidth,r+458>window.innerHeight&&e-458-10>0&&(r=e-458-10),o<0&&(o=0),D(o),z(r),G(0),Y(0)},[]),es=(0,x.useCallback)(function(e,n){G(e),Y(n)},[]),ec=(0,x.useCallback)(function(n){var t=document.getSelection();if(t&&!t.isCollapsed&&t.toString()){var i=t.getRangeAt(0),r=i.getBoundingClientRect();el(r.top,r.left,r.width,r.height);var o=e.textContainer.current,a=(0,et.n5)(o,i);er({start:a.start,end:a.end,id:(0,S.DOL)(),selectText:t.toString()})}},[e.textContainer]),eu=(0,x.useCallback)(function(n,t){var i=(0,et.pl)(e.textContainer.current,[[n.start,n.end]])[0].getBoundingClientRect();el(i.top,i.left,i.width,i.height),er(n),1==n.type&&(eL("解释"),eZ(n.session),em(n.session&&n.session.results&&n.session.results.length>0),n.result&&ev(n.result)),t&&eF()},[e.textContainer,el,eZ,eF]),ed=(0,x.useCallback)(function(e){$&&$.id!=e&&eH(!1)},[$]);(0,x.useImperativeHandle)(n,function(){return{restoreSearchTool:eu,hideIfActiveNodeNotMe:ed}},[e,ed]);var ef=(0,x.useCallback)(function(){document.removeEventListener("mousedown",eO);var e=document.getElementById("search-page-scroller");e&&e.removeEventListener("scroll",eB)},[]),eh=(0,f._)((0,x.useState)(""),2),ep=eh[0],ev=eh[1],ex=(0,f._)((0,x.useState)(!1),2),eg=ex[0],em=ex[1],ek=(0,f._)((0,x.useState)(null),2),eC=ek[0],ew=ek[1],eb=(0,x.useRef)(null),ey=(t={isH5:e.isH5,afterSourceMouseUp:ec,finishedChanged:em,resultChanged:ev,onDragMove:es,textContainer:e.textContainer,realTimeDataChanged:ew},r=(i=(0,f._)((0,x.useState)(null),2))[0],o=i[1],l=(a=(0,f._)((0,x.useState)(""),2))[0],s=a[1],u=(c=(0,f._)((0,x.useState)(!1),2))[0],d=c[1],h=(0,x.useRef)(null),p=(0,x.useRef)(null),k="search-tool-anchor",C=(0,x.useCallback)(function(e,n,t){o(function(t){return null==t?null:Object.assign({},t,{topicId:e,topicName:n})})},[]),w=(0,x.useRef)(null),y=(0,x.useCallback)(function(e){var n;setTimeout(function(){var n=window.getSelection(),i=n.getRangeAt(0),r=t.textContainer.current;if(-1!==(0,et.n5)(r,i).start&&(null==n?void 0:n.toString())){null===(o=document.getElementById(k))||void 0===o||o.remove();var o,a,l=document.createElement("span");l.id=k,l.style.position="absolute",l.style.top=e.pageY-60+"px",l.style.left=e.pageX+"px",document.body.append(l),w.current=l,null===(a=h.current)||void 0===a||a.show(l,null==n?void 0:n.toString())}},100),null===(n=t.afterSourceMouseUp)||void 0===n||n.call(t,e)},[t]),j=(0,x.useRef)(0),_=(0,x.useRef)(0),(0,x.useEffect)(function(){},[u]),T=(0,x.useCallback)(function(e){var n=window.getSelection(),i=null==n?void 0:n.getRangeAt(0).startContainer,r=t.textContainer.current,o=i&&(null==r?void 0:r.contains(i));if((null==n?void 0:n.toString())&&o){e.preventDefault();var a,l,s=(null==n?void 0:n.getRangeAt(0)).getClientRects();if(s[0]){var c=t.isH5?s[s.length-1]:s[0];_.current=c.bottom+50+window.scrollY,j.current=c.left}t.afterSourceMouseUp(e),null===(a=document.getElementById(k))||void 0===a||a.remove();var u=document.createElement("span");u.id=k,u.style.position="absolute",u.style.top=_.current+"px",u.style.left=j.current+"px",document.body.append(u),null===(l=h.current)||void 0===l||l.show(u,null==n?void 0:n.toString())}},[t.afterSourceMouseUp]),I=(0,x.useCallback)(function(e){null===(n=h.current)||void 0===n||n.hide();var n,i,r=window.getSelection();if(null==r?void 0:r.toString()){var o=(null==r?void 0:r.getRangeAt(0)).getClientRects();if(o[0]){var a=t.isH5?o[o.length-1]:o[0];_.current=a.bottom+50+window.scrollY,j.current=a.left}}else null===(i=h.current)||void 0===i||i.hide()},[]),(0,x.useEffect)(function(){if(t.isH5)document.addEventListener("selectionchange",I),document.addEventListener("contextmenu",T);else{var e,n;null===(e=document.getElementById("pdf-viewer"))||void 0===e||e.addEventListener("mouseup",y),null===(n=document.querySelector("pdf-viewer"))||void 0===n||n.addEventListener("mouseup",y)}return function(){if(t.isH5)document.removeEventListener("selectionchange",I),document.removeEventListener("contextmenu",T);else{var e;null===(e=document.getElementById("pdf-viewer"))||void 0===e||e.removeEventListener("mouseup",y)}}},[t.isH5]),H=(0,x.useRef)(null),Z=function(e){e&&o(null),d(!1)},(0,x.useEffect)(function(){r&&r.id&&(!r.results||0==r.results.length)&&(0,S.VUo)((0,ea.uz)(r.id),0,999).then(function(e){var n=e.data.data;if(0===n.results.length)n.results.push({question:n.question,mode:n.mode,uuid:(0,S.DOL)()});else{var t="".concat(n.groupId,"-").concat(n.engineType||"","-").concat(n.languageDomain);eT.vP.set("group-session-cache",t,n,{maxSize:50})}o(n)})},[r,t.finishedChanged]),R=(0,x.useMemo)(function(){return r&&r.results&&0!=r.results.length?r.results[0]:null},[r]),{onPdfSelectionChange:I,onPdfTouchEnd:T,onPdfMouseUp:y,searchPopoverRef:h,type:l,setType:s,open:u,setOpen:d,session:r,setSession:o,sessionComponent:function(){return R?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(eP,{needNotChangeDocumentTitleByQuery:!0,history:R.id||R.label?R:null,activeResultId:R.id,id:r.id,index:0,open:u,question:R.question,engineType:r.engineType,mode:R.mode,onMindMapChange:function(){},languageDomain:r.languageDomain||E.wb.ALL,topicId:r.topicId,topicName:r.topicName,onDragMove:null==t?void 0:t.onDragMove,searchTopicId:null,searchTopicName:null,onTitleClick:function(){},onShareClicked:function(){},onMouseEnter:function(){},type:l,resultChanged:function(e){var n;null==t||null===(n=t.resultChanged)||void 0===n||n.call(t,e)},finishedChanged:t.finishedChanged,realTimeDataChanged:t.realTimeDataChanged,onClose:Z,topicPopoverRef:p,isH5:t.isH5,deskRef:H},R.id),(0,v.jsx)(W.p,{ref:p,onChange:C,id:r.topicId,sx:t.isH5?{height:"40vh",overflowY:"auto"}:void 0,sessionDTO:r})]}):(0,v.jsx)(g.Z,{sx:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,v.jsxs)(g.Z,{sx:{position:"relative"},children:[(0,v.jsx)(b.Z,{variant:"determinate",className:J()["progress-bottom"],thickness:4,value:100,size:42}),(0,v.jsx)(b.Z,{variant:"indeterminate",disableShrink:!0,className:J()["progress-top"],thickness:4,size:42})]})})},anchorRef:w}),ej=ey.onPdfSelectionChange,e_=ey.onPdfTouchEnd,eS=ey.onPdfMouseUp,eE=ey.searchPopoverRef,eL=(ey.type,ey.setType),eI=ey.open,eH=ey.setOpen,eM=ey.session,eZ=ey.setSession,eR=ey.sessionComponent;ey.anchorRef;var eN=function(e,n){eZ(null),eH(!1)},eO=(0,x.useCallback)(function(n){!(n.target&&n.target.closest(".answerSearchContentPopover,.subject-panel,.search-origin-box,.meta-popover"))&&(e.isH5||eB())},[e.isH5,eB]),eA=(0,x.useRef)(null);(0,x.useEffect)(function(){eA.current=function(){eN(),ef(),e.selectContentHandleResultChange(Object.assign({},$,{session:eM,type:1,finished:eg,result:ep,createTime:(null==$?void 0:$.createTime)||new Date,realTimeData:eC}))}},[$,eM,e.selectContentHandleResultChange]),(0,x.useEffect)(function(){if(en.current&&(null==eM?void 0:eM.id)&&eg){var n=en.current;e.selectContentHandleResultChange(Object.assign({},n,{session:eM,type:1,finished:eg,result:ep,createTime:n.createTime||new Date,realTimeData:eC}))}},[ep,eg,eM,e.selectContentHandleResultChange,eC]);var eD=(0,x.useCallback)(function(n){var t=en.current;if((null==n?void 0:n.id)&&e.resultId&&t){var i={id:t.id,type:1,start:t.start,end:t.end,selectText:t.selectText,sessionId:n.id};(0,S.lrA)(e.resultId,i).then(function(e){0!=e.data.errCode&&(0,B.y)("添加解释框失败:".concat(e.data.errMsg),{variant:"error",autoHideDuration:3e3})}),(0,V.dW)(V.Gy.CREATE_EXTRA_BOX,{dbResultId:e.resultId,param:i})}},[e.resultId]),eB=(0,x.useCallback)(function(){var e;null===(e=eA.current)||void 0===e||e.call(eA)},[]);(0,x.useEffect)(function(){},[eM]);var eF=(0,x.useCallback)(function(){$&&(e.addHighlightRange($),(0,V.dW)(V.Gy.SEARCH_SELECT_TEXT_TOOL_CLICKED,$)),eH(!0),document.addEventListener("mousedown",eO),em(!1),ev("")},[$,e.addHighlightRange]);return(0,x.useEffect)(function(){return function(){ef()}},[]),(0,x.useEffect)(function(){if(e.isH5)document.addEventListener("selectionchange",ej),document.addEventListener("contextmenu",e_);else{var n;null===(n=e.textContainer.current)||void 0===n||n.addEventListener("mouseup",eS)}return function(){if(e.isH5)document.removeEventListener("selectionchange",ej),document.removeEventListener("contextmenu",e_);else{var n;null===(n=e.textContainer.current)||void 0===n||n.removeEventListener("mouseup",eS)}}},[e.isH5,e.textContainer]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(eq,{ref:eE,onTypeChange:function(e){eL(e),eH(!0),eF()},onSessionChange:function(e){e?(eZ(e),eD(e)):eN(null,null)},isH5:e.isH5,onError:function(n){var t;eN(null,null),e.removePermanentHighlightRange(null===(t=en.current)||void 0===t?void 0:t.id)}}),(0,v.jsx)(L.vs.Boundary,{children:(0,v.jsx)(L.Un.Boundary,{children:(0,v.jsx)(eo.Z.Boundary,{children:(0,v.jsx)(v.Fragment,{children:e.isH5?(0,v.jsx)(eK,{open:eI,onClose:eN,children:(0,v.jsx)(g.Z,{ref:eb,sx:{overflowY:"auto"},onTouchStart:function(){document.body.style.overflow="hidden"},onTouchEnd:function(){document.body.style.removeProperty("overflow")},children:eR()})}):(0,v.jsx)(v.Fragment,{children:(0,ei.createPortal)((0,v.jsxs)(m.Z,{onClick:function(e){e.stopPropagation()},className:"answerSearchContentPopover",sx:{width:"".concat(610,"px"),height:"".concat(433,"px"),minHeight:"50px",position:"fixed",backgroundColor:"var(--gray)",borderRadius:"8px",boxShadow:"0 2px 6px 0 rgba(0,0,0,.18)",zIndex:1002,paddingBottom:"25px",overflow:"hidden",display:eI?"flex":"none"},style:{top:"".concat(F+K,"px"),left:"".concat(A+q,"px")},children:[eR(),(0,v.jsx)(M.kq,{})]}),document.body)})})})})})]})})),eK=(0,y.ZP)(U.Z)(eL())},25075:function(e,n,t){"use strict";t.d(n,{cn:function(){return b},LB:function(){return w}});var i,r,o,a,l=t(50059),s=t(57437),c=t(94746);function u(){return(u=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)({}).hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(null,arguments)}var d=function(e){return c.createElement("svg",u({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24"},e),r||(r=c.createElement("circle",{cx:12,cy:11.996,r:12,fill:"#000",fillOpacity:.5})),o||(o=c.createElement("path",{fill:"#fff",d:"m17.691 13.229-6.86 4.515a1.53 1.53 0 0 1-2.096-.406 1.47 1.47 0 0 1-.256-.826V7.48c0-.82.676-1.484 1.511-1.484.3 0 .593.088.842.252l6.859 4.515a1.468 1.468 0 0 1 0 2.466"})))},f=t(78693),h=t(7870),p=t(2265),v=t(19643),x=t(59832),g=t(92838),m=t.n(g),k=t(89576),C=t(99305),w=function(e){return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(f.Z,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"32px",width:"572px"},children:e.links&&e.links.map(function(e,n){return(0,s.jsx)(j,{item:e,width:270},n)})})})},b=p.memo(function(e){var n,t,i=(0,l._)((0,p.useState)(e.isH5?1:2),2),r=i[0];i[1];var o=(0,p.useMemo)(function(){var n;return e.isH5?270:(null===(n=e.links)||void 0===n?void 0:n.length)&&e.links.length<2?360:270},[e.links,e.isH5]),a=(0,p.useRef)(null),c=(0,p.useRef)(null),u=(0,l._)((0,p.useState)(!1),2),d=u[0],h=u[1],g=(0,l._)((0,p.useState)(!1),2),C=g[0],w=g[1],b=(0,l._)((0,p.useState)(2.4),2),y=(b[0],b[1]),_=(0,l._)((0,p.useState)(0),2),S=(_[0],_[1]),E=(0,p.useCallback)(function(){if(c.current){var e=c.current,n=e.scrollLeft,t=e.scrollWidth,i=e.clientWidth;h(n>5),w(n+i<t-5)}},[]),T=(0,p.useCallback)(function(){c.current&&(c.current.scrollBy({left:-(o+12),behavior:"smooth"}),setTimeout(E,500))},[E,o]),L=(0,p.useCallback)(function(){c.current&&(c.current.scrollBy({left:o+12,behavior:"smooth"}),setTimeout(E,500))},[E,o]);return((0,p.useEffect)(function(){if(a.current&&c.current&&(null===(n=e.links)||void 0===n?void 0:n.length)){var n,t=new k.Z(function(n){var t,i=n[0].contentRect.width;S(i);var r=Math.floor(i/(o+12)),a=i-r*(o+12),l=0;a>0&&(l=a/o),y(Math.max(1,Math.min(r+l,(null===(t=e.links)||void 0===t?void 0:t.length)||1))),E()});t.observe(a.current);var i=function(){E()};return c.current.addEventListener("scroll",i),function(){var e;t.disconnect(),null===(e=c.current)||void 0===e||e.removeEventListener("scroll",i)}}},[null===(n=e.links)||void 0===n?void 0:n.length,12,E,o]),null===(t=e.links)||void 0===t?void 0:t.length)?e.links.length<=r?(0,s.jsx)(f.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:"".concat(12,"px"),overflow:"hidden",whiteSpace:"nowrap",padding:"14px 0"},ref:a,children:e.links.map(function(e,n){return(0,s.jsx)(j,{item:e,width:o},n)})}):(0,s.jsxs)(v.Z,{direction:"row",alignItems:"center",position:"relative",ref:a,sx:{marginBottom:"-10px",padding:"14px 0"},children:[d&&(0,s.jsx)(x.Z,{onClick:T,sx:{position:"absolute",left:"0px",top:"calc(50% - 15px)",zIndex:2},className:m()["swiper-button"],children:(0,s.jsx)("svg",{width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M7.97266 1L1.97266 7L7.97266 13",stroke:"#475467",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,s.jsx)(f.Z,{ref:c,sx:{display:"flex",overflowX:"auto",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},msOverflowStyle:"none",gap:"".concat(12,"px"),width:"100%",padding:"1px 0",scrollSnapType:"x mandatory"},children:e.links.map(function(e,n){return(0,s.jsx)(f.Z,{sx:{flexShrink:0,scrollSnapAlign:"start"},children:(0,s.jsx)(j,{item:e,width:o})},n)})}),C&&(0,s.jsx)(x.Z,{onClick:L,sx:{position:"absolute",right:"0px",top:"calc(50% - 15px)",zIndex:2},className:m()["swiper-button"],children:(0,s.jsx)("svg",{width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M1.02734 13L7.02734 7L1.02734 1",stroke:"#475467",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}):null});(i=a||(a={}))[i.small=0]="small",i[i.middle=1]="middle",i[i.large=2]="large";var y=205/360,j=function(e){var n=e.item,t=e.width,i=(0,p.useCallback)(function(){(0,C.Uq)(n.link)||window.open(n.link)},[n.link]),r=(0,p.useMemo)(function(){return y*t},[t]);return(0,s.jsxs)(f.Z,{onClick:i,sx:{position:"relative",flexShrink:0,cursor:"pointer",width:t+"px",height:r+"px",display:"flex",flexDirection:"column",justifyContent:"space-between",borderRadius:"10px",backgroundSize:"cover",overflow:"hidden","& img":{transition:"transform .2s"},"&:hover img":{transform:"scale(1.2)"}},children:[(0,s.jsx)(f.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",padding:"12px",zIndex:1},children:(0,s.jsx)(f.Z,{children:(0,s.jsx)(d,{})})}),(0,s.jsxs)(f.Z,{sx:{fontSize:"12px",zIndex:1,color:"white",display:"flex",flexDirection:"row",gap:"13px",justifyContent:"space-between",alignItems:"center",height:"42px",background:"linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 1))",padding:"0 12px"},children:[(0,s.jsx)(f.Z,{sx:{overflow:"hidden",display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,maxHeight:"30px",lineHeight:"15px",textOverflow:"ellipsis",wordWrap:"break-word",whiteSpace:"normal"},children:(0,h.iu)(n.title)}),n.duration&&(0,s.jsx)(f.Z,{children:(0,h.LU)(n.duration)})]}),(0,s.jsx)("img",{src:n.pic,style:{position:"absolute",width:t+"px",height:r+"px",objectFit:"cover"}})]})}},14250:function(e,n,t){"use strict";t.d(n,{k:function(){return d}});var i=t(2265),r=t(36017),o=t(79943),a=t(74634),l=t(89038),s=t(15598),c=t(39207),u=t(55833);function d(e){var n=e.isH5,t=e.displayLinks,d=e.gid,f=e.pdfTransformResult,h=(0,o.WS)(),p=(0,r.useOpenAcademicDetail)().openDetail,v=(0,a.dM)(),x=v.ifGoToDownloadAppPageAvailable,g=v.tryGoToDownloadAppPage,m=l.x.useAPI("pdfContainer"),k=u.vs.useBridge("tooltip");return{onLinkClick:(0,i.useCallback)(function(e,i,o,a){var l=!!(i.abstract||i.export);if(n&&l&&!i.file_meta){e.preventDefault(),x()?g():((0,r.recordReferenceJump)(i.link||i.url),window.open(i.link||i.url));return}if(l&&!a)e.preventDefault(),p(i);else if(i.file_meta){e.preventDefault();var u,v,C=t[o].file_meta;C.url&&(C.url=(0,c.FGH)(C.url));var w={file_meta:C,title:t[o].title,pdfHighlightInfo:{id:d,index:null===(u=f.map.get(t[o].display.refer_id))||void 0===u?void 0:u.index},rid:1e4+o,page:t[o].page,totalPage:t[o].total_page,target:e.target,tag:t[o].file_meta.source,author:t[o].author,publishDate:t[o].publish_date};(0,s.YQ)({pdfParams:w,isH5:n,router:h,pdfContainerAPI:m.current}),null===(v=k.current)||void 0===v||v.cancel()}else g()},[n,t,d,f,x,g,p,h,m,k])}}},40045:function(e,n,t){"use strict";t.d(n,{n5:function(){return r},pl:function(){return o}});var i=t(85735);function r(e,n){var t={start:-1,end:-1,currentOffset:0};return function e(n,t,i){if(n&&(n==t.startContainer&&(i.start=i.currentOffset+t.startOffset),n==t.endContainer&&(i.end=i.currentOffset+t.endOffset),-1==i.start||-1==i.end)){if(n.nodeType===Node.TEXT_NODE)i.currentOffset=i.currentOffset+n.textContent.replace(/\n/g,"").length;else if(l(n))i.currentOffset=i.currentOffset+1;else{if(c(n))return;for(var r=0;r<n.childNodes.length;r++)e(n.childNodes[r],t,i)}}}(e,n,t),{start:t.start,end:t.end}}function o(e,n){for(var t=[],i=0;i<n.length;i++){var r={start:n[i][0],end:n[i][1],arrayIndex:i,range:new Range,completed:!1};t.push(r)}t.sort(function(e,n){return e.start-n.start});var o={ranges:t,rangeIndex:0,completed:!1};!function e(n,t,i,r){if(n){if(n.nodeType===Node.TEXT_NODE){var o=t.index+n.textContent.replace(/\n/g,"").length;(function(e,n,t,i,r){for(var o=i.rangeIndex;o<i.ranges.length;o++){var l=i.ranges[o];if(l.start>t)break;l.start>=n&&l.start<t&&l.range.setStart(e,l.start-n),l.end>=n&&l.end<=t&&(l.range.setEnd(e,l.end-n),a(l,i,o,r))}})(n,t.index,o,r,t),!r.completed&&(t.index=o,t.lastNode=n)}else if(l(n))(function(e,n,t,i){for(var r=t.rangeIndex;r<t.ranges.length;r++){var o=t.ranges[r];if(o.start>n+1)break;o.start===n&&o.range.setStartBefore(e),o.end===n+1&&(o.range.setEndAfter(e),a(o,t,r,i))}})(n,t.index,r,t),t.index=t.index+1,t.lastNode=n;else{if(i&&c(n)){n.className&&-1!==n.className.indexOf("cdx-list-serialNumber")&&(t.lastNode=n);return}for(var s=0;s<n.childNodes.length;s++)if(e(n.childNodes[s],t,i,r),r.completed)return}}}(e,{index:0,lastNode:null,inTable:!1},!0,o);var s=[],u=!0,d=!1,f=void 0;try{for(var h,p=o.ranges[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var v=h.value;s[v.arrayIndex]=v.range}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}return s}function a(e,n,t,i){e.completed=!0,e.extra||(e.extra={}),e.extra.inTable=i.inTable,n.ranges.slice(n.rangeIndex,t+1).every(function(e){return e.completed})&&(n.rangeIndex=t+1),n.rangeIndex===n.ranges.length&&(n.completed=!0)}function l(e){return e.className&&e.className.indexOf&&-1!==e.className.indexOf("fixed-length-blot")}var s=new Set(["range-offset-ignore","reference-num","katex"]);function c(e){return!!e.classList&&(0,i._)(e.classList).some(function(e){return s.has(e)})}},90289:function(e){e.exports={moreActionMenu:"search-right-box-kits_moreActionMenu__klp3Z",moreActionMenuItem:"search-right-box-kits_moreActionMenuItem__FfzaC",contentContainer:"search-right-box-kits_contentContainer__adSX1",tabLine:"search-right-box-kits_tabLine__Lw49t",cardTab:"search-right-box-kits_cardTab__Qp4HF",cardTabActive:"search-right-box-kits_cardTabActive__O2iMe","search-origin-box":"search-right-box-kits_search-origin-box__AhBga",podcastToTag:"search-right-box-kits_podcastToTag__EPPZw","qa-pdf-card-play-container":"search-right-box-kits_qa-pdf-card-play-container__UVElQ",line:"search-right-box-kits_line__0yC0M"}},34913:function(e){e.exports={"meta-list":"meta-ordered-list_meta-list__jmlEn","list-item":"meta-ordered-list_list-item__F_f3v",active:"meta-ordered-list_active__06SLX","item-index-wrapper":"meta-ordered-list_item-index-wrapper__laCQZ","item-index":"meta-ordered-list_item-index__QgxW_","book-open-svg":"meta-ordered-list_book-open-svg__DW6zG","pod-ref-container":"meta-ordered-list_pod-ref-container__Jj_v1"}},28452:function(e){e.exports={title:"thinking-collapse_title__y_7ID",slideShine:"thinking-collapse_slideShine__OHph0",finished:"thinking-collapse_finished__R9yqD",collapse:"thinking-collapse_collapse__irJsW",content:"thinking-collapse_content__1phn8"}}}]);