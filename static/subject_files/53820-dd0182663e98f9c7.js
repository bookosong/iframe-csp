"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53820],{41023:function(n,e,t){t.d(e,{CB:function(){return u},Kw:function(){return g},VO:function(){return s},_l:function(){return j},bu:function(){return f},fW:function(){return w},hj:function(){return m},oc:function(){return d},pU:function(){return b},sG:function(){return y},uh:function(){return x},v_:function(){return l}});var i,r=t(2403),o=t(5853),a=t(39207),c=t(22322),s=function(n){if("undefined"!=typeof FileReader){if(-1==n.type.indexOf("image/"))return!1}else{var e=n.name,t=e.lastIndexOf("."),i=e.substring(t+1).toUpperCase();if("JPG"!=i&&"JPEG"!=i&&"PNG"!=i&&"WEBP"!=i&&"JFIF"!=i)return!1}return!0},l=function(n,e){(0,a.zlM)({acl:"read",data:n,src:""}).then(function(n){if(0==n.data.code){var t=n.data.src,i={uid:(0,a.ejW)("uid"),headimgurl:t};(0,a.NJ7)(i).then(function(n){0==n.data.code?(u("头像修改成功"),e(t)):d(n.data.code)}).catch(function(n){d("修改头像失败")})}else d(n.data.msg)}).catch(function(n){d("上传图片失败")})},d=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4e3;(0,c.y)(n,{variant:"error",autoHideDuration:e})},u=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;(0,c.y)(n,{variant:"success",autoHideDuration:e})},f=function(n,e){var t={uid:(0,a.ejW)("uid")};if(0==n.length){(0,c.y)("用户名不能为空",{variant:"error",autoHideDuration:1500});return}t.nickname=n,(0,a.NJ7)(t).then(function(n){0==n.data.code?(u("修改用户名成功"),e&&e()):d(n.data.msg)}).catch(function(n){})},h=function(n){return n?!!/(?:\(?[0\+]?\d{1,3}\)?)[\s-]?(?:0|\d{1,4})[\s-]?(?:(?:13\d{9})|(?:\d{7,8}))/.test(n)||(d("请输入正确的手机号"),!1):(d("手机号不能为空"),!1)},x=function(n){var e=/[A-Z]/.test(n),t=/[a-z]/.test(n),i=/\d/.test(n),r=/[!@#$%^&*(),.?":{}|<>]/.test(n),o=0;return e&&o++,t&&o++,i&&o++,r&&o++,o>=3},p=function(n){return n?!!/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test(n)||(d("邮箱格式不正确"),!1):(d("邮箱不能为空"),!1)},v=function(n){return n?!!m(n)||(d("请输入数字值"),!1):(d("验证码不能为空"),!1)},m=function(n){return!!n&&/^\d+$/.test(n)},g=function(n,e,t){h(n)&&v(e)&&(0,a.tWx)({type:"unlock",content:e}).then(function(e){if(0===e.data.code){var i={uid:(0,a.ejW)("uid"),phone:n};(0,a.NJ7)(i).then(function(n){0==n.data.code?(u("修改手机号成功"),t()):d(n.data.msg)}).catch(function(n){})}else d(e.data.msg)}).catch(function(n){})},b=(i=(0,r._)(function(n,e){var i,r,c;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(!(n?n.length<8?(d("密码最少不能低于8位"),!1):n.length>40?(d("密码最多不能超过40位"),!1):!!x(n)||(d("密码必须包含大写字母、小写字母、数字、符号中三种以上字符"),!1):(d("密码不能为空"),!1)))return[2];return i="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCX4kRYjU6XclWT4mwxgQ55JerRar8CPEHp4uZRITqZuk8p0z5UTL02muequw2dgvgNlJkE8C7eyXf1S8TH+MvbVkHnCoKKigAPb08PtqcvVIqnZn+kNDpiQZapkpHrEXeR+rWfj3etTwMHYbV+zTaKOdxa7fm3oO4CWbgmfkSC8wIDAQAB",[4,t.e(89965).then(t.bind(t,89965))];case 1:return(r=new(o.sent()).JSEncrypt).setPublicKey(i),c={pwd:r.encrypt(n)},(0,a.oi2)(c).then(function(n){0==n.data.code?e():d(n.data.msg)}).catch(function(n){d("修改密码失败")}),[2]}})}),function(n,e){return i.apply(this,arguments)}),y=function(n,e,t){p(n)&&v(e)&&(0,a.kF3)(e).then(function(e){if(0==e.data.code){var i={uid:(0,a.ejW)("uid"),email:n};(0,a.NJ7)(i).then(function(n){0==n.data.code?t():d(n.data.msg)}).catch(function(n){d("修改邮箱失败")})}else d(e.data.msg)}).catch(function(n){d("邮箱验证失败")})},j=function(n,e){p(n)&&(0,a.Ta1)("new_email",{email:n}).then(function(n){0==n.data.code?e():"email already exists, please change"==n.data.msg?d("邮箱已被占用，请更换邮箱"):d(n.data.msg)}).catch(function(n){d("邮箱验证失败")})},w=function(n,e,t){h(n)&&(0,a.Sy$)({type:"unlock"},{phone:""===e||void 0===e?"86-"+e:e+"-"+n}).then(function(n){0===n.data.code?t():d(n.data.msg)}).catch(function(n){})}},54632:function(n,e,t){var i=t(16210),r=t(39155),o=(0,i.ZP)(r.Z)(function(n){n.content,n.theme;var e=n.variant,t=n.color;return{boxShadow:"none",textTransform:"none",fontSize:14,fontWeight:"bold",padding:"6px 12px",lineHeight:1.5,"&:hover":{boxShadow:"none"},"&.Mui-disabled":Object.assign({opacity:"0.8",color:"var(--disabled-text-color)"},"contained"===e&&("primary"===t||void 0===t)?{color:"white",backgroundColor:"#84caff"}:{}),"&:active":{boxShadow:"none"},"&:focus":{boxShadow:"none"}}});e.Z=o},96075:function(n,e,t){t.d(e,{P:function(){return p}});var i=t(5194),r=t(1780),o=t(45008),a=t(57437),c=t(2265),s=t(21494),l=t(88195);function d(){var n=(0,o._)(["\n  display: flex;\n  max-width: 100%;\n"]);return d=function(){return n},n}var u=c.forwardRef(function(n,e){return(0,a.jsx)(s.I,(0,r._)((0,i._)({slots:{input:x}},n),{ref:e}))});e.Z=u;var f={100:"#DAECFF",200:"#80BFFF",400:"#3399FF",500:"#007FFF",600:"#0072E5",700:"#0059B2"},h={50:"#F3F6F9",100:"#E5EAF2",200:"#DAE2ED",300:"#C7D0DD",400:"#B0B8C4",500:"#9DA8B7",600:"#6B7A90",700:"#434D5B",800:"#303740",900:"#1C2025"},x=(0,l.Z)("input")(function(n){var e=n.theme;return"\n  width: calc(100% - 24px);\n  font-family: IBM Plex Sans, sans-serif;\n  font-size: 0.875rem;\n  font-weight: 400;\n  line-height: 1.5;\n  padding: 8px 12px;\n  border-radius: 8px;\n  color: ".concat("dark"===e.palette.mode?h[300]:h[900],";\n  background: ").concat("dark"===e.palette.mode?h[900]:"#fff",";\n  border: 1px solid ").concat("dark"===e.palette.mode?h[700]:h[200],";\n  box-shadow: 0px 2px 2px ").concat("dark"===e.palette.mode?h[900]:h[50],";\n\n  &:hover {\n    border-color: ").concat(f[400],";\n  }\n\n  &:focus {\n    border-color: ").concat(f[400],";\n    box-shadow: 0 0 0 3px ").concat("dark"===e.palette.mode?f[600]:f[200],";\n  }\n\n  // firefox\n  &:focus-visible {\n    outline: 0;\n  }\n")}),p=c.forwardRef(function(n,e){return(0,a.jsx)(s.I,(0,r._)((0,i._)({slots:{root:v,input:"input",textarea:m}},n),{ref:e}))}),v=(0,l.Z)("div")(d()),m=(0,l.Z)("textarea",{shouldForwardProp:function(n){return!["ownerState","minRows","maxRows"].includes(n.toString())}})(function(n){var e=n.theme;return"\n  width: 320px;\n  font-size: 0.875rem;\n  font-weight: 400;\n  line-height: 1.5rem;\n  padding: 8px 12px;\n  border-radius: 8px 8px 0 8px;\n  color: ".concat("dark"===e.palette.mode?h[300]:h[900],";\n  background: ").concat("dark"===e.palette.mode?h[900]:"#fff",";\n  border: 1px solid ").concat("dark"===e.palette.mode?h[700]:h[200],";\n  box-shadow: 0px 2px 4px ").concat("dark"===e.palette.mode?"rgba(0,0,0, 0.5)":"rgba(0,0,0, 0.05)",";\n\n  &:hover {\n    border-color: ").concat(f[400],";\n  }\n\n  &:focus {\n    border-color: ").concat(f[400],";\n    box-shadow: 0 0 0 3px ").concat("dark"===e.palette.mode?f[700]:f[200],";\n  }\n\n  // firefox\n  &:focus-visible {\n    outline: 0;\n  }\n")})},25590:function(n,e,t){t.d(e,{P:function(){return s}});var i=t(85735),r=t(57437),o=t(59832),a=t(31876),c=t(2265);function s(n){var e=n.placeStrategy,t=(0,c.useMemo)(function(){switch(e){default:case"absolute":return{position:"absolute",right:16,top:16};case"static":return{};case"static-collapse-padding":return{m:-1}}},[e]);return(0,r.jsx)(o.Z,{sx:[t].concat((0,i._)(Array.isArray(n.sx)?n.sx:[n.sx])),"aria-label":"关闭",className:n.className,onClick:n.onClick,children:(0,r.jsx)(a.Z,{})})}},53820:function(n,e,t){t.d(e,{F2:function(){return D},Wh:function(){return S},_$:function(){return N}});var i=t(2403),r=t(5194),o=t(1780),a=t(50059),c=t(5853),s=t(57437),l=t(40100),d=t(2265),u=t(98698),f=t.n(u),h=t(78693),x=t(59832),p=t(39155),v=t(75624),m=t(54632),g=t(34040),b=t(39207),y=t(96075),j=t(22322),w=t(25590),C=t(41023),k=t(74634),Z=t(7870);function N(n){var e=n.title,t=n.onClose,i=n.titleStyle,r=n.sx,o=n.center;return(0,s.jsxs)(h.Z,{sx:r,className:f().title,children:[o&&(0,s.jsx)("div",{style:{width:30}}),(0,s.jsx)("div",{className:f()["title-text"],style:i||{textAlign:o?"center":"left"},children:e}),(0,s.jsx)(w.P,{sx:{position:"relative",right:0,top:0,color:"var(--black)"},onClick:t})]})}var D=(0,d.memo)((0,d.forwardRef)(function(n,e){var t,r,o,a,u,x,p,v,g,b,y=n.title,j=n.open,w=n.onClose,C=n.onConfirm,k=n.onCancel,D=n.enableEnterEffect,A=n.children,S=n.slots,E=n.sx,_=n.noFooter;(0,d.useEffect)(function(){if(D){var n=document.activeElement;n&&n instanceof HTMLElement&&n.blur();var e=function(n){"ENTER"===n.key.toUpperCase()&&C()};return window.addEventListener("keypress",e),function(){window.removeEventListener("keypress",e)}}},[D,C]);var F=(0,d.useRef)({cancel:new Set,confirm:new Set});(0,d.useImperativeHandle)(e,function(){return{registerBeforeClick:function(n,e){F.current[n].add(e)},unRegisterBeforeClick:function(n,e){F.current[n].delete(e)}}},[]);var H=(0,d.useCallback)((t=(0,i._)(function(e){var t,i,r,o,a,s,l,d;return(0,c.Jh)(this,function(c){switch(c.label){case 0:if(t=!0,!("cancel"===e&&n.beforeCancel))return[3,2];return[4,n.beforeCancel()];case 1:return t=c.sent(),[3,4];case 2:if(!("confirm"===e&&n.beforeConfirm))return[3,4];return[4,n.beforeConfirm()];case 3:t=c.sent(),c.label=4;case 4:i=!0,r=!1,o=void 0,c.label=5;case 5:c.trys.push([5,10,11,12]),a=Array.from(F.current[e])[Symbol.iterator](),c.label=6;case 6:if((i=(s=a.next()).done)||(l=s.value,!t))return[3,9];return[4,l()];case 7:t=c.sent(),c.label=8;case 8:return i=!0,[3,6];case 9:return[3,12];case 10:return d=c.sent(),r=!0,o=d,[3,12];case 11:try{i||null==a.return||a.return()}finally{if(r)throw o}return[7];case 12:return[2,t]}})}),function(n){return t.apply(this,arguments)}),[n.beforeCancel,n.beforeConfirm]),I=(0,d.useCallback)((0,i._)(function(){return(0,c.Jh)(this,function(n){switch(n.label){case 0:return[4,H("confirm")];case 1:if(!n.sent())return[2];return C(),[2]}})}),[H,C]),B=(0,d.useCallback)((0,i._)(function(){return(0,c.Jh)(this,function(n){switch(n.label){case 0:return[4,H("cancel")];case 1:if(!n.sent())return[2];return k(),[2]}})}),[H,k]);return(0,s.jsx)(l.k,{maskSx:{"& .meta-dialog":{p:3,minWidth:" min(80vw, 400px)"}},sx:E,open:j,onClose:w,radius:4,children:(0,s.jsxs)("div",{className:f().confirm,children:[!n.noHeader&&(0,s.jsx)(N,{title:y,sx:(0,Z.KI)(null===(r=n.sxs)||void 0===r?void 0:r.header,3),onClose:w}),(0,s.jsx)(h.Z,{className:f().content,sx:(0,Z.KI)(null===(o=n.sxs)||void 0===o?void 0:o.content,3),children:A}),!_&&(0,s.jsxs)(h.Z,{className:f().footer,sx:(0,Z.KI)(null===(a=n.sxs)||void 0===a?void 0:a.footer,3),children:[!n.hideCancel&&(0,s.jsx)(s.Fragment,{children:(null==S?void 0:S.cancel)?(0,s.jsx)(h.Z,{sx:(0,Z.Vc)(null===(u=n.sxs)||void 0===u?void 0:u.actions,null===(x=n.sxs)||void 0===x?void 0:x.cancelAction),onClick:B,children:S.cancel}):(0,s.jsx)(m.Z,{sx:null===(p=n.sxs)||void 0===p?void 0:p.cancelAction,color:"inherit",onClick:B,children:"取消"})}),(null==S?void 0:S.confirm)?(0,s.jsx)(h.Z,{sx:(0,Z.Vc)(null===(v=n.sxs)||void 0===v?void 0:v.actions,null===(g=n.sxs)||void 0===g?void 0:g.confirmAction),onClick:I,children:S.confirm}):(0,s.jsx)(m.Z,{sx:(0,Z.Vc)({ml:1.25},null===(b=n.sxs)||void 0===b?void 0:b.confirmAction),variant:"contained",disabled:n.confirmDisabled,onClick:I,color:n.confirmColor||"error",children:"".concat(n.confirmText?n.confirmText:"确定")})]})]})})}));function A(n){var e=n.phone,t=n.title,i=n.open,c=n.onClose,u=n.onConfirm,g=(n.onCancel,n.children,n.isH5),Z=(0,a._)((0,d.useState)(""),2),N=Z[0],D=Z[1],A=(0,a._)((0,d.useState)({isDisabled:!1,name:"发送验证码",time:60}),2),S=A[0],E=A[1],_=(0,d.useRef)(null),F=(0,d.useRef)(null),H=function(n){(0,j.y)(n,{variant:"error",autoHideDuration:1500})},I=function(){return e?(0,C.hj)(e)?!(e.length<8)&&!(e.length>14)||(H("请输入8-14位有效手机号码"),!1):(H("请输入0-9的数字"),!1):(H("手机号不能为空"),!1)},B=function(){clearInterval(_.current),E({isDisabled:!1,name:"发送验证码",time:60})},P=(0,a._)((0,d.useState)(!1),2),R=(P[0],P[1]),W=(0,a._)((0,d.useState)(""),2),J=(W[0],W[1]),T=function(n,e){E((0,o._)((0,r._)({},S),{isDisabled:!0})),(0,b.Sy$)(n,e).then(function(n){if(0===n.data.code){(0,j.y)("验证码已发送，请查收",{variant:"success",autoHideDuration:3e3});var e=60;_.current=window.setInterval(function(){E({time:e,name:"("+e+"秒)后重发",isDisabled:!0}),(e-=1)<0&&B()},1e3)}else 5===n.data.code||2701===n.data.code&&"手机号不存在,请先注册!"===n.data.msg||2704===n.data.code||((0,j.y)(n.data.msg,{variant:"error",autoHideDuration:1500}),B())}).catch(function(n){(0,j.y)("发送手机验证码失败，请稍后再试",{variant:"error",autoHideDuration:1500}),B()})},z=function(){I()&&T({type:"sms"},{phone:"86-"+e})},M=function(){!I()||(N?!(4==N.length&&(0,C.hj)(N))&&(H("请输入4位数字验证码"),1):(H("验证码不能为空"),1))||(0,b.tWx)({type:"sms",content:N}).then(function(n){0===n.data.code?u():(0,j.y)(n.data.msg,{variant:"error",autoHideDuration:3e3})}).catch(function(n){})},K=(0,k.sd)(),Q=K.isQQ,V=K.version;return(0,s.jsxs)(s.Fragment,{children:[!g&&(0,s.jsx)(l.k,{open:i,onClose:c,radius:4,children:(0,s.jsxs)("div",{className:f().confirm,children:[(0,s.jsxs)("div",{className:f().title,children:[(0,s.jsx)("div",{className:f()["title-text"],children:t}),(0,s.jsx)(x.Z,{onClick:c,children:(0,s.jsx)("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M13 1L1 13M1 1L13 13",stroke:"#98A2B3",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,s.jsxs)("div",{className:f().content,style:{width:"360px"},children:[(0,s.jsxs)("div",{style:{display:"flex",height:"50px",lineHeight:"50px"},children:[(0,s.jsx)("div",{style:{width:"70px"},children:"手机号"}),(0,s.jsx)(y.Z,{style:{height:"50px",width:"180px"},disabled:!0,readOnly:!0,value:(null==e?void 0:e.substring(0,3))+"****"+(null==e?void 0:e.substring(7,11))})]}),(0,s.jsxs)("div",{style:{display:"flex",height:"50px",lineHeight:"50px",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,s.jsx)("div",{style:{width:"70px"},children:"验证码"}),(0,s.jsx)(y.Z,{style:{height:"50px",width:"180px"},defaultValue:N,onChange:function(n){return D(n.target.value)}})]}),(0,s.jsx)(p.Z,{size:"small",variant:"outlined",className:f()["phonecode-btn"],disabled:S.isDisabled||!e,onClick:function(){clearTimeout(F.current),R(!1),J(""),z()},children:S.name})]})]}),(0,s.jsx)("div",{className:f().footer,children:(0,s.jsx)(m.Z,{variant:"contained",onClick:M,color:"error",children:"立即验证"})})]})}),g&&(0,s.jsx)(v.ZP,{open:!0,anchor:"bottom",onClose:c,children:(0,s.jsxs)(h.Z,{className:f()["verify-phone-drawer"],children:[(0,s.jsxs)(h.Z,{className:f()["verify-phone-drawer-header"],children:[(0,s.jsx)(h.Z,{children:"验证手机号"}),(0,s.jsx)(w.P,{placeStrategy:"static",onClick:c})]}),(0,s.jsxs)(h.Z,{className:f().content,children:[(0,s.jsxs)("div",{style:{display:"flex",height:"50px",lineHeight:"50px"},children:[(0,s.jsx)("div",{style:{width:"70px"},children:"手机号"}),(0,s.jsx)(y.Z,{style:{height:"50px",width:"180px"},disabled:!0,readOnly:!0,value:(null==e?void 0:e.substring(0,3))+"****"+(null==e?void 0:e.substring(7,11))})]}),(0,s.jsxs)("div",{style:{display:"flex",height:"50px",lineHeight:"50px",alignItems:"center",gap:"10px"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,s.jsx)("div",{style:{width:"70px"},children:"验证码"}),(0,s.jsx)(y.Z,{style:{height:"50px",width:"100px"},inputMode:"tel",type:"tel",defaultValue:N,value:N,onChange:function(n){var e=n.target.value;e.length>4&&(e=e.substring(0,4)),D(e)}})]}),(0,s.jsx)(p.Z,{size:"small",variant:"outlined",className:f()["phonecode-btn"],disabled:S.isDisabled||!e,onClick:function(){clearTimeout(F.current),R(!1),J(""),z()},children:S.name})]})]}),(0,s.jsx)(h.Z,{className:f()["verify-phone-drawer-footer"],children:(0,s.jsx)(m.Z,{variant:"contained",onClick:M,color:"error",children:"立即验证"})}),Q&&V>=14.9&&(0,s.jsx)(h.Z,{style:{height:"50px"}})]})})]})}function S(n,e){return new Promise(function(t,i){var r=document.createElement("div");document.body.appendChild(r);var o=(0,g.createRoot)(r);o.render((0,s.jsx)(A,{phone:n,title:"验证手机号",open:!0,isH5:e,onClose:function(){o.unmount(),r.remove(),i()},onConfirm:function(){o.unmount(),r.remove(),t()},onCancel:function(){o.unmount(),r.remove(),i()},children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{children:"为确保账户安全，请点击“发送验证码”接收短信，并完成验证"}),(0,s.jsx)("div",{children:n})]})}))})}}}]);