(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[40797,15598],{28484:function(e,t,n){"use strict";var r,i,a=n(94746);function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(null,arguments)}t.Z=function(e){return a.createElement("svg",o({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),r||(r=a.createElement("rect",{width:28,height:28,fill:"var(--gray-2)",rx:6})),i||(i=a.createElement("path",{stroke:"#667085",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m16.5 19-5-5 5-5"})))}},84248:function(e,t,n){Promise.resolve().then(n.bind(n,72222))},72222:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N}});var r=n(50059),i=n(57437),a=n(99376),o=n(19643),s=n(78693),l=n(95984),c=n(2265),u=n(4253),d=n(7870),f=n(41043),h=n(75825),p=n(59832),x=n(4695),v=n(28484),g=n(27648),m=n(85425),j=n(39207),b=n(15102),w=n(80928),_=n.n(w),S=n(15707),Z=n(60588);function y(e){var t=(0,a.usePathname)(),n=(0,r._)((0,c.useState)(""),2),o=(n[0],n[1]),l=(0,r._)((0,c.useState)(""),2),u=l[0],w=l[1],y=(0,r._)((0,c.useState)(!1),2),P=y[0],k=y[1];m.H.useRegister("breadcrumbs",function(){return{setSubjectName:function(e){k(!0),w(e)},setSubjectId:function(e){o(e)}}},[]);var I=(0,c.useMemo)(function(){return(0,S.u)(t).path},[t]),E=(0,c.useMemo)(function(){return(0,Z.v)(t,h.l.SubjectKnowledgeManage,!0)},[t]);(0,c.useEffect)(function(){E.id||k(!1)},[E]);var L=I===h.l.SubjectKnowledgeManage,M=I===h.l.Subject,N=(0,a.useSearchParams)(),C=(0,r._)((0,c.useState)(N.get("cfid")),2),W=C[0],F=C[1],H=(0,c.useRef)(W);(0,c.useEffect)(function(){F(N.get("cfid")),H.current=N.get("cfid")},[N]);var T=(0,r._)((0,c.useState)([]),2),U=T[0],O=T[1],A=(0,r._)((0,c.useState)(""),2),R=A[0],B=A[1];(0,c.useEffect)(function(){var e=[],t=(0,d.gY)(h.l.SubjectDetail,{id:E.id}),n=(0,d.gY)(h.l.SubjectKnowledgeManage,{id:E.id});if(E.id){var r={text:u||"",isLast:!0,href:(0,j.x$_)(t),isSubject:!0};L&&(r.isLast=!1),e.push(r)}if(L){var i={text:"知识库",isLast:!0,href:(0,j.x$_)(n),isSubject:!1};W&&(i.isLast=!1),e.push(i)}W?(0,j.bvQ)(W).then(function(t){if(W==H.current&&0==t.data.errCode){var r=t.data.data;r.length>1?(B(D(n,r[r.length-2].id)),e.push({text:"...",isLast:!1,href:"#",isSubject:!1})):B("");var i={text:r[r.length-1].fileName,isLast:!0,href:D(n,r[r.length-1].id),isSubject:!1};e.push(i),O(e)}}).catch(function(e){}):(B(""),O(e))},[t,u,W,E]);var D=(0,c.useCallback)(function(e,t){return(0,j.x$_)(e+"?cfid="+t)},[]);return(0,i.jsxs)(f.Gg,{sx:{" ol":{flexWrap:"nowrap"}},children:[!e.brief&&(0,i.jsxs)(s.Z,{className:"fr-ac",children:[R&&(0,i.jsx)(g.default,{legacyBehavior:!0,passHref:!0,href:R,children:(0,i.jsx)(p.Z,{component:"a",sx:{color:"var(--black)",padding:"5px"},children:(0,i.jsx)(v.Z,{})})}),(0,i.jsx)(g.default,{legacyBehavior:!0,passHref:!0,href:h.l.Home,children:(0,i.jsx)(p.Z,{component:"a",sx:{color:"var(--black)"},children:(0,i.jsx)(x.Z,{})})})]}),e.brief&&R&&(0,i.jsx)(s.Z,{className:"fr-ac",children:(0,i.jsx)(g.default,{legacyBehavior:!0,passHref:!0,href:R,children:(0,i.jsx)(p.Z,{component:"a",sx:{color:"var(--black)",padding:"5px"},children:(0,i.jsx)(v.Z,{})})})}),!e.brief&&(U.length>0?(0,i.jsx)(f.Ak,{href:h.l.Subject,children:"专题"}):(0,i.jsx)(f.Lm,{children:"专题"})),(!!M||!!P)&&U.map(function(e,t){return e.isLast?(0,i.jsx)(b.MI,{sxs:{contentWrapper:{wordBreak:"break-all"}},placement:"top",effect:"dark",anchorChildren:(0,i.jsx)(f.Lm,{sx:{maxWidth:"22em"},style:{background:U.length>1?"var(--white-gray-2)":""},className:"truncate",children:e.text},e.href),children:e.text},t):"#"!=e.href?(0,i.jsx)(b.MI,{sxs:{contentWrapper:{wordBreak:"break-all"}},placement:"top",effect:"dark",anchorChildren:(0,i.jsx)(f.Ak,{className:"truncate",href:e.href,children:e.text},e.href),children:e.text},t):(0,i.jsx)(f.Lm,{className:"truncate",children:e.text},e.href)})]},_().MD5(t+N.toString()).toString())}var P=n(23760),k=n(88872),I=n(36570),E=n(64989),L=n(45342),M=n(76604);function N(e){(0,M.Us)();var t=(0,a.usePathname)(),n=(0,c.useMemo)(function(){return(0,S.u)(t)},[t]),d=(0,c.useMemo)(function(){var e;return(null===(e=t.match(/\/subject\/(\d+)(\/?)/))||void 0===e?void 0:e[1])||""},[t]);(0,c.useEffect)(function(){d&&localStorage.setItem("visitingTopicId",d)},[d]);var f=n.path===h.l.Subject;n.path,h.l.SubjectDetail;var p=(0,P.LM)(function(e){return e.login}),x=(0,E.Z)();(0,c.useEffect)(function(){if(p){P.LM.getState().updateUserInfo();var e=setInterval(function(){P.LM.getState().updateUserInfo()},3e5);return function(){clearInterval(e)}}},[p]);var v=(0,r._)((0,c.useState)(!1),2),g=v[0],j=v[1],b=(0,r._)((0,c.useState)(!1),2),w=b[0],_=b[1];m.H.useRegister("layout",function(){return{setShowPdf:j,setPdfFullScreen:_}},[]);var Z=(0,a.useSearchParams)();(0,c.useEffect)(function(){g||_(!1)},[g]),(0,c.useEffect)(function(){g&&!Z.get("url")?j(!1):!g&&Z.get("url")&&j(!0)},[Z]);var N=(0,c.useMemo)(function(){return I.ZP.pdfModeContentWidth.get()},[]),C=(0,L.Z)(d),W=C.noLeftMenu,F=C.owner;return C.canEdit,(0,i.jsx)(k.DI.Provider,{value:x,children:(0,i.jsxs)(o.Z,{direction:"row",sx:{height:1},children:[(0,i.jsx)(l.default,{isH5:!1,invisible:!f&&W}),(0,i.jsxs)(o.Z,{sx:{height:1,width:g?N:1,minWidth:g?"340px":"auto",overflowX:"hidden",display:w?"none":"flex"},style:{width:g?N:"100%"},id:k.ed,children:[(0,i.jsxs)(o.Z,{sx:{height:40,padding:"10px 0 ",borderBottom:"1px solid var(--border-color2)",flex:"none"},direction:"row",alignItems:"center",justifyContent:"space-between",children:[(0,i.jsx)(s.Z,{sx:{ml:"20px"},children:(0,i.jsx)(y,{brief:!f&&!F})}),(0,i.jsxs)(i.Fragment,{children:[!g&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.Z,{direction:"row",spacing:2,sx:{ml:"auto",mr:2},children:[!f&&(0,i.jsx)(s.Z,{id:k.P8}),p&&(f||F)&&(0,i.jsx)(u.Z,{})]}),(0,i.jsx)(s.Z,{id:k.ol,sx:{mr:"max(calc(((100% - 5px) - ((100% - 37px) * 0.477 + 460px + 5vw)) / 2 - 7px), 9px)"}})]}),g&&(0,i.jsx)(s.Z,{style:{display:"none"},id:k.ol})]})]}),e.children]}),(0,i.jsx)(s.Z,{id:k.Bv,sx:{width:1,flex:1,flexBasis:0,display:"flex"}})]})})}},45342:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var r=n(50059),i=n(85735),a=n(36956),o=n(2265),s=n(47812),l=n(99376),c=n(2403),u=n(5853),d=n(71632),f=n(39207);function h(e){var t=(0,r._)((0,a.L)("sharedSubjectIds"),2),n=t[0],h=t[1],p=(0,r._)((0,o.useState)(!1),2),x=p[0],v=p[1],g=(0,r._)((0,o.useState)(!1),2),m=g[0],j=g[1],b=(0,r._)((0,o.useState)(!1),2),w=b[0],_=b[1],S=(0,l.useSearchParams)(),Z=(0,d.a)({queryKey:["use-shared-subject-effects-".concat(e||"")],queryFn:(0,c._)(function(){return(0,u.Jh)(this,function(t){switch(t.label){case 0:if(!e)return[2,null];return[4,(0,f.QE)(e,f.Z3G)];case 1:return[2,t.sent().data.data]}})}),enabled:!1}),y=(0,r._)((0,o.useState)(!1),2),P=y[0],k=y[1],I=(0,o.useRef)(e);(0,o.useEffect)(function(){I.current===e&&P||(Z.refetch(),k(!0)),I.current=e},[e,S.get(s.Vp.COMMON),S.get(s.Vp.SEARCH_TOPIC_SHARE_KEY)]);var E=function(e){h(function(t){return t.includes(e)?t:(JSON.stringify(t).length>1e3&&t.shift(),(0,i._)(t).concat([e]))})},L=function(e){h(function(t){return t.filter(function(t){return t!==e})})};(0,o.useEffect)(function(){var t=Z.data;t&&(_(!0),t.hideLeftMenu&&!t.owner?E(e):L(e),v(t.owner),j(t.canEdit))},[Z.data]);var M=S.has("noLeftMenu")&&"false"!==S.get("noLeftMenu")&&!x;return{noLeftMenu:!w||M||!!e&&n.includes(e),sharedSubjectIds:n,cacheCookie:E,clearCookie:L,owner:x,canEdit:m}}},4253:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var r=n(50059),i=n(57437),a=n(19643),o=n(78693),s=n(5186),l=n(46387),c=n(15102),u=n(92021),d=n(23760),f=n(89480),h=n(2265),p=n(54632),x=n(79943),v=n(75825);function g(e){var t=(0,d.LM)().userInfo,n=t.creditTotal-t.creditRest,g=n/t.creditTotal*100,m=(0,f.wo)(),j=(0,r._)((0,h.useState)({}),2)[1];(0,h.useEffect)(function(){j({})},[t]);var b=(0,x.WS)();return e.isH5?(0,i.jsxs)(a.Z,{sx:{p:2.5},alignItems:"center",spacing:2,children:[(0,i.jsxs)(o.Z,{children:["上传文件额度：",n,"\xa0/\xa0",t.creditTotal,"点"]}),(0,i.jsx)(o.Z,{sx:{textAlign:"center",color:"var(--content-op-color)",fontSize:"12px"},children:"上传1M文件需要10点额度，将文件处理成模型可理解的数据，以供您使用知识库进行搜索"})]}):(0,i.jsxs)(o.Z,{className:"upload-flow-indicator fr-ac",sx:{color:"var(--black2)",fontSize:14},children:[(0,i.jsxs)(o.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:[(0,i.jsx)(o.Z,{className:"fr-ac",children:(0,i.jsx)(s.Z,{variant:"determinate",sx:{width:124,height:5,borderRadius:"3px",backgroundColor:"var(--border-color2)"},value:g})}),(0,i.jsx)(o.Z,{sx:{ml:"auto",fontSize:12,display:"inline-block",color:"#9AAAC5"},children:m?(0,i.jsxs)(o.Z,{children:[n,"\xa0/\xa0",t.creditTotal,"点"]}):(0,i.jsx)(o.Z,{className:"fr-ac",sx:{height:17}})})]}),!e.hideTooltip&&(0,i.jsxs)(c.MI,{anchorChildren:(0,i.jsx)(u.Z,{style:{width:18,height:18,marginLeft:6,color:"#98A2B3",display:"block"}}),placement:"bottom-end",sxs:{contentWrapper:{borderRadius:"10px"}},metaPopoverProps:{offsetOptions:{mainAxis:5,crossAxis:20}},children:[(0,i.jsx)(l.Z,{sx:{fontSize:18,fontWeight:"bold"},children:"计算额度"}),(0,i.jsxs)("span",{className:"text-gray-400 dark:text-gray-600",children:["已使用：",n,"点"]}),(0,i.jsxs)(l.Z,{sx:{mt:1,fontSize:14,color:"var(--black4)"},children:["上传1M文件需要10点额度，将文件处理成模型",(0,i.jsx)("br",{}),"可理解的数据，以供您使用知识库进行搜索"]}),!e.hideTopUpEntry&&(0,i.jsx)(o.Z,{className:"fr-ac",sx:{mt:1},children:(0,i.jsx)(p.Z,{onClick:function(){b.push(v.l.TopUp)},sx:{ml:"auto",height:38},variant:"contained",children:"增加额度"})})]})]})}},15598:function(e,t,n){"use strict";n.d(t,{P6:function(){return h},YQ:function(){return x},xu:function(){return u},yU:function(){return d}});var r=n(75825),i=n(97152),a=n(39207),o=n(68956),s=n(63080),l=n(76492),c=n(42233),u="".concat(c.re.OSSUrl,"/metaso/document/");function d(e){var t=new URL(r.l.PdfWebview,location.origin),n=(0,l.Qn)(p(e),t);return n.searchParams.set("isNative","false"),n}function f(e){return"object"==typeof e&&"title"in e&&!("file_path"in e)&&!("snippet"in e)}function h(e){return f(e)?e:{file_meta:{file_path:e.file_path,_id:e._id,url:e.internalFile?(0,a.FGH)("/api/file/".concat(e._id,"/preview")):e.displayUrl||e.url,source:e.tag,internalFile:e.internalFile,downloadUrl:e.downloadUrl,type:e.type},url:e.internalFile?(0,a.FGH)("/api/file/".concat(e._id,"/preview")):e.url||"".concat(u).concat(e._id,".pdf"),title:e.title,page:e.page||1,totalPage:e.totalPage||1,pdfHighlightInfo:e.snippet||void 0,onlyPreview:e.onlyPreview,chapterId:e.chapterId}}function p(e){var t,n,r,i,a,o,s,l,c;return f(e)?{displayUrl:null===(t=e.file_meta)||void 0===t?void 0:t.url,url:e.url||"".concat(u).concat(null===(n=e.file_meta)||void 0===n?void 0:n._id,".pdf"),snippet:e.pdfHighlightInfo,page:e.page||1,totalPage:e.totalPage||0,bookId:e.bookId||null,title:e.title,file_path:null===(r=e.file_meta)||void 0===r?void 0:r.file_path,_id:null===(i=e.file_meta)||void 0===i?void 0:i._id,sessionId:"",tag:null===(a=e.file_meta)||void 0===a?void 0:a.source,publishDate:e.publishDate,author:e.author,showFront:!!e.showFront,internalFile:null===(o=e.file_meta)||void 0===o?void 0:o.internalFile,downloadUrl:null===(s=e.file_meta)||void 0===s?void 0:s.downloadUrl,sourceId:null===(l=e.file_meta)||void 0===l?void 0:l._id,topicId:e.topicId,type:(null===(c=e.file_meta)||void 0===c?void 0:c.type)||null,onlyPreview:!!e.onlyPreview,noComplain:!!e.noComplain,share:!1,chapterId:e.chapterId,autoOpenPPT:e.autoOpenPPT}:e}function x(e){var t=e.pdfParams,n=e.isH5,l=e.router,c=e.pdfContainerAPI,u=e.disableReusePdfBridge,f=e.tempParamsWhenNavigate,x=void 0!==f&&f,v=e.useEagerWidth,g=function(e){var n;if("navigate"===e&&x){var o=new URL(r.l.PdfWebview,location.origin);i.C.set(p(t)),o.searchParams.set(i.o,"1"),n=o.href}else n=d(t).href;return(0,a.jaP)(n)};n?((0,o.gF)()||e.openInNewTab?window.open(g("openNewTab"),"_blank"):l.push(g("navigate"),{scroll:!1}),(0,s.Kn)(s.Df.OpenSourceDrawer,"")):!e.openInNewTab&&(c||u)?u&&!c?l.push(g("navigate")):(history.pushState({url:location.href},document.title,location.href),null==c||c.show(h(t),{eagerWidth:void 0!==v&&v}),window.addEventListener("popstate",function(){(null==c?void 0:c.hide)&&c.hide()},{once:!0})):window.open(g("openNewTab"))}},97152:function(e,t,n){"use strict";n.d(t,{C:function(){return r},o:function(){return i}});var r=(0,n(92935).zW)("pdf-view-temp-params",null),i="use-pdf-temp-params"}},function(e){e.O(0,[21100,97703,78187,4637,39780,18223,53824,42977,77647,77962,67254,78693,78130,46387,53410,57587,80871,34138,94746,77919,64293,94786,32525,90077,39155,59832,71632,72972,15438,33145,53335,46746,48467,52657,35398,97404,32796,99205,10638,43646,10261,48022,30470,21634,42845,42456,33869,82935,85013,4274,53820,83724,26948,95171,96339,15708,88872,69161,84277,24757,26398,55833,62917,41004,14449,98255,96839,45897,20669,96491,72789,74087,64989,23362,1744],function(){return e(e.s=84248)}),_N_E=e.O()}]);