(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[62917],{30020:function(e,n,t){"use strict";t.d(n,{RY:function(){return s},n$:function(){return l},vu:function(){return f}});var r,o,i,a,l,s,u,c=t(12249);(r=a||(a={}))[r.INDUSTRY=0]="INDUSTRY",r[r.ENTERPRISE=1]="ENTERPRISE",r[r.BRAND=2]="BRAND",r[r.CAREER=3]="CAREER",(o=l||(l={}))[o.TEXT_FIELD=0]="TEXT_FIELD",o[o.TEXT_AREA=1]="TEXT_AREA",(i=s||(s={}))[i.STRING=0]="STRING",i[i.LONG_STRING=1]="LONG_STRING",i[i.STRING_ARRAY=2]="STRING_ARRAY";var f=(u={},(0,c._)(u,0,50),(0,c._)(u,1,200),(0,c._)(u,2,100),u)},64189:function(e,n,t){"use strict";t.d(n,{B:function(){return l}});var r=t(2403),o=t(5853),i=t(30020),a=t(39207);function l(){return s.apply(this,arguments)}function s(){return(s=(0,r._)(function(){return(0,o.Jh)(this,function(e){return[2,new Promise(function(e,n){var t;(0,a.X$K)().then((t=(0,r._)(function(n){return(0,o.Jh)(this,function(t){return n.data&&n.data.data?e(n.data.data):e([]),[2]})}),function(e){return t.apply(this,arguments)})).catch(function(n){e([])})})]})})).apply(this,arguments)}i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING_ARRAY,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.STRING,i.RY.LONG_STRING,i.RY.LONG_STRING,i.RY.STRING,i.RY.LONG_STRING,i.RY.LONG_STRING,i.RY.STRING,i.RY.LONG_STRING,i.RY.STRING,i.RY.STRING},62917:function(e,n,t){"use strict";t.r(n),t.d(n,{WorkFlow:function(){return Z},receiveRecentWorkflowData:function(){return L},useSubmitWorkflowFunc:function(){return D},useWorkFlow:function(){return y}});var r=t(2403),o=t(5194),i=t(46796),a=t(50059),l=t(5853),s=t(57437),u=t(78693),c=t(19643),f=t(35108),d=t(42187),p=t(8350),h=t(2265),m=t(97404),R=t(30020),w=t(64189),x=t(90934),v=t.n(x),g=t(54632),_=t(47812),T=t(23760),b=t(36570),S=t(39207),N=t(89051),I=t(36760),G=t.n(I),j=t(89480),k=(0,t(30166).default)(function(){return Promise.all([t.e(47999),t.e(4637),t.e(21100),t.e(39780),t.e(18223),t.e(53824),t.e(77962),t.e(37160),t.e(71632),t.e(72972),t.e(33145),t.e(53335),t.e(52657),t.e(35398),t.e(32796),t.e(99205),t.e(10638),t.e(43646),t.e(10261),t.e(48022),t.e(30470),t.e(21634),t.e(42845),t.e(58509),t.e(11741),t.e(57930),t.e(13521),t.e(14865),t.e(89576),t.e(83724),t.e(26948),t.e(95171),t.e(96339),t.e(15708),t.e(88872),t.e(69161),t.e(84277),t.e(24757),t.e(26398),t.e(55833),t.e(41004),t.e(14449),t.e(98255),t.e(96839),t.e(75181),t.e(35322),t.e(63796),t.e(98323),t.e(78167)]).then(t.bind(t,10301)).then(function(e){return{default:e.MarkdownContent}})},{loadableGenerated:{webpack:function(){return[10301]}},ssr:!1});function y(e){var n=(0,a._)((0,h.useState)([]),2),t=n[0],o=n[1],i=(0,a._)((0,h.useState)(!1),2),s=i[0],u=i[1],c=(0,T.LM)(function(e){return e.login}),f=(0,h.useCallback)(function(){u(!0),(0,w.B)().then(function(n){u(!1),new Promise((0,r._)(function(){var t,r,i,a,s,u,c,f;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(e)return[3,2];t={name:"全部",flows:[]},r=!0,i=!1,a=void 0;try{for(s=n[Symbol.iterator]();!(r=(u=s.next()).done);r=!0)c=u.value,t.flows=t.flows.concat(c.flows)}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n.unshift(t),[4,L()];case 1:f=l.sent(),n.splice(1,0,f),l.label=2;case 2:return o(n),[2]}})}))})},[c]);return(0,h.useEffect)(function(){f()},[f]),{workFlowData:t,loading:s,loadData:f}}var Y=(0,h.forwardRef)(function(e,n){var t=e.type,r=e.value,l=(0,i._)(e,["type","value"]),c=(0,a._)((0,h.useState)(r||""),2),f=c[0],d=c[1];return(0,h.useEffect)(function(){},[]),(0,h.useImperativeHandle)(n,function(){return{getValue:function(){return f}}}),(0,s.jsxs)(u.Z,{sx:{position:"relative"},children:[(0,s.jsx)(u.Z,{sx:{position:"absolute",right:0,top:"-20px",color:"var(--Gary-Group1-500)",fontSize:"14px"},children:"".concat(f.length,"/").concat(l.inputProps.maxLength)}),(0,s.jsx)(m.Z,(0,o._)({className:v()["input-root"],autoComplete:"off",multiline:t===R.n$.TEXT_AREA,value:f,onChange:function(e){d(e.currentTarget.value),l.onTextChange(l.index,e.currentTarget.value)}},l))]})}),E=(0,h.forwardRef)(function(e,n){var t=(0,h.useRef)(null);return(0,h.useImperativeHandle)(n,function(){return{getValue:function(){return t.current.getValue()}}}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Y,(0,o._)({ref:t},e)),(0,s.jsx)(u.Z,{children:"支持输入多个竞品名称，用“，”分隔开即可"})]})});function Z(e){var n=y(),t=n.workFlowData,r=(n.loading,n.loadData),o=(0,a._)((0,h.useState)([]),2),i=o[0],l=o[1],m=(0,a._)((0,h.useState)("全部"),2),R=m[0],w=m[1],x=(0,a._)((0,h.useState)(""),2),g=x[0],_=x[1],T=(0,a._)((0,h.useState)(0),2),b=T[0],S=T[1],I=(0,a._)((0,h.useState)(null),2),j=I[0],Y=I[1],E=(0,a._)((0,h.useState)(e.variable),2),Z=E[0],L=E[1],A=D(e.onSubmit);(0,h.useLayoutEffect)(function(){if(t.length>0&&(l(t[0].flows),e.flowId)){var n=t[0].flows.find(function(n){return n.id===e.flowId})||null;Y(n),n&&(_(n.prompt),S(n.cost||0))}},[t]),(0,h.useEffect)(function(){e.contentVisible&&0===t.length&&r()},[e.contentVisible,t,r]),(0,h.useEffect)(function(){if(!e.contentVisible&&e.flowId&&t.length>0){var n=t[0].flows.find(function(n){return n.id===e.flowId})||null;Y(n),n&&(_(n.prompt),L(e.variable),S(n.cost||0))}},[e.flowId,e.variable,e.contentVisible,t]);var F=(0,h.useCallback)(function(e){_(e.prompt),S(e.cost||0)},[]);(0,h.useRef)(!0);var M=(0,h.useRef)(null),O=(0,h.useCallback)(function(e){clearTimeout(M.current),M.current=setTimeout(function(){w(e.name),_(""),Y(null),l(e.flows)},150)},[]);return e.contentVisible?(0,s.jsxs)(c.Z,{direction:"row",className:v()["work-flow"],children:[(0,s.jsx)(f.Z,{sx:{overflowY:"auto",width:"223px"},className:v()["menu-list"],children:t.map(function(e,n){return(0,s.jsx)(d.Z,{className:G()(v()["list-item"],v()["no-hover"]),selected:R===e.name,onClick:function(){},onMouseLeave:function(){clearTimeout(M.current)},onMouseEnter:function(){O(e)},disabled:null!==j,children:(0,s.jsxs)(c.Z,{direction:"row",spacing:1,alignItems:"center",children:[e.icon&&(0,s.jsx)(u.Z,{sx:{width:"18px",justifyContent:"center"},component:"div",display:"flex",dangerouslySetInnerHTML:{__html:e.icon}}),(0,s.jsx)(u.Z,{flex:1,className:v()["list-item-name"],children:e.name})]})},n)})}),(0,s.jsx)(p.Z,{orientation:"vertical",sx:{margin:"0 16px",height:"100%",borderColor:"var(--border-color2)"}}),(0,s.jsx)(u.Z,{className:v()["flow-list"],sx:{overflowY:"auto",paddingRight:"16px",borderRight:"solid 1px var(--border-color2)",marginRight:"16px"},children:(0,s.jsxs)(f.Z,{sx:{width:"258px"},children:[t.length>0&&0===i.length&&(0,s.jsx)(u.Z,{sx:{color:"var(--Gary-Group1-500)"},children:"暂无工作流"}),i.map(function(e,n){return(0,s.jsx)(d.Z,{className:v()["list-item"],disabled:null!==j,selected:j===e||e.prompt===g,onMouseEnter:function(){F(e)},onClick:function(){Y(e)},children:(0,s.jsx)(u.Z,{flex:1,className:v()["list-item-name"],children:e.name})},n)})]})}),(0,s.jsx)(c.Z,{sx:{flex:1,height:"100%",position:"relative"},children:j?(0,s.jsx)(C,{variable:Z,onSubmit:function(e){A({flow:j,variableInputs:e})},onBack:function(){L(null),Y(null)},items:j.variable}):(0,s.jsxs)(u.Z,{className:v()["prompt-container"],sx:{overflowY:"auto",lineHeight:"28px",fontSize:"15px",color:"var(--black5)",height:"100%",padding:"15px 0"},children:[g&&!j&&(0,s.jsxs)(c.Z,{spacing:1,direction:"row",justifyContent:"space-between",alignItems:"center",margin:"0 0 15px 0",children:[(0,s.jsx)(u.Z,{sx:{color:"var(--black5)",fontSize:"15px",fontWeight:"700",fontFamily:"Noto Sans SC"},children:"介绍"}),(0,s.jsxs)(c.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,s.jsx)(N.Z,{placement:"top",slotProps:{popper:{style:{zIndex:3e3}}},title:"使用此工作流，将消耗".concat(b,"个搜索额度"),classes:{tooltip:"custom-tooltip-popper",arrow:"custom-tooltip-arrow"},arrow:!0,children:(0,s.jsx)("svg",{style:{cursor:"pointer"},width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M9.99984 13.3346V10.0013M9.99984 6.66797H10.0082M18.3332 10.0013C18.3332 14.6037 14.6022 18.3346 9.99984 18.3346C5.39746 18.3346 1.6665 14.6037 1.6665 10.0013C1.6665 5.39893 5.39746 1.66797 9.99984 1.66797C14.6022 1.66797 18.3332 5.39893 18.3332 10.0013Z",stroke:"#667085",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,s.jsx)(u.Z,{component:"span",style:{color:"rgba(102, 112, 133, 1)",lineHeight:"21px"},children:"额度：".concat(b)})]})]}),(0,s.jsx)(k,{content:g,isFinished:!0})]})})]}):(0,s.jsx)(s.Fragment,{})}function C(e){var n=(0,h.useRef)(new Map),t=(0,a._)((0,h.useState)({}),2),r=t[0],i=t[1],l=(0,h.useRef)(!1),f=(0,a._)((0,h.useState)(!1),2),d=f[0],p=f[1],m=(0,h.useRef)(e.items.map(function(n,t){if(e.variable){var r=e.variable[n.name];return r instanceof Array?r.join("，"):r}return""})),w=(0,h.useCallback)(function(n,t){p(!0),m.current[n]=t.trim(),m.current.forEach(function(n,t){n||e.items[t].nullable||p(!1)})},[]);(0,h.useEffect)(function(){e.variable&&p(!0)},[e.variable]);var x=(0,h.useCallback)(function(){if(!l.current){l.current=!0,setTimeout(function(){});var t={},a=!0;n.current.forEach(function(n,l){var s=n.getValue();if(s.length>0){t[l]=s;var u=(0,o._)({},r);u[l]=!1,i(u)}else if(e.items.find(function(e){return e.name===l}).nullable)t[l]=null;else{var c=(0,o._)({},r);c[l]=!0,i(c),a=!1}}),a&&e.onSubmit(t),setTimeout(function(){l.current=!1},500)}},[r]),_=function(e){"Enter"==e.key&&d&&x()};return(0,s.jsxs)(c.Z,{sx:{height:"100%",width:"100%"},spacing:2,children:[(0,s.jsx)(c.Z,{direction:"row",marginTop:"15px !important",children:(0,s.jsx)(g.Z,{sx:{color:"var(--black)"},startIcon:(0,s.jsx)("svg",{width:"8",height:"14",viewBox:"0 0 8 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M7 13L1 7L7 1",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),onClick:function(){e.onBack()},children:"返回"})}),(0,s.jsx)(c.Z,{spacing:2,component:"div",flex:1,sx:{overflowY:"auto"},padding:"0 10px 0 0",children:e.items.map(function(t,o){return(0,s.jsxs)(u.Z,{children:[(0,s.jsx)(u.Z,{className:v()["field-name"],children:t.name}),t.type===R.RY.STRING&&(0,s.jsx)(Y,{value:e.variable&&e.variable[t.name],inputProps:{maxLength:R.vu[t.type]},autoFocus:0===o,index:o,onKeyDown:_,onTextChange:w,error:!t.nullable&&r[t.name],placeholder:t.placeholder,ref:function(e){e&&n.current.set(t.name,e)},type:R.n$.TEXT_FIELD}),t.type===R.RY.LONG_STRING&&(0,s.jsx)(Y,{value:e.variable&&e.variable[t.name],maxRows:4,rows:4,inputProps:{maxLength:R.vu[t.type]},autoFocus:0===o,index:o,onTextChange:w,error:!t.nullable&&r[t.name],placeholder:t.placeholder,ref:function(e){e&&n.current.set(t.name,e)},type:R.n$.TEXT_AREA}),t.type===R.RY.STRING_ARRAY&&(0,s.jsx)(E,{value:e.variable&&e.variable[t.name],inputProps:{maxLength:R.vu[t.type]},autoFocus:0===o,index:o,onKeyDown:_,onTextChange:w,error:!t.nullable&&r[t.name],placeholder:t.placeholder,ref:function(e){e&&n.current.set(t.name,e)},type:R.n$.TEXT_FIELD})]},o+t.name)})}),(0,s.jsx)(u.Z,{sx:{textAlign:"right"},children:(0,s.jsx)(g.Z,{variant:"contained",onClick:x,disabled:!d,children:"确定"})})]})}function L(){return A.apply(this,arguments)}function A(){return(A=(0,r._)(function(){var e,n;return(0,l.Jh)(this,function(t){switch(t.label){case 0:return e={name:"最近",flows:[]},[4,j.wS.done];case 1:if(t.sent(),!T.LM.getState().login)return[3,6];return[4,(0,S.ppx)()];case 2:if(e.flows=t.sent().data.data,0!==e.flows.length)return[3,5];if(!((n=b.ZP.workflows.get()).length>0))return[3,4];return[4,(0,S.sUD)(n.map(function(e){return e.id}))];case 3:t.sent(),t.label=4;case 4:e.flows=n,t.label=5;case 5:return[3,7];case 6:e.flows=b.ZP.workflows.get(),t.label=7;case 7:return[2,e]}})})).apply(this,arguments)}function D(e){return function(n){var t=n.flow,r=n.variableInputs;if(!T.LM.getState().login){var o=b.ZP.workflows.get();o.find(function(e){return e.id===n.flow.id})||(o.unshift(t),b.ZP.workflows.set(o))}var i=t.template.match(/\[([^\]]*)\]/g),l=null===(d=t.template)||void 0===d?void 0:d.match(/#[^\n]*/)[0].replace("# ",""),s=[];if(i){Object.entries(r).forEach(function(e){var n=(0,a._)(e,2),t=n[0],r=n[1];r instanceof Array?(l=null==l?void 0:l.replace("[".concat(t,"]"),r.join("，")),s.push(r.join("，"))):"string"==typeof r&&(l=null==l?void 0:l.replace("[".concat(t,"]"),r),s.push(r))});var u=!0,c=!1,f=void 0;try{for(var d,p,h=s[Symbol.iterator]();!(u=(p=h.next()).done);u=!0){var m=p.value,R=l.indexOf(m);if(R>-1){R+=m.length;for(var w=0;w<m.length-1;w++)0===l.substring(R).indexOf(m.substring(w))&&(l=l.substring(0,R)+l.substring(R+(m.length-w)))}}}catch(e){c=!0,f=e}finally{try{u||null==h.return||h.return()}finally{if(c)throw f}}}e({question:l||"",flowId:null==t?void 0:t.id,variable:r,engineType:_.rG.WORKFLOW,_mode:"detail",scholarSearchDomain:_.wb.ALL,cost:t.cost})}}},90934:function(e){e.exports={"work-flow":"workflow_work-flow__JcMOp","input-root":"workflow_input-root__R7hev","menu-list":"workflow_menu-list__zrbX9","list-item":"workflow_list-item__QdRd4","no-hover":"workflow_no-hover__sEji9","list-item-name":"workflow_list-item-name__Wr4_W","field-name":"workflow_field-name__RmF_9","flow-list":"workflow_flow-list__A_Dc1","prompt-container":"workflow_prompt-container__JDCCF"}}}]);